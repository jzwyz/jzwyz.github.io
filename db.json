{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"source/img/avatar.jpg","path":"img/avatar.jpg","modified":1,"renderable":0},{"_id":"source/img/docker_01.png","path":"img/docker_01.png","modified":1,"renderable":0},{"_id":"source/img/favicon.ico","path":"img/favicon.ico","modified":1,"renderable":0},{"_id":"themes/aircloud/source/css/aircloud.less","path":"css/aircloud.less","modified":1,"renderable":1},{"_id":"themes/aircloud/source/css/aircloud.css.map","path":"css/aircloud.css.map","modified":1,"renderable":1},{"_id":"themes/aircloud/source/css/aircloud.css","path":"css/aircloud.css","modified":1,"renderable":1},{"_id":"themes/aircloud/source/css/gitment.css","path":"css/gitment.css","modified":1,"renderable":1},{"_id":"themes/aircloud/source/js/index.js","path":"js/index.js","modified":1,"renderable":1},{"_id":"source/img/iis_05.png","path":"img/iis_05.png","modified":1,"renderable":0},{"_id":"source/img/iis_07.png","path":"img/iis_07.png","modified":1,"renderable":0},{"_id":"source/img/iis_01.png","path":"img/iis_01.png","modified":1,"renderable":0},{"_id":"source/img/iis_04.png","path":"img/iis_04.png","modified":1,"renderable":0},{"_id":"themes/aircloud/source/js/gitment.js","path":"js/gitment.js","modified":1,"renderable":1},{"_id":"source/img/iis_02.png","path":"img/iis_02.png","modified":1,"renderable":0},{"_id":"source/img/iis_03.png","path":"img/iis_03.png","modified":1,"renderable":0},{"_id":"source/img/iis_06.png","path":"img/iis_06.png","modified":1,"renderable":0},{"_id":"source/img/iis_08.png","path":"img/iis_08.png","modified":1,"renderable":0}],"Cache":[{"_id":"themes/aircloud/_config.yml","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1562316718003},{"_id":"source/404.md","hash":"83c2c6d587beaa967a976e5969d60fa97fcdbe55","modified":1556348810160},{"_id":"source/.DS_Store","hash":"4c22356bb97e9fdbab8fd57feb9f1eaf56884e89","modified":1557992823909},{"_id":"themes/aircloud/.gitignore","hash":"5a4a925cfd624633dafaacaced416c8d7272dcef","modified":1562316718002},{"_id":"themes/aircloud/LICENSE","hash":"218b4bf797149a2751a015812a9adefe368185c1","modified":1562316718003},{"_id":"themes/aircloud/readme-en.md","hash":"2903b1e9db12cd72ed6f8c10be14cd7f6afd82cf","modified":1562316718018},{"_id":"themes/aircloud/readme.md","hash":"4be1fc64bd1dc335a986a39594564e89bd7eba43","modified":1562316718019},{"_id":"themes/aircloud/layout/catagory.ejs","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1562316718012},{"_id":"themes/aircloud/layout/page.ejs","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1562316718014},{"_id":"source/_posts/.DS_Store","hash":"df2fbeb1400acda0909a32c1cf6bf492f1121e07","modified":1558317913517},{"_id":"source/_posts/clickhouse.md","hash":"c285fb46c1642f7ff549bd0016d25ded96df5c0a","modified":1570759849719},{"_id":"source/_posts/docker.md","hash":"6b65bc95989fa52f429b89bd385378212bdaef70","modified":1577505061918},{"_id":"source/_posts/hello-world.md","hash":"89c284b7e950df2390d7f73b2fce35982da28b7c","modified":1556348810160},{"_id":"source/_posts/cron.md","hash":"037c06d0dabbdeec35d1bb573bc6686f0af437ef","modified":1563358752992},{"_id":"source/_posts/iis.md","hash":"42993cfbd76437d68263d3939e3f714fc6704af1","modified":1557911847608},{"_id":"source/_posts/graphql.md","hash":"b6404af77308b6db29d8caf600ff022a1a2091b5","modified":1577790414287},{"_id":"source/_posts/markdown.md","hash":"c2f1ffc74b29048c13100f5b130d9b4236c53cbc","modified":1560843012814},{"_id":"source/_posts/meilin-zerotier.md","hash":"58f02c6070f7dbeac89d2925cd908c8cfcce65eb","modified":1577963185037},{"_id":"source/_posts/msl.md","hash":"d0dec1d8c66a170af8c2e82e0629fe4b5648622b","modified":1578470894748},{"_id":"source/_posts/nginx.md","hash":"7f532d0a68325558541e9da2ef5043bc6f2b9f2a","modified":1568682307702},{"_id":"source/_posts/mysql-explain.md","hash":"c24c4fbe8df60691e1c7523a55b9287a1784bd25","modified":1577960749978},{"_id":"source/_posts/python3.md","hash":"91de9a6f14684ab4d92ec656be89dbb649b9be73","modified":1578014189255},{"_id":"source/_posts/mysql5-7.md","hash":"791f1c77a1c2c18cb8ae34550f8f5cf7bb9f0f07","modified":1571453306506},{"_id":"source/_posts/xgp-zerotier.md","hash":"1ce9a690c983b247e9cf1c93bf87b8d7ae1f6c1d","modified":1577959933643},{"_id":"source/_posts/regular.md","hash":"90eeb26d00568886874eb037fef017fd2ac43467","modified":1566630007224},{"_id":"source/about/index.md","hash":"04edd64f8f6236ebc23a22e8b04dc66e5181a5de","modified":1562317629675},{"_id":"source/_posts/我的个人博客.md","hash":"b7cdbeef8e881f8b85fb1082a3bfbd0ef00a9e80","modified":1560566196734},{"_id":"source/_posts/shell.md","hash":"68497ada20b60fe6be2b154f4f0125fde65e9292","modified":1560935849990},{"_id":"source/categories/index.md","hash":"05883fada4b76265ad8b80c0b342ad6d712200d5","modified":1556348810161},{"_id":"source/img/avatar.jpg","hash":"c58c76d897c1c4609fc00881e0688532f1c36829","modified":1556348810161},{"_id":"source/img/docker_01.png","hash":"d0a73f4e314d2f1fb1135f10d95a80110b029be6","modified":1558317271674},{"_id":"source/gallery/index.md","hash":"122bfd39f71db0eafbfc396383a7442b268e675c","modified":1556348810161},{"_id":"source/tags/index.md","hash":"0261e5eecd5ff46d578f28765f0e9667be763f80","modified":1556348810161},{"_id":"source/img/.DS_Store","hash":"df2fbeb1400acda0909a32c1cf6bf492f1121e07","modified":1557910819223},{"_id":"source/img/favicon.ico","hash":"c91cdd32a37722963a6b3125c93c224a986714b7","modified":1556348810161},{"_id":"themes/aircloud/.git/HEAD","hash":"acbaef275e46a7f14c1ef456fff2c8bbe8c84724","modified":1562316717972},{"_id":"themes/aircloud/.git/config","hash":"48048394e1e7843aedaf92d1314241ce54401074","modified":1562316717975},{"_id":"themes/aircloud/.git/description","hash":"9635f1b7e12c045212819dd934d809ef07efa2f4","modified":1562316717976},{"_id":"themes/aircloud/.git/index","hash":"88ed2b70904c222213c166490ab69a173b5fa0bf","modified":1562316717988},{"_id":"themes/aircloud/.git/packed-refs","hash":"beaba836ac1d1ab36f2e62ee2bd7ba7b0d805f13","modified":1562316717997},{"_id":"themes/aircloud/languages/zh.yml","hash":"9ffaff1f5d240c94e44f9ef3b02bbae146af0dd4","modified":1562316718005},{"_id":"themes/aircloud/languages/en.yml","hash":"f3dd50ca369974ac7d335fb1cfabf4ebb04a64fa","modified":1562316718004},{"_id":"themes/aircloud/layout/404.ejs","hash":"8a30233a7b99831bd771121b5f450aaba412e8d5","modified":1562316718006},{"_id":"themes/aircloud/layout/about.ejs","hash":"cec034166ce08d2f8c961178e07b2f0ceac95cf2","modified":1562316718011},{"_id":"themes/aircloud/layout/archive.ejs","hash":"0f8a062f4f2f0648b23bd8c4a21945a6ca60dc1f","modified":1562316718012},{"_id":"themes/aircloud/layout/layout.ejs","hash":"7efd113aee90e698e187d0ea1f0b42a1c00d210e","modified":1562316718013},{"_id":"themes/aircloud/layout/index.ejs","hash":"09e2407d615be7fe7ac41d11df3b7026e7393080","modified":1562316718013},{"_id":"themes/aircloud/layout/tags.ejs","hash":"1a174d9213d25d9bf6ef28aabdaea6661cdd88c8","modified":1562316718017},{"_id":"themes/aircloud/layout/post.ejs","hash":"2eb5fc0c2bb801528c3db3b09e6cb4d073e3ad99","modified":1562316718016},{"_id":"themes/aircloud/source/_less/about.css","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1562316718022},{"_id":"themes/aircloud/source/_less/about.less","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1562316718023},{"_id":"themes/aircloud/source/_less/diff.css","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1562316718027},{"_id":"themes/aircloud/source/_less/diff.less","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1562316718027},{"_id":"themes/aircloud/source/_less/page.css","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1562316718041},{"_id":"themes/aircloud/source/_less/page.less","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1562316718042},{"_id":"themes/aircloud/source/_less/theme.css","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1562316718046},{"_id":"themes/aircloud/source/_less/theme.less","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1562316718047},{"_id":"source/_posts/msl/20180912154639866.png","hash":"ae7700ed8ad600e95bb3d520395b6276fdcd5eed","modified":1578470863557},{"_id":"themes/aircloud/.git/hooks/applypatch-msg.sample","hash":"4de88eb95a5e93fd27e78b5fb3b5231a8d8917dd","modified":1562316717978},{"_id":"themes/aircloud/.git/hooks/commit-msg.sample","hash":"ee1ed5aad98a435f2020b6de35c173b75d9affac","modified":1562316717978},{"_id":"themes/aircloud/.git/hooks/fsmonitor-watchman.sample","hash":"f7c0aa40cb0d620ff0bca3efe3521ec79e5d7156","modified":1562316717979},{"_id":"themes/aircloud/.git/hooks/post-update.sample","hash":"b614c2f63da7dca9f1db2e7ade61ef30448fc96c","modified":1562316717980},{"_id":"themes/aircloud/.git/hooks/pre-push.sample","hash":"5c8518bfd1d1d3d2c1a7194994c0a16d8a313a41","modified":1562316717985},{"_id":"themes/aircloud/.git/hooks/pre-applypatch.sample","hash":"f208287c1a92525de9f5462e905a9d31de1e2d75","modified":1562316717980},{"_id":"themes/aircloud/.git/hooks/pre-rebase.sample","hash":"288efdc0027db4cfd8b7c47c4aeddba09b6ded12","modified":1562316717986},{"_id":"themes/aircloud/.git/hooks/pre-commit.sample","hash":"36aed8976dcc08b5076844f0ec645b18bc37758f","modified":1562316717984},{"_id":"themes/aircloud/.git/hooks/pre-receive.sample","hash":"705a17d259e7896f0082fe2e9f2c0c3b127be5ac","modified":1562316717986},{"_id":"themes/aircloud/.git/hooks/prepare-commit-msg.sample","hash":"2584806ba147152ae005cb675aa4f01d5d068456","modified":1562316717987},{"_id":"themes/aircloud/.git/hooks/update.sample","hash":"e729cd61b27c128951d139de8e7c63d1a3758dde","modified":1562316717987},{"_id":"themes/aircloud/.git/info/exclude","hash":"bb5a85730dcf100facee799c05cc4f6affec0745","modified":1562316717989},{"_id":"themes/aircloud/.git/logs/HEAD","hash":"b5807c679f93ba667135c06e1b2af4282fee128b","modified":1562316717990},{"_id":"themes/aircloud/layout/_partial/head.ejs","hash":"3f18d5d4951a205bab25b08d6bf85b054c84a21b","modified":1562316718009},{"_id":"themes/aircloud/layout/_partial/nav.ejs","hash":"079fa72aa7a02ee11f6a44a8a9e58eb80fe28190","modified":1562316718010},{"_id":"themes/aircloud/layout/_partial/donate.ejs","hash":"81c976a3b7fa5c47ef61181d537220eaf1d55eac","modified":1562316718008},{"_id":"themes/aircloud/layout/_partial/footer.ejs","hash":"33db88f1b03548c5181c04d44387dc68a9c4cdf6","modified":1562316718009},{"_id":"themes/aircloud/layout/_partial/toc.ejs","hash":"41d11d159011466f0b6272aca9a74df8642b693f","modified":1562316718011},{"_id":"themes/aircloud/source/css/aircloud.less","hash":"45cab2da310dbfcba37ac3db657db77b4adac60d","modified":1562316718054},{"_id":"themes/aircloud/source/css/aircloud.css.map","hash":"50db34961d11f6f461e23912609d25141068a6fc","modified":1562316718053},{"_id":"themes/aircloud/source/css/aircloud.css","hash":"e6082557a5f0e546169ab1aa0ba29bda4ef5c182","modified":1562316718052},{"_id":"themes/aircloud/source/css/gitment.css","hash":"926b553be983d6dd90bcb60c5d6d4ee215d268a6","modified":1562316718054},{"_id":"themes/aircloud/source/_less/archive.css","hash":"905efcc06a62d1e8b60df0e12434afa353378d3a","modified":1562316718024},{"_id":"themes/aircloud/source/_less/archive.less","hash":"5538d38614960e69b97a7f80f38b5933851212b8","modified":1562316718024},{"_id":"themes/aircloud/source/_less/common.css","hash":"64914aa6ecd5b948676870e0809e0f220b162e3b","modified":1562316718025},{"_id":"themes/aircloud/source/_less/common.less","hash":"8aef4d8cfdefbcd2e28d4985a4f79a5005ca0b6c","modified":1562316718026},{"_id":"themes/aircloud/source/_less/donate.css","hash":"ae6a676a42321512f0536c5230bb53084aaf2c2f","modified":1562316718028},{"_id":"themes/aircloud/source/_less/donate.less","hash":"d63139f4aa148bf894afa5c1007a4398696a0e4c","modified":1562316718029},{"_id":"themes/aircloud/source/_less/gitment.css","hash":"7d560b64e367129f98424052c660ae82b03a1d02","modified":1562316718030},{"_id":"themes/aircloud/source/_less/gitment.less","hash":"916deb8ecdee798d7a9b43b544e31dfd5bbd6de4","modified":1562316718031},{"_id":"themes/aircloud/source/_less/hightlight.css","hash":"4e5a9ec3e88fbc2ce0faabceff8d3f5099ea1012","modified":1562316718032},{"_id":"themes/aircloud/source/_less/hightlight.less","hash":"4e5a9ec3e88fbc2ce0faabceff8d3f5099ea1012","modified":1562316718034},{"_id":"themes/aircloud/source/_less/index.less","hash":"502d689e3568056cc27dd4da7da2499b0be4253e","modified":1562316718036},{"_id":"themes/aircloud/source/_less/index.css","hash":"52fe4d1b93dfb4c9c9d63e24862354b6a0ef47f8","modified":1562316718035},{"_id":"themes/aircloud/source/_less/layout.css","hash":"40d7cadf42b130ea1b40de1ae73b2b00e27f476f","modified":1562316718037},{"_id":"themes/aircloud/source/_less/layout.less","hash":"194ac7db2eeee7307fcb7470302f8172100181fb","modified":1562316718039},{"_id":"themes/aircloud/source/_less/nav.less","hash":"627e33cafb4ca9c191053b10917fc21c68c6ee8c","modified":1562316718040},{"_id":"themes/aircloud/source/_less/post.css","hash":"4adf531589cb55413264c188b29ae47ab703beb8","modified":1562316718043},{"_id":"themes/aircloud/source/_less/nav.css","hash":"32e352d71dc2e67d69a26d8b5116a27d8d2a7718","modified":1562316718040},{"_id":"themes/aircloud/source/_less/post.less","hash":"bbbd81c03e7581950d82bf971eda49e8bed7bee1","modified":1562316718044},{"_id":"themes/aircloud/source/_less/tag.css","hash":"3250887aaae0bc62bd82082d000ce3de8cc55ab6","modified":1562316718045},{"_id":"themes/aircloud/source/_less/tag.less","hash":"47e1ce2f55e2b62beefd0f69dfe7deb594e7b309","modified":1562316718045},{"_id":"themes/aircloud/source/_less/toc.less","hash":"c873ce552b22b0aa2c51a386a91516cadf9160ba","modified":1562316718048},{"_id":"themes/aircloud/source/_less/toc.css","hash":"83b1a219e7fe66d9d6cc34600e5a16311381a883","modified":1562316718047},{"_id":"themes/aircloud/source/_less/variables.css","hash":"9768d38beea904c4febc704192a49c8f7ae6e06c","modified":1562316718049},{"_id":"themes/aircloud/source/_less/variables.less","hash":"49503f7a6c51edd6f1dbdea5345df6bb903b18a5","modified":1562316718050},{"_id":"themes/aircloud/source/js/index.js","hash":"086352f89a0857f9592bfb783bd50afaa50f9b3d","modified":1562316718059},{"_id":"source/_posts/xgp-zerotier/CD65E8E75C1CBF3BF60AFBF278909ACD.jpg","hash":"c05855d5979ea1af70d3f4ff34f8e7537c90edd4","modified":1577959706553},{"_id":"source/img/iis_05.png","hash":"1344136ae2456bd237a30e05ace0d26281243d08","modified":1557910475923},{"_id":"source/img/iis_07.png","hash":"02fb064dc8f54c752d075df6b08bcf1c5def180f","modified":1557911590932},{"_id":"source/img/iis_01.png","hash":"2bcaf156fdea27b6d26c5a4f3e26ab009ffebbff","modified":1557909537103},{"_id":"source/img/iis_04.png","hash":"9d3d18ceeaed19f20e10d14a5232b00e5dcd5377","modified":1557910494044},{"_id":"themes/aircloud/.git/refs/heads/master","hash":"e6c2d158df38be928c722b48832b6bdeacbe8d8c","modified":1562316717999},{"_id":"themes/aircloud/.git/objects/pack/pack-7a3da719c373a1ad35f506ffcf0db47a3f8954b7.idx","hash":"7ffe1a64165a0653f2a201a5dfcf915e3554323a","modified":1562316717995},{"_id":"themes/aircloud/source/_less/_partial/footer.css","hash":"e00d722211b4695449d72850340ac0dd701d6ede","modified":1562316718021},{"_id":"themes/aircloud/source/_less/_partial/footer.css.map","hash":"9e8d4df5d08425de5a8b247d0dd8b805c6edc661","modified":1562316718021},{"_id":"themes/aircloud/source/_less/_partial/footer.less","hash":"d1469f97daf750f3e4be18c4d640772780c32a75","modified":1562316718022},{"_id":"themes/aircloud/source/js/gitment.js","hash":"89687f8fffe1125e08323fd6635ca4e53771c05e","modified":1562316718056},{"_id":"source/_posts/msl/WX20200108-154615@2x.png","hash":"c9449c51d2d2e77de7a16a94d897f9d5302bf40d","modified":1578469599797},{"_id":"source/img/iis_02.png","hash":"e1b5c2929e692d3f7106002ae1968c077f28c205","modified":1557909812271},{"_id":"themes/aircloud/.git/refs/remotes/origin/HEAD","hash":"d9427cda09aba1cdde5c69c2b13c905bddb0bc51","modified":1562316718001},{"_id":"themes/aircloud/.git/logs/refs/heads/master","hash":"b5807c679f93ba667135c06e1b2af4282fee128b","modified":1562316717992},{"_id":"themes/aircloud/.git/objects/pack/pack-7a3da719c373a1ad35f506ffcf0db47a3f8954b7.pack","hash":"ec6437f12de8628a1a70cf78011f06247594a93e","modified":1562316717996},{"_id":"source/img/iis_03.png","hash":"69c5035e7f8786b54b58a15d0785811d7b816aa3","modified":1557909944163},{"_id":"source/img/iis_06.png","hash":"da3ccd9ffc56d8535f50e029cb3702fe81d1b694","modified":1557910988825},{"_id":"themes/aircloud/.git/logs/refs/remotes/origin/HEAD","hash":"b5807c679f93ba667135c06e1b2af4282fee128b","modified":1562316717993},{"_id":"source/_posts/msl/WX20200108-160028@2x.png","hash":"09b1ad523202aacbe728fbff75356c1ec8416a86","modified":1578470431292},{"_id":"source/img/iis_08.png","hash":"ad59aab613b2a29d980cd99426c71a9ec71edaaf","modified":1557911651721},{"_id":"source/_posts/msl/WX20200108-155928@2x.png","hash":"73221f67e6854cd1cffd6190bdce07287a0bf883","modified":1578470371323},{"_id":"source/_posts/msl/A84A183D1145E8245B6A7C8A84FB985F.jpg","hash":"870e13a761a76f6512eec1f15a482e48484f51f9","modified":1578470222011},{"_id":"source/_posts/msl/WX20200108-154856@2x.png","hash":"e6cc5fae3f01c045a81b8f99405bb39b13047270","modified":1578469740919},{"_id":"source/_posts/msl/WX20200108-155336@2x.png","hash":"adcb1b8dce77fe2bf0791940c2830b5c0f13fcbe","modified":1578470019439},{"_id":"source/_posts/mysql-explain/2864885534-202c0878c1abf896.png","hash":"2d887de1e5d3b758a150e0d320b41158b6bff244","modified":1577960699239},{"_id":"source/_posts/python3/1.png","hash":"0be2eb75fa3334297feebe5cacf1d75d4b5f8c5f","modified":1578014038791}],"Category":[],"Data":[],"Page":[{"layout":"404","description":"你来到了没有知识的荒原 :(","header-img":"img/404-bg.jpg","_content":"","source":"404.md","raw":"---\nlayout: 404\ndescription: \"你来到了没有知识的荒原 :(\"\nheader-img: \"img/404-bg.jpg\"\n---\n","date":"2019-04-27T07:06:50.160Z","updated":"2019-04-27T07:06:50.160Z","path":"404.html","title":"","comments":1,"_id":"ck550trk80000hm62blzf2g0h","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"关于","date":"2018-11-03T06:30:12.000Z","layout":"about","type":"about","_content":"\n## 我\n\n一个程序员, 喜欢折腾, 但是得到的收获却很少, 如果博客哪里有写的不好, 欢迎评论批评.\n","source":"about/index.md","raw":"---\ntitle: 关于\ndate: 2018-11-03 14:30:12\nlayout: about\ntype: about\n---\n\n## 我\n\n一个程序员, 喜欢折腾, 但是得到的收获却很少, 如果博客哪里有写的不好, 欢迎评论批评.\n","updated":"2019-07-05T09:07:09.675Z","path":"about/index.html","comments":1,"_id":"ck550trl70002hm62nmtdemt8","content":"<h2 id=\"我\"><a href=\"#我\" class=\"headerlink\" title=\"我\"></a>我</h2><p>一个程序员, 喜欢折腾, 但是得到的收获却很少, 如果博客哪里有写的不好, 欢迎评论批评.</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"我\"><a href=\"#我\" class=\"headerlink\" title=\"我\"></a>我</h2><p>一个程序员, 喜欢折腾, 但是得到的收获却很少, 如果博客哪里有写的不好, 欢迎评论批评.</p>\n"},{"title":"分类","date":"2018-11-03T06:27:42.000Z","layout":"categories","type":"categories","_content":"","source":"categories/index.md","raw":"---\ntitle: 分类\ndate: 2018-11-03 14:27:42\nlayout: categories\ntype: categories\n---\n","updated":"2019-04-27T07:06:50.161Z","path":"categories/index.html","comments":1,"_id":"ck550trla0004hm62uzaey4yr","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"相册","date":"2018-11-03T06:30:54.000Z","layout":"gallery","type":"gallery","_content":"","source":"gallery/index.md","raw":"---\ntitle: 相册\ndate: 2018-11-03 14:30:54\nlayout: gallery\ntype: gallery\n---\n","updated":"2019-04-27T07:06:50.161Z","path":"gallery/index.html","comments":1,"_id":"ck550trle0007hm627ph8hn3s","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"标签","date":"2018-11-03T06:29:36.000Z","layout":"tags","type":"tags","_content":"","source":"tags/index.md","raw":"---\ntitle: 标签\ndate: 2018-11-03 14:29:36\nlayout: tags\ntype: tags\n---\n","updated":"2019-04-27T07:06:50.161Z","path":"tags/index.html","comments":1,"_id":"ck550trlg0009hm626p0t12w2","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"title":"Hello World","date":"2018-12-31T16:00:00.000Z","_content":"Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\nhexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\nhexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\nhexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\nhexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/deployment.html)","source":"_posts/hello-world.md","raw":"---\ntitle: Hello World\ndate: 2019-01-01 00:00:00\ntag: Hello World\n---\nWelcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\nhexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\nhexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\nhexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\nhexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/deployment.html)","slug":"hello-world","published":1,"updated":"2019-04-27T07:06:50.160Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck550trl40001hm624sat85tv","content":"<p>Welcome to <a href=\"https://hexo.io/\" target=\"_blank\" rel=\"noopener\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\" target=\"_blank\" rel=\"noopener\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\" target=\"_blank\" rel=\"noopener\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\" target=\"_blank\" rel=\"noopener\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo new <span class=\"string\">\"My New Post\"</span></span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\" target=\"_blank\" rel=\"noopener\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo server</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/server.html\" target=\"_blank\" rel=\"noopener\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo generate</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\" target=\"_blank\" rel=\"noopener\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo deploy</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/deployment.html\" target=\"_blank\" rel=\"noopener\">Deployment</a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>Welcome to <a href=\"https://hexo.io/\" target=\"_blank\" rel=\"noopener\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\" target=\"_blank\" rel=\"noopener\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\" target=\"_blank\" rel=\"noopener\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\" target=\"_blank\" rel=\"noopener\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo new <span class=\"string\">\"My New Post\"</span></span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\" target=\"_blank\" rel=\"noopener\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo server</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/server.html\" target=\"_blank\" rel=\"noopener\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo generate</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\" target=\"_blank\" rel=\"noopener\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">hexo deploy</span><br></pre></td></tr></table></figure>\n<p>More info: <a href=\"https://hexo.io/docs/deployment.html\" target=\"_blank\" rel=\"noopener\">Deployment</a></p>\n"},{"title":"clickhouse学习笔记","date":"2019-10-11T02:06:44.000Z","_content":"\nClickHouse是一个用于联机分析(**OLAP**)的**列式**数据库管理系统(DBMS)。\n\n## Clickhouse使用\n\n[官网](https://clickhouse.yandex/)\n\n[官方文档](https://clickhouse.yandex/docs/zh/)\n\n### 入门(单机)\n\n使用docker部署\n\n```sh\ndocker pull yandex/clickhouse-server:latest\ndocker run -d -p 8123:8123 -p 9000:9000 -p 9009:9009 --name clickhouse yandex/clickhouse-server:latest\n```\n\n> 其他方式安装参考 [部署运行](https://clickhouse.yandex/docs/zh/getting_started/)\n\n1. 默认没有用户, 设置用户名密码参考 `/etc/clickhouse-server/users.xml` 做添加/修改\n2. 默认数据库 `default`\n3. 自定义配置文件可以存放在 `/etc/clickhouse-server/config.d` 和 `/etc/clickhouse-server/users.d` 分别对应 系统配置/用户配置, 自动融合到主配置文件中\n\n### 集群\n\n#### 多副本\n\n在 `/etc/clickhouse-server/config.d` 下添加配置文件 `remote_servers.xml`, 例:\n\n```xml\n<yandex>\n    <remote_servers incl=\"clickhouse_remote_servers\" > <!--集群节点配置-->\n        <test_clu> <!-- 集群名称 -->\n            <shard> <!-- 分片1 -->\n                <internal_replication>false</internal_replication> <!-- 插入数据时,向所有副本插入数据 -->\n                <replica> <!-- 副本1 -->\n                    <default_database>default</default_database>\n                    <host>${host_name}</host> <!--ip-->\n                    <port>9000</port>  <!--port-->\n                    <user>default</user> <!-- 用户名密码.可选 -->\n                    <password>123456</password>\n                </replica>\n                <replica> <!-- 副本1 -->\n                    <default_database>default</default_database>\n                    <host>${host_name}</host>\n                    <port>9000</port>\n                    <user>default</user>\n                    <password>123456</password>\n                </replica>\n             </shard>\n         </test_clu>\n    </remote_servers>\n</yandex>\n```\n\n#### 分布式+多副本+高可用 (同步插入)\n\n1. 在 `/etc/clickhouse-server/config.d` 下添加配置文件 `remote_servers.xml`\n2. 在 `/etc/clickhouse-server/config.d` 下添加配置文件 `zookeeper.xml`\n3. 所有机器都需要创建相同的 `副本表、分布式表`\n4. zookeeper 用与分布式协调\n5. 分片参数 `internal_replication` 必须设置为 true\n6. marcos.xml **每个副本都应该唯一**\n\nsql参考\n\n```sql\n--  创建副本表\ncreate table if not exists default.c_user (\n    `id` int,\n    `name` Nullable(String),\n    `sex` int,\n    `address` Nullable(String),\n    `datetime` Date DEFAULT now()\n) ENGINE =MergeTree();\n\n-- 创建分布式表\ncreate table if not exists default.user_all (\n    `id` int,\n    `name` Nullable(String),\n    `sex` int,\n    `address` Nullable(String),\n    `datetime` Date DEFAULT now()\n) engine = Distributed(test_clu, 'default', 'c_user', rand()); -- 集群名称, 数据库, 副本表, 集群数据分配策略\n```\n\n`remote_servers.xml` 参考配置\n\n```xml\n<yandex>\n    <remote_servers incl=\"clickhouse_remote_servers\" >\n        <test_clu> <!-- 集群名称 -->\n            <shard> <!-- 分片1 -->\n                <internal_replication>true</internal_replication> <!-- 插入数据时,向所有副本插入数据 -->\n                <replica> <!-- 副本1 -->\n                    <default_database>default</default_database>\n                    <host>clickhouse_s1</host>\n                    <port>9000</port>\n                    <user>default</user>\n                    <password>123456</password>\n                </replica>\n                <replica> <!-- 副本2 -->\n                    <default_database>default</default_database>\n                    <host>clickhouse_s3</host>\n                    <port>9000</port>\n                    <user>default</user>\n                    <password>123456</password>\n                </replica>\n             </shard>\n             <shard> <!-- 分片2 -->\n                <internal_replication>true</internal_replication>\n                <replica> <!-- 副本1 -->\n                    <default_database>default</default_database>\n                    <host>clickhouse_s2</host>\n                    <port>9000</port>\n                    <user>default</user>\n                    <password>123456</password>\n                </replica>\n                <replica> <!-- 副本2 -->\n                    <default_database>default</default_database>\n                    <host>clickhouse_s4</host>\n                    <port>9000</port>\n                    <user>default</user>\n                    <password>123456</password>\n                </replica>\n             </shard>\n         </test_clu>\n    </remote_servers>\n\n    <!-- 数据压缩算法 -->\n    <clickhouse_compression>\n        <case>\n            <min_part_size>10000000000</min_part_size>\n            <min_part_size_ratio>0.01</min_part_size_ratio>\n            <method>lz4</method>\n        </case>\n    </clickhouse_compression>\n</yandex>\n```\n\n`zookeeper.xml` 参考配置\n\n```xml\n<yandex>\n    <zookeeper incl=\"zookeeper-servers\">\n        <node index=\"1\">\n            <host>clickhouse_zk0</host>\n            <port>2181</port>\n        </node>\n        <!-- 多节点配置\n        <node index=\"2\">\n            <host>clickhouse_zk1</host>\n            <port>2181</port>\n        </node>\n        -->\n    </zookeeper>\n</yandex>\n```\n\n#### 分布式+多副本+高可用 (复制表)\n\n上面的基础上再在 `/etc/clickhouse-server/config.d` 下添加配置文件 `macros.xml`\n\n这个方式与上面*同步插入*的区别是 *插入数据时,只向一个副本插入,其他副本自动复制数据*, 我们需要将表引擎由`MergeTree`改为`ReplicatedMergeTree`\n\n参考sql\n\n```sql\n--  创建副本表\ncreate table if not exists default.c_user (\n    `id` int,\n    `name` Nullable(String),\n    `sex` int,\n    `address` Nullable(String),\n    `datetime` Date DEFAULT now()\n) ENGINE =ReplicatedMergeTree('/clickhouse/tables/{shard}/default/c_user', '{replica}',`datetime` ,(`datetime`,`id`),8192);\n-- {shard} 会自动从 macros.xml 中获取配置\n-- {replica} 会自动从 macros.xml 中获取配置\n-- `datetime` 是时间类型的字段\n\n-- 创建分布式表\ncreate table if not exists default.user_all (\n    `id` int,\n    `name` Nullable(String),\n    `sex` int,\n    `address` Nullable(String),\n    `datetime` Date DEFAULT now()\n) engine = Distributed(test_clu, 'default', 'c_user', rand());\n```\n\nmarcos.xml 参考配置\n\n```xml\n<yandex>\n    <macros replace=\"replace\">\n        <shard>SHARD_NAME</shard> <!--集群ID-->\n        <replica>REPLICA_NAME</replica> <!--副本ID-->\n    </macros>\n</yandex>\n```\n\n> **每个副本都应该唯一**\n\n## 总结\n\nclickhouse用于大数据查询, 占用空间少, 查询速度快\n","source":"_posts/clickhouse.md","raw":"---\ntitle: clickhouse学习笔记\ndate: 2019-10-11 10:06:44\ntags: 数据库\n---\n\nClickHouse是一个用于联机分析(**OLAP**)的**列式**数据库管理系统(DBMS)。\n\n## Clickhouse使用\n\n[官网](https://clickhouse.yandex/)\n\n[官方文档](https://clickhouse.yandex/docs/zh/)\n\n### 入门(单机)\n\n使用docker部署\n\n```sh\ndocker pull yandex/clickhouse-server:latest\ndocker run -d -p 8123:8123 -p 9000:9000 -p 9009:9009 --name clickhouse yandex/clickhouse-server:latest\n```\n\n> 其他方式安装参考 [部署运行](https://clickhouse.yandex/docs/zh/getting_started/)\n\n1. 默认没有用户, 设置用户名密码参考 `/etc/clickhouse-server/users.xml` 做添加/修改\n2. 默认数据库 `default`\n3. 自定义配置文件可以存放在 `/etc/clickhouse-server/config.d` 和 `/etc/clickhouse-server/users.d` 分别对应 系统配置/用户配置, 自动融合到主配置文件中\n\n### 集群\n\n#### 多副本\n\n在 `/etc/clickhouse-server/config.d` 下添加配置文件 `remote_servers.xml`, 例:\n\n```xml\n<yandex>\n    <remote_servers incl=\"clickhouse_remote_servers\" > <!--集群节点配置-->\n        <test_clu> <!-- 集群名称 -->\n            <shard> <!-- 分片1 -->\n                <internal_replication>false</internal_replication> <!-- 插入数据时,向所有副本插入数据 -->\n                <replica> <!-- 副本1 -->\n                    <default_database>default</default_database>\n                    <host>${host_name}</host> <!--ip-->\n                    <port>9000</port>  <!--port-->\n                    <user>default</user> <!-- 用户名密码.可选 -->\n                    <password>123456</password>\n                </replica>\n                <replica> <!-- 副本1 -->\n                    <default_database>default</default_database>\n                    <host>${host_name}</host>\n                    <port>9000</port>\n                    <user>default</user>\n                    <password>123456</password>\n                </replica>\n             </shard>\n         </test_clu>\n    </remote_servers>\n</yandex>\n```\n\n#### 分布式+多副本+高可用 (同步插入)\n\n1. 在 `/etc/clickhouse-server/config.d` 下添加配置文件 `remote_servers.xml`\n2. 在 `/etc/clickhouse-server/config.d` 下添加配置文件 `zookeeper.xml`\n3. 所有机器都需要创建相同的 `副本表、分布式表`\n4. zookeeper 用与分布式协调\n5. 分片参数 `internal_replication` 必须设置为 true\n6. marcos.xml **每个副本都应该唯一**\n\nsql参考\n\n```sql\n--  创建副本表\ncreate table if not exists default.c_user (\n    `id` int,\n    `name` Nullable(String),\n    `sex` int,\n    `address` Nullable(String),\n    `datetime` Date DEFAULT now()\n) ENGINE =MergeTree();\n\n-- 创建分布式表\ncreate table if not exists default.user_all (\n    `id` int,\n    `name` Nullable(String),\n    `sex` int,\n    `address` Nullable(String),\n    `datetime` Date DEFAULT now()\n) engine = Distributed(test_clu, 'default', 'c_user', rand()); -- 集群名称, 数据库, 副本表, 集群数据分配策略\n```\n\n`remote_servers.xml` 参考配置\n\n```xml\n<yandex>\n    <remote_servers incl=\"clickhouse_remote_servers\" >\n        <test_clu> <!-- 集群名称 -->\n            <shard> <!-- 分片1 -->\n                <internal_replication>true</internal_replication> <!-- 插入数据时,向所有副本插入数据 -->\n                <replica> <!-- 副本1 -->\n                    <default_database>default</default_database>\n                    <host>clickhouse_s1</host>\n                    <port>9000</port>\n                    <user>default</user>\n                    <password>123456</password>\n                </replica>\n                <replica> <!-- 副本2 -->\n                    <default_database>default</default_database>\n                    <host>clickhouse_s3</host>\n                    <port>9000</port>\n                    <user>default</user>\n                    <password>123456</password>\n                </replica>\n             </shard>\n             <shard> <!-- 分片2 -->\n                <internal_replication>true</internal_replication>\n                <replica> <!-- 副本1 -->\n                    <default_database>default</default_database>\n                    <host>clickhouse_s2</host>\n                    <port>9000</port>\n                    <user>default</user>\n                    <password>123456</password>\n                </replica>\n                <replica> <!-- 副本2 -->\n                    <default_database>default</default_database>\n                    <host>clickhouse_s4</host>\n                    <port>9000</port>\n                    <user>default</user>\n                    <password>123456</password>\n                </replica>\n             </shard>\n         </test_clu>\n    </remote_servers>\n\n    <!-- 数据压缩算法 -->\n    <clickhouse_compression>\n        <case>\n            <min_part_size>10000000000</min_part_size>\n            <min_part_size_ratio>0.01</min_part_size_ratio>\n            <method>lz4</method>\n        </case>\n    </clickhouse_compression>\n</yandex>\n```\n\n`zookeeper.xml` 参考配置\n\n```xml\n<yandex>\n    <zookeeper incl=\"zookeeper-servers\">\n        <node index=\"1\">\n            <host>clickhouse_zk0</host>\n            <port>2181</port>\n        </node>\n        <!-- 多节点配置\n        <node index=\"2\">\n            <host>clickhouse_zk1</host>\n            <port>2181</port>\n        </node>\n        -->\n    </zookeeper>\n</yandex>\n```\n\n#### 分布式+多副本+高可用 (复制表)\n\n上面的基础上再在 `/etc/clickhouse-server/config.d` 下添加配置文件 `macros.xml`\n\n这个方式与上面*同步插入*的区别是 *插入数据时,只向一个副本插入,其他副本自动复制数据*, 我们需要将表引擎由`MergeTree`改为`ReplicatedMergeTree`\n\n参考sql\n\n```sql\n--  创建副本表\ncreate table if not exists default.c_user (\n    `id` int,\n    `name` Nullable(String),\n    `sex` int,\n    `address` Nullable(String),\n    `datetime` Date DEFAULT now()\n) ENGINE =ReplicatedMergeTree('/clickhouse/tables/{shard}/default/c_user', '{replica}',`datetime` ,(`datetime`,`id`),8192);\n-- {shard} 会自动从 macros.xml 中获取配置\n-- {replica} 会自动从 macros.xml 中获取配置\n-- `datetime` 是时间类型的字段\n\n-- 创建分布式表\ncreate table if not exists default.user_all (\n    `id` int,\n    `name` Nullable(String),\n    `sex` int,\n    `address` Nullable(String),\n    `datetime` Date DEFAULT now()\n) engine = Distributed(test_clu, 'default', 'c_user', rand());\n```\n\nmarcos.xml 参考配置\n\n```xml\n<yandex>\n    <macros replace=\"replace\">\n        <shard>SHARD_NAME</shard> <!--集群ID-->\n        <replica>REPLICA_NAME</replica> <!--副本ID-->\n    </macros>\n</yandex>\n```\n\n> **每个副本都应该唯一**\n\n## 总结\n\nclickhouse用于大数据查询, 占用空间少, 查询速度快\n","slug":"clickhouse","published":1,"updated":"2019-10-11T02:10:49.719Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck550trl80003hm62twwzrqhj","content":"<p>ClickHouse是一个用于联机分析(<strong>OLAP</strong>)的<strong>列式</strong>数据库管理系统(DBMS)。</p>\n<h2 id=\"Clickhouse使用\"><a href=\"#Clickhouse使用\" class=\"headerlink\" title=\"Clickhouse使用\"></a>Clickhouse使用</h2><p><a href=\"https://clickhouse.yandex/\" target=\"_blank\" rel=\"noopener\">官网</a></p>\n<p><a href=\"https://clickhouse.yandex/docs/zh/\" target=\"_blank\" rel=\"noopener\">官方文档</a></p>\n<h3 id=\"入门-单机\"><a href=\"#入门-单机\" class=\"headerlink\" title=\"入门(单机)\"></a>入门(单机)</h3><p>使用docker部署</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull yandex/clickhouse-server:latest</span><br><span class=\"line\">docker run -d -p 8123:8123 -p 9000:9000 -p 9009:9009 --name clickhouse yandex/clickhouse-server:latest</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>其他方式安装参考 <a href=\"https://clickhouse.yandex/docs/zh/getting_started/\" target=\"_blank\" rel=\"noopener\">部署运行</a></p>\n</blockquote>\n<ol>\n<li>默认没有用户, 设置用户名密码参考 <code>/etc/clickhouse-server/users.xml</code> 做添加/修改</li>\n<li>默认数据库 <code>default</code></li>\n<li>自定义配置文件可以存放在 <code>/etc/clickhouse-server/config.d</code> 和 <code>/etc/clickhouse-server/users.d</code> 分别对应 系统配置/用户配置, 自动融合到主配置文件中</li>\n</ol>\n<h3 id=\"集群\"><a href=\"#集群\" class=\"headerlink\" title=\"集群\"></a>集群</h3><h4 id=\"多副本\"><a href=\"#多副本\" class=\"headerlink\" title=\"多副本\"></a>多副本</h4><p>在 <code>/etc/clickhouse-server/config.d</code> 下添加配置文件 <code>remote_servers.xml</code>, 例:</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">yandex</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">remote_servers</span> <span class=\"attr\">incl</span>=<span class=\"string\">\"clickhouse_remote_servers\"</span> &gt;</span> <span class=\"comment\">&lt;!--集群节点配置--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">test_clu</span>&gt;</span> <span class=\"comment\">&lt;!-- 集群名称 --&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">shard</span>&gt;</span> <span class=\"comment\">&lt;!-- 分片1 --&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">internal_replication</span>&gt;</span>false<span class=\"tag\">&lt;/<span class=\"name\">internal_replication</span>&gt;</span> <span class=\"comment\">&lt;!-- 插入数据时,向所有副本插入数据 --&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">replica</span>&gt;</span> <span class=\"comment\">&lt;!-- 副本1 --&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">default_database</span>&gt;</span>default<span class=\"tag\">&lt;/<span class=\"name\">default_database</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">host</span>&gt;</span>$&#123;host_name&#125;<span class=\"tag\">&lt;/<span class=\"name\">host</span>&gt;</span> <span class=\"comment\">&lt;!--ip--&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">port</span>&gt;</span>9000<span class=\"tag\">&lt;/<span class=\"name\">port</span>&gt;</span>  <span class=\"comment\">&lt;!--port--&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">user</span>&gt;</span>default<span class=\"tag\">&lt;/<span class=\"name\">user</span>&gt;</span> <span class=\"comment\">&lt;!-- 用户名密码.可选 --&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">password</span>&gt;</span>123456<span class=\"tag\">&lt;/<span class=\"name\">password</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">replica</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">replica</span>&gt;</span> <span class=\"comment\">&lt;!-- 副本1 --&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">default_database</span>&gt;</span>default<span class=\"tag\">&lt;/<span class=\"name\">default_database</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">host</span>&gt;</span>$&#123;host_name&#125;<span class=\"tag\">&lt;/<span class=\"name\">host</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">port</span>&gt;</span>9000<span class=\"tag\">&lt;/<span class=\"name\">port</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">user</span>&gt;</span>default<span class=\"tag\">&lt;/<span class=\"name\">user</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">password</span>&gt;</span>123456<span class=\"tag\">&lt;/<span class=\"name\">password</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">replica</span>&gt;</span></span><br><span class=\"line\">             <span class=\"tag\">&lt;/<span class=\"name\">shard</span>&gt;</span></span><br><span class=\"line\">         <span class=\"tag\">&lt;/<span class=\"name\">test_clu</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">remote_servers</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">yandex</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"分布式-多副本-高可用-同步插入\"><a href=\"#分布式-多副本-高可用-同步插入\" class=\"headerlink\" title=\"分布式+多副本+高可用 (同步插入)\"></a>分布式+多副本+高可用 (同步插入)</h4><ol>\n<li>在 <code>/etc/clickhouse-server/config.d</code> 下添加配置文件 <code>remote_servers.xml</code></li>\n<li>在 <code>/etc/clickhouse-server/config.d</code> 下添加配置文件 <code>zookeeper.xml</code></li>\n<li>所有机器都需要创建相同的 <code>副本表、分布式表</code></li>\n<li>zookeeper 用与分布式协调</li>\n<li>分片参数 <code>internal_replication</code> 必须设置为 true</li>\n<li>marcos.xml <strong>每个副本都应该唯一</strong></li>\n</ol>\n<p>sql参考</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">--  创建副本表</span></span><br><span class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">table</span> <span class=\"keyword\">if</span> <span class=\"keyword\">not</span> <span class=\"keyword\">exists</span> default.c_user (</span><br><span class=\"line\">    <span class=\"string\">`id`</span> <span class=\"built_in\">int</span>,</span><br><span class=\"line\">    <span class=\"string\">`name`</span> Nullable(<span class=\"keyword\">String</span>),</span><br><span class=\"line\">    <span class=\"string\">`sex`</span> <span class=\"built_in\">int</span>,</span><br><span class=\"line\">    <span class=\"string\">`address`</span> Nullable(<span class=\"keyword\">String</span>),</span><br><span class=\"line\">    <span class=\"string\">`datetime`</span> <span class=\"built_in\">Date</span> <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">now</span>()</span><br><span class=\"line\">) <span class=\"keyword\">ENGINE</span> =MergeTree();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 创建分布式表</span></span><br><span class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">table</span> <span class=\"keyword\">if</span> <span class=\"keyword\">not</span> <span class=\"keyword\">exists</span> default.user_all (</span><br><span class=\"line\">    <span class=\"string\">`id`</span> <span class=\"built_in\">int</span>,</span><br><span class=\"line\">    <span class=\"string\">`name`</span> Nullable(<span class=\"keyword\">String</span>),</span><br><span class=\"line\">    <span class=\"string\">`sex`</span> <span class=\"built_in\">int</span>,</span><br><span class=\"line\">    <span class=\"string\">`address`</span> Nullable(<span class=\"keyword\">String</span>),</span><br><span class=\"line\">    <span class=\"string\">`datetime`</span> <span class=\"built_in\">Date</span> <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">now</span>()</span><br><span class=\"line\">) <span class=\"keyword\">engine</span> = <span class=\"keyword\">Distributed</span>(test_clu, <span class=\"string\">'default'</span>, <span class=\"string\">'c_user'</span>, <span class=\"keyword\">rand</span>()); <span class=\"comment\">-- 集群名称, 数据库, 副本表, 集群数据分配策略</span></span><br></pre></td></tr></table></figure>\n<p><code>remote_servers.xml</code> 参考配置</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">yandex</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">remote_servers</span> <span class=\"attr\">incl</span>=<span class=\"string\">\"clickhouse_remote_servers\"</span> &gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">test_clu</span>&gt;</span> <span class=\"comment\">&lt;!-- 集群名称 --&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">shard</span>&gt;</span> <span class=\"comment\">&lt;!-- 分片1 --&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">internal_replication</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">internal_replication</span>&gt;</span> <span class=\"comment\">&lt;!-- 插入数据时,向所有副本插入数据 --&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">replica</span>&gt;</span> <span class=\"comment\">&lt;!-- 副本1 --&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">default_database</span>&gt;</span>default<span class=\"tag\">&lt;/<span class=\"name\">default_database</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">host</span>&gt;</span>clickhouse_s1<span class=\"tag\">&lt;/<span class=\"name\">host</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">port</span>&gt;</span>9000<span class=\"tag\">&lt;/<span class=\"name\">port</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">user</span>&gt;</span>default<span class=\"tag\">&lt;/<span class=\"name\">user</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">password</span>&gt;</span>123456<span class=\"tag\">&lt;/<span class=\"name\">password</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">replica</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">replica</span>&gt;</span> <span class=\"comment\">&lt;!-- 副本2 --&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">default_database</span>&gt;</span>default<span class=\"tag\">&lt;/<span class=\"name\">default_database</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">host</span>&gt;</span>clickhouse_s3<span class=\"tag\">&lt;/<span class=\"name\">host</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">port</span>&gt;</span>9000<span class=\"tag\">&lt;/<span class=\"name\">port</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">user</span>&gt;</span>default<span class=\"tag\">&lt;/<span class=\"name\">user</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">password</span>&gt;</span>123456<span class=\"tag\">&lt;/<span class=\"name\">password</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">replica</span>&gt;</span></span><br><span class=\"line\">             <span class=\"tag\">&lt;/<span class=\"name\">shard</span>&gt;</span></span><br><span class=\"line\">             <span class=\"tag\">&lt;<span class=\"name\">shard</span>&gt;</span> <span class=\"comment\">&lt;!-- 分片2 --&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">internal_replication</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">internal_replication</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">replica</span>&gt;</span> <span class=\"comment\">&lt;!-- 副本1 --&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">default_database</span>&gt;</span>default<span class=\"tag\">&lt;/<span class=\"name\">default_database</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">host</span>&gt;</span>clickhouse_s2<span class=\"tag\">&lt;/<span class=\"name\">host</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">port</span>&gt;</span>9000<span class=\"tag\">&lt;/<span class=\"name\">port</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">user</span>&gt;</span>default<span class=\"tag\">&lt;/<span class=\"name\">user</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">password</span>&gt;</span>123456<span class=\"tag\">&lt;/<span class=\"name\">password</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">replica</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">replica</span>&gt;</span> <span class=\"comment\">&lt;!-- 副本2 --&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">default_database</span>&gt;</span>default<span class=\"tag\">&lt;/<span class=\"name\">default_database</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">host</span>&gt;</span>clickhouse_s4<span class=\"tag\">&lt;/<span class=\"name\">host</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">port</span>&gt;</span>9000<span class=\"tag\">&lt;/<span class=\"name\">port</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">user</span>&gt;</span>default<span class=\"tag\">&lt;/<span class=\"name\">user</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">password</span>&gt;</span>123456<span class=\"tag\">&lt;/<span class=\"name\">password</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">replica</span>&gt;</span></span><br><span class=\"line\">             <span class=\"tag\">&lt;/<span class=\"name\">shard</span>&gt;</span></span><br><span class=\"line\">         <span class=\"tag\">&lt;/<span class=\"name\">test_clu</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">remote_servers</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 数据压缩算法 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">clickhouse_compression</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">case</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">min_part_size</span>&gt;</span>10000000000<span class=\"tag\">&lt;/<span class=\"name\">min_part_size</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">min_part_size_ratio</span>&gt;</span>0.01<span class=\"tag\">&lt;/<span class=\"name\">min_part_size_ratio</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">method</span>&gt;</span>lz4<span class=\"tag\">&lt;/<span class=\"name\">method</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">case</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">clickhouse_compression</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">yandex</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p><code>zookeeper.xml</code> 参考配置</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">yandex</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">zookeeper</span> <span class=\"attr\">incl</span>=<span class=\"string\">\"zookeeper-servers\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">node</span> <span class=\"attr\">index</span>=<span class=\"string\">\"1\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">host</span>&gt;</span>clickhouse_zk0<span class=\"tag\">&lt;/<span class=\"name\">host</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">port</span>&gt;</span>2181<span class=\"tag\">&lt;/<span class=\"name\">port</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">node</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- 多节点配置</span></span><br><span class=\"line\"><span class=\"comment\">        &lt;node index=\"2\"&gt;</span></span><br><span class=\"line\"><span class=\"comment\">            &lt;host&gt;clickhouse_zk1&lt;/host&gt;</span></span><br><span class=\"line\"><span class=\"comment\">            &lt;port&gt;2181&lt;/port&gt;</span></span><br><span class=\"line\"><span class=\"comment\">        &lt;/node&gt;</span></span><br><span class=\"line\"><span class=\"comment\">        --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">zookeeper</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">yandex</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"分布式-多副本-高可用-复制表\"><a href=\"#分布式-多副本-高可用-复制表\" class=\"headerlink\" title=\"分布式+多副本+高可用 (复制表)\"></a>分布式+多副本+高可用 (复制表)</h4><p>上面的基础上再在 <code>/etc/clickhouse-server/config.d</code> 下添加配置文件 <code>macros.xml</code></p>\n<p>这个方式与上面<em>同步插入</em>的区别是 <em>插入数据时,只向一个副本插入,其他副本自动复制数据</em>, 我们需要将表引擎由<code>MergeTree</code>改为<code>ReplicatedMergeTree</code></p>\n<p>参考sql</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">--  创建副本表</span></span><br><span class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">table</span> <span class=\"keyword\">if</span> <span class=\"keyword\">not</span> <span class=\"keyword\">exists</span> default.c_user (</span><br><span class=\"line\">    <span class=\"string\">`id`</span> <span class=\"built_in\">int</span>,</span><br><span class=\"line\">    <span class=\"string\">`name`</span> Nullable(<span class=\"keyword\">String</span>),</span><br><span class=\"line\">    <span class=\"string\">`sex`</span> <span class=\"built_in\">int</span>,</span><br><span class=\"line\">    <span class=\"string\">`address`</span> Nullable(<span class=\"keyword\">String</span>),</span><br><span class=\"line\">    <span class=\"string\">`datetime`</span> <span class=\"built_in\">Date</span> <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">now</span>()</span><br><span class=\"line\">) <span class=\"keyword\">ENGINE</span> =ReplicatedMergeTree(<span class=\"string\">'/clickhouse/tables/&#123;shard&#125;/default/c_user'</span>, <span class=\"string\">'&#123;replica&#125;'</span>,<span class=\"string\">`datetime`</span> ,(<span class=\"string\">`datetime`</span>,<span class=\"string\">`id`</span>),<span class=\"number\">8192</span>);</span><br><span class=\"line\"><span class=\"comment\">-- &#123;shard&#125; 会自动从 macros.xml 中获取配置</span></span><br><span class=\"line\"><span class=\"comment\">-- &#123;replica&#125; 会自动从 macros.xml 中获取配置</span></span><br><span class=\"line\"><span class=\"comment\">-- `datetime` 是时间类型的字段</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 创建分布式表</span></span><br><span class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">table</span> <span class=\"keyword\">if</span> <span class=\"keyword\">not</span> <span class=\"keyword\">exists</span> default.user_all (</span><br><span class=\"line\">    <span class=\"string\">`id`</span> <span class=\"built_in\">int</span>,</span><br><span class=\"line\">    <span class=\"string\">`name`</span> Nullable(<span class=\"keyword\">String</span>),</span><br><span class=\"line\">    <span class=\"string\">`sex`</span> <span class=\"built_in\">int</span>,</span><br><span class=\"line\">    <span class=\"string\">`address`</span> Nullable(<span class=\"keyword\">String</span>),</span><br><span class=\"line\">    <span class=\"string\">`datetime`</span> <span class=\"built_in\">Date</span> <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">now</span>()</span><br><span class=\"line\">) <span class=\"keyword\">engine</span> = <span class=\"keyword\">Distributed</span>(test_clu, <span class=\"string\">'default'</span>, <span class=\"string\">'c_user'</span>, <span class=\"keyword\">rand</span>());</span><br></pre></td></tr></table></figure>\n<p>marcos.xml 参考配置</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">yandex</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">macros</span> <span class=\"attr\">replace</span>=<span class=\"string\">\"replace\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">shard</span>&gt;</span>SHARD_NAME<span class=\"tag\">&lt;/<span class=\"name\">shard</span>&gt;</span> <span class=\"comment\">&lt;!--集群ID--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">replica</span>&gt;</span>REPLICA_NAME<span class=\"tag\">&lt;/<span class=\"name\">replica</span>&gt;</span> <span class=\"comment\">&lt;!--副本ID--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">macros</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">yandex</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><strong>每个副本都应该唯一</strong></p>\n</blockquote>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>clickhouse用于大数据查询, 占用空间少, 查询速度快</p>\n","site":{"data":{}},"excerpt":"","more":"<p>ClickHouse是一个用于联机分析(<strong>OLAP</strong>)的<strong>列式</strong>数据库管理系统(DBMS)。</p>\n<h2 id=\"Clickhouse使用\"><a href=\"#Clickhouse使用\" class=\"headerlink\" title=\"Clickhouse使用\"></a>Clickhouse使用</h2><p><a href=\"https://clickhouse.yandex/\" target=\"_blank\" rel=\"noopener\">官网</a></p>\n<p><a href=\"https://clickhouse.yandex/docs/zh/\" target=\"_blank\" rel=\"noopener\">官方文档</a></p>\n<h3 id=\"入门-单机\"><a href=\"#入门-单机\" class=\"headerlink\" title=\"入门(单机)\"></a>入门(单机)</h3><p>使用docker部署</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker pull yandex/clickhouse-server:latest</span><br><span class=\"line\">docker run -d -p 8123:8123 -p 9000:9000 -p 9009:9009 --name clickhouse yandex/clickhouse-server:latest</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>其他方式安装参考 <a href=\"https://clickhouse.yandex/docs/zh/getting_started/\" target=\"_blank\" rel=\"noopener\">部署运行</a></p>\n</blockquote>\n<ol>\n<li>默认没有用户, 设置用户名密码参考 <code>/etc/clickhouse-server/users.xml</code> 做添加/修改</li>\n<li>默认数据库 <code>default</code></li>\n<li>自定义配置文件可以存放在 <code>/etc/clickhouse-server/config.d</code> 和 <code>/etc/clickhouse-server/users.d</code> 分别对应 系统配置/用户配置, 自动融合到主配置文件中</li>\n</ol>\n<h3 id=\"集群\"><a href=\"#集群\" class=\"headerlink\" title=\"集群\"></a>集群</h3><h4 id=\"多副本\"><a href=\"#多副本\" class=\"headerlink\" title=\"多副本\"></a>多副本</h4><p>在 <code>/etc/clickhouse-server/config.d</code> 下添加配置文件 <code>remote_servers.xml</code>, 例:</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">yandex</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">remote_servers</span> <span class=\"attr\">incl</span>=<span class=\"string\">\"clickhouse_remote_servers\"</span> &gt;</span> <span class=\"comment\">&lt;!--集群节点配置--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">test_clu</span>&gt;</span> <span class=\"comment\">&lt;!-- 集群名称 --&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">shard</span>&gt;</span> <span class=\"comment\">&lt;!-- 分片1 --&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">internal_replication</span>&gt;</span>false<span class=\"tag\">&lt;/<span class=\"name\">internal_replication</span>&gt;</span> <span class=\"comment\">&lt;!-- 插入数据时,向所有副本插入数据 --&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">replica</span>&gt;</span> <span class=\"comment\">&lt;!-- 副本1 --&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">default_database</span>&gt;</span>default<span class=\"tag\">&lt;/<span class=\"name\">default_database</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">host</span>&gt;</span>$&#123;host_name&#125;<span class=\"tag\">&lt;/<span class=\"name\">host</span>&gt;</span> <span class=\"comment\">&lt;!--ip--&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">port</span>&gt;</span>9000<span class=\"tag\">&lt;/<span class=\"name\">port</span>&gt;</span>  <span class=\"comment\">&lt;!--port--&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">user</span>&gt;</span>default<span class=\"tag\">&lt;/<span class=\"name\">user</span>&gt;</span> <span class=\"comment\">&lt;!-- 用户名密码.可选 --&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">password</span>&gt;</span>123456<span class=\"tag\">&lt;/<span class=\"name\">password</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">replica</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">replica</span>&gt;</span> <span class=\"comment\">&lt;!-- 副本1 --&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">default_database</span>&gt;</span>default<span class=\"tag\">&lt;/<span class=\"name\">default_database</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">host</span>&gt;</span>$&#123;host_name&#125;<span class=\"tag\">&lt;/<span class=\"name\">host</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">port</span>&gt;</span>9000<span class=\"tag\">&lt;/<span class=\"name\">port</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">user</span>&gt;</span>default<span class=\"tag\">&lt;/<span class=\"name\">user</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">password</span>&gt;</span>123456<span class=\"tag\">&lt;/<span class=\"name\">password</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">replica</span>&gt;</span></span><br><span class=\"line\">             <span class=\"tag\">&lt;/<span class=\"name\">shard</span>&gt;</span></span><br><span class=\"line\">         <span class=\"tag\">&lt;/<span class=\"name\">test_clu</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">remote_servers</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">yandex</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"分布式-多副本-高可用-同步插入\"><a href=\"#分布式-多副本-高可用-同步插入\" class=\"headerlink\" title=\"分布式+多副本+高可用 (同步插入)\"></a>分布式+多副本+高可用 (同步插入)</h4><ol>\n<li>在 <code>/etc/clickhouse-server/config.d</code> 下添加配置文件 <code>remote_servers.xml</code></li>\n<li>在 <code>/etc/clickhouse-server/config.d</code> 下添加配置文件 <code>zookeeper.xml</code></li>\n<li>所有机器都需要创建相同的 <code>副本表、分布式表</code></li>\n<li>zookeeper 用与分布式协调</li>\n<li>分片参数 <code>internal_replication</code> 必须设置为 true</li>\n<li>marcos.xml <strong>每个副本都应该唯一</strong></li>\n</ol>\n<p>sql参考</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">--  创建副本表</span></span><br><span class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">table</span> <span class=\"keyword\">if</span> <span class=\"keyword\">not</span> <span class=\"keyword\">exists</span> default.c_user (</span><br><span class=\"line\">    <span class=\"string\">`id`</span> <span class=\"built_in\">int</span>,</span><br><span class=\"line\">    <span class=\"string\">`name`</span> Nullable(<span class=\"keyword\">String</span>),</span><br><span class=\"line\">    <span class=\"string\">`sex`</span> <span class=\"built_in\">int</span>,</span><br><span class=\"line\">    <span class=\"string\">`address`</span> Nullable(<span class=\"keyword\">String</span>),</span><br><span class=\"line\">    <span class=\"string\">`datetime`</span> <span class=\"built_in\">Date</span> <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">now</span>()</span><br><span class=\"line\">) <span class=\"keyword\">ENGINE</span> =MergeTree();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 创建分布式表</span></span><br><span class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">table</span> <span class=\"keyword\">if</span> <span class=\"keyword\">not</span> <span class=\"keyword\">exists</span> default.user_all (</span><br><span class=\"line\">    <span class=\"string\">`id`</span> <span class=\"built_in\">int</span>,</span><br><span class=\"line\">    <span class=\"string\">`name`</span> Nullable(<span class=\"keyword\">String</span>),</span><br><span class=\"line\">    <span class=\"string\">`sex`</span> <span class=\"built_in\">int</span>,</span><br><span class=\"line\">    <span class=\"string\">`address`</span> Nullable(<span class=\"keyword\">String</span>),</span><br><span class=\"line\">    <span class=\"string\">`datetime`</span> <span class=\"built_in\">Date</span> <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">now</span>()</span><br><span class=\"line\">) <span class=\"keyword\">engine</span> = <span class=\"keyword\">Distributed</span>(test_clu, <span class=\"string\">'default'</span>, <span class=\"string\">'c_user'</span>, <span class=\"keyword\">rand</span>()); <span class=\"comment\">-- 集群名称, 数据库, 副本表, 集群数据分配策略</span></span><br></pre></td></tr></table></figure>\n<p><code>remote_servers.xml</code> 参考配置</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">yandex</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">remote_servers</span> <span class=\"attr\">incl</span>=<span class=\"string\">\"clickhouse_remote_servers\"</span> &gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">test_clu</span>&gt;</span> <span class=\"comment\">&lt;!-- 集群名称 --&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">shard</span>&gt;</span> <span class=\"comment\">&lt;!-- 分片1 --&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">internal_replication</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">internal_replication</span>&gt;</span> <span class=\"comment\">&lt;!-- 插入数据时,向所有副本插入数据 --&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">replica</span>&gt;</span> <span class=\"comment\">&lt;!-- 副本1 --&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">default_database</span>&gt;</span>default<span class=\"tag\">&lt;/<span class=\"name\">default_database</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">host</span>&gt;</span>clickhouse_s1<span class=\"tag\">&lt;/<span class=\"name\">host</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">port</span>&gt;</span>9000<span class=\"tag\">&lt;/<span class=\"name\">port</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">user</span>&gt;</span>default<span class=\"tag\">&lt;/<span class=\"name\">user</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">password</span>&gt;</span>123456<span class=\"tag\">&lt;/<span class=\"name\">password</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">replica</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">replica</span>&gt;</span> <span class=\"comment\">&lt;!-- 副本2 --&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">default_database</span>&gt;</span>default<span class=\"tag\">&lt;/<span class=\"name\">default_database</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">host</span>&gt;</span>clickhouse_s3<span class=\"tag\">&lt;/<span class=\"name\">host</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">port</span>&gt;</span>9000<span class=\"tag\">&lt;/<span class=\"name\">port</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">user</span>&gt;</span>default<span class=\"tag\">&lt;/<span class=\"name\">user</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">password</span>&gt;</span>123456<span class=\"tag\">&lt;/<span class=\"name\">password</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">replica</span>&gt;</span></span><br><span class=\"line\">             <span class=\"tag\">&lt;/<span class=\"name\">shard</span>&gt;</span></span><br><span class=\"line\">             <span class=\"tag\">&lt;<span class=\"name\">shard</span>&gt;</span> <span class=\"comment\">&lt;!-- 分片2 --&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">internal_replication</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">internal_replication</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">replica</span>&gt;</span> <span class=\"comment\">&lt;!-- 副本1 --&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">default_database</span>&gt;</span>default<span class=\"tag\">&lt;/<span class=\"name\">default_database</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">host</span>&gt;</span>clickhouse_s2<span class=\"tag\">&lt;/<span class=\"name\">host</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">port</span>&gt;</span>9000<span class=\"tag\">&lt;/<span class=\"name\">port</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">user</span>&gt;</span>default<span class=\"tag\">&lt;/<span class=\"name\">user</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">password</span>&gt;</span>123456<span class=\"tag\">&lt;/<span class=\"name\">password</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">replica</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">replica</span>&gt;</span> <span class=\"comment\">&lt;!-- 副本2 --&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">default_database</span>&gt;</span>default<span class=\"tag\">&lt;/<span class=\"name\">default_database</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">host</span>&gt;</span>clickhouse_s4<span class=\"tag\">&lt;/<span class=\"name\">host</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">port</span>&gt;</span>9000<span class=\"tag\">&lt;/<span class=\"name\">port</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">user</span>&gt;</span>default<span class=\"tag\">&lt;/<span class=\"name\">user</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">password</span>&gt;</span>123456<span class=\"tag\">&lt;/<span class=\"name\">password</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">replica</span>&gt;</span></span><br><span class=\"line\">             <span class=\"tag\">&lt;/<span class=\"name\">shard</span>&gt;</span></span><br><span class=\"line\">         <span class=\"tag\">&lt;/<span class=\"name\">test_clu</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">remote_servers</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- 数据压缩算法 --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">clickhouse_compression</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">case</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">min_part_size</span>&gt;</span>10000000000<span class=\"tag\">&lt;/<span class=\"name\">min_part_size</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">min_part_size_ratio</span>&gt;</span>0.01<span class=\"tag\">&lt;/<span class=\"name\">min_part_size_ratio</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">method</span>&gt;</span>lz4<span class=\"tag\">&lt;/<span class=\"name\">method</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">case</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">clickhouse_compression</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">yandex</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p><code>zookeeper.xml</code> 参考配置</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">yandex</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">zookeeper</span> <span class=\"attr\">incl</span>=<span class=\"string\">\"zookeeper-servers\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">node</span> <span class=\"attr\">index</span>=<span class=\"string\">\"1\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">host</span>&gt;</span>clickhouse_zk0<span class=\"tag\">&lt;/<span class=\"name\">host</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">port</span>&gt;</span>2181<span class=\"tag\">&lt;/<span class=\"name\">port</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">node</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- 多节点配置</span></span><br><span class=\"line\"><span class=\"comment\">        &lt;node index=\"2\"&gt;</span></span><br><span class=\"line\"><span class=\"comment\">            &lt;host&gt;clickhouse_zk1&lt;/host&gt;</span></span><br><span class=\"line\"><span class=\"comment\">            &lt;port&gt;2181&lt;/port&gt;</span></span><br><span class=\"line\"><span class=\"comment\">        &lt;/node&gt;</span></span><br><span class=\"line\"><span class=\"comment\">        --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">zookeeper</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">yandex</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h4 id=\"分布式-多副本-高可用-复制表\"><a href=\"#分布式-多副本-高可用-复制表\" class=\"headerlink\" title=\"分布式+多副本+高可用 (复制表)\"></a>分布式+多副本+高可用 (复制表)</h4><p>上面的基础上再在 <code>/etc/clickhouse-server/config.d</code> 下添加配置文件 <code>macros.xml</code></p>\n<p>这个方式与上面<em>同步插入</em>的区别是 <em>插入数据时,只向一个副本插入,其他副本自动复制数据</em>, 我们需要将表引擎由<code>MergeTree</code>改为<code>ReplicatedMergeTree</code></p>\n<p>参考sql</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">--  创建副本表</span></span><br><span class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">table</span> <span class=\"keyword\">if</span> <span class=\"keyword\">not</span> <span class=\"keyword\">exists</span> default.c_user (</span><br><span class=\"line\">    <span class=\"string\">`id`</span> <span class=\"built_in\">int</span>,</span><br><span class=\"line\">    <span class=\"string\">`name`</span> Nullable(<span class=\"keyword\">String</span>),</span><br><span class=\"line\">    <span class=\"string\">`sex`</span> <span class=\"built_in\">int</span>,</span><br><span class=\"line\">    <span class=\"string\">`address`</span> Nullable(<span class=\"keyword\">String</span>),</span><br><span class=\"line\">    <span class=\"string\">`datetime`</span> <span class=\"built_in\">Date</span> <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">now</span>()</span><br><span class=\"line\">) <span class=\"keyword\">ENGINE</span> =ReplicatedMergeTree(<span class=\"string\">'/clickhouse/tables/&#123;shard&#125;/default/c_user'</span>, <span class=\"string\">'&#123;replica&#125;'</span>,<span class=\"string\">`datetime`</span> ,(<span class=\"string\">`datetime`</span>,<span class=\"string\">`id`</span>),<span class=\"number\">8192</span>);</span><br><span class=\"line\"><span class=\"comment\">-- &#123;shard&#125; 会自动从 macros.xml 中获取配置</span></span><br><span class=\"line\"><span class=\"comment\">-- &#123;replica&#125; 会自动从 macros.xml 中获取配置</span></span><br><span class=\"line\"><span class=\"comment\">-- `datetime` 是时间类型的字段</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">-- 创建分布式表</span></span><br><span class=\"line\"><span class=\"keyword\">create</span> <span class=\"keyword\">table</span> <span class=\"keyword\">if</span> <span class=\"keyword\">not</span> <span class=\"keyword\">exists</span> default.user_all (</span><br><span class=\"line\">    <span class=\"string\">`id`</span> <span class=\"built_in\">int</span>,</span><br><span class=\"line\">    <span class=\"string\">`name`</span> Nullable(<span class=\"keyword\">String</span>),</span><br><span class=\"line\">    <span class=\"string\">`sex`</span> <span class=\"built_in\">int</span>,</span><br><span class=\"line\">    <span class=\"string\">`address`</span> Nullable(<span class=\"keyword\">String</span>),</span><br><span class=\"line\">    <span class=\"string\">`datetime`</span> <span class=\"built_in\">Date</span> <span class=\"keyword\">DEFAULT</span> <span class=\"keyword\">now</span>()</span><br><span class=\"line\">) <span class=\"keyword\">engine</span> = <span class=\"keyword\">Distributed</span>(test_clu, <span class=\"string\">'default'</span>, <span class=\"string\">'c_user'</span>, <span class=\"keyword\">rand</span>());</span><br></pre></td></tr></table></figure>\n<p>marcos.xml 参考配置</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">yandex</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">macros</span> <span class=\"attr\">replace</span>=<span class=\"string\">\"replace\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">shard</span>&gt;</span>SHARD_NAME<span class=\"tag\">&lt;/<span class=\"name\">shard</span>&gt;</span> <span class=\"comment\">&lt;!--集群ID--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">replica</span>&gt;</span>REPLICA_NAME<span class=\"tag\">&lt;/<span class=\"name\">replica</span>&gt;</span> <span class=\"comment\">&lt;!--副本ID--&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">macros</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">yandex</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><strong>每个副本都应该唯一</strong></p>\n</blockquote>\n<h2 id=\"总结\"><a href=\"#总结\" class=\"headerlink\" title=\"总结\"></a>总结</h2><p>clickhouse用于大数据查询, 占用空间少, 查询速度快</p>\n"},{"title":"Docker学习笔记","date":"2019-05-16T03:29:14.000Z","_content":"\n我是一个java程序猿, 当前已经转为nodejs开发, 因为工作需要接触docker到目前为止已经有一年多的时间了, 一下是我学习和使用docker的一些总结.\n\n## 前言\n\n### 认识docker\n\nDocker是一个容器平台, 可以说他是一个虚拟机平台, 但是它又比虚拟机强大. Docker是开发人员和系统管理员使用容器开发，部署和运行应用程序的平台。\n使用Linux容器部署应用程序称为容器化。容器不是新的，但它们用于轻松部署应用程序。\n\n### docker能解决什么问题\n\n1. 生产开发环境不一致的问题\n\n### 基本概念\n\n1. 容器\n2. 镜像\n3. 仓库\n\n## 安装\n\n[参考这里](https://docs.docker.com/install/)\n\n```bash\n# 查看docker版本\ndocker --version\n\n# 查看docker信息\ndocker info\n\n# 测试docker是否安装成功\ndocker run hello-world\n\nUnable to find image 'hello-world:latest' locally\nlatest: Pulling from library/hello-world\nca4f61b1923c: Pull complete\nDigest: sha256:ca0eeb6fb05351dfc8759c20733c91def84cb8007aa89a5bf606bc8b315b9fc7\nStatus: Downloaded newer image for hello-world:latest\n\nHello from Docker!\nThis message shows that your installation appears to be working correctly.\n...\n```\n\n## 入门\n\n前提条件: 安装好Docker\n\n### 容器\n\n#### 创建Dockerfile文件\n\n在项目根目录下创建一个Dockerfile文件, 如:\n\n```Dockerfile\n# 将官方 node:9.3.0-alpine 运行时用作父镜像\nFROM node:9.3.0-alpine\n\nRUN mkdir -p /app\n# 将工作目录设置为 /app\nWORKDIR /app\n\n# 将当前目录内容复制到位于 /app 中的容器中\nCOPY . /app/temp\n\nRUN cp /app/temp/package.json /app/package.json &&\\\n    npm install --registry=https://registry.npm.taobao.org &&\\\n    cp -r /app/temp/pages /app/pages &&\\\n    cp -r /app/temp/components /app/components &&\\\n    cp -r /app/temp/next.config.js /app/next.config.js &&\\\n    rm -rf /app/temp\n\n# 在容器启动时运行\nCMD [\"npm\", \"start\"]\n```\n\n有关Dockerfile的命令可以参考这里[编写Dockerfile的最佳实践](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/)\n\n#### 构建镜像\n\n命令:\n\n`docker build -t <image-name> .`;\n\n> -t image-name 是给镜像添加名称  \n> . 代表当前根目录  \n> 可选参数 -f Dockerfile-name 指定Dockerfile文件, 默认是 Dockerfile, 当我们有如: MYSQL.Dockerfile 则可以使用该参数指定 例: `docker build -t imagename . -f MySQL.Dockerfile`\n\n#### 运行容器\n\n命令:\n\n`docker run -d -p 3000:3000 --name <容器名称> <镜像hashid/镜像名称>`\n\n1. -d 参数指定容器在后台运行\n2. -p 指定容器端口映射, 主机端口:容器端口, 容器端口指容器内部服务对外暴露的端口,如果tomcat对外提供服务的端口为8080\n3. --name 参数设置容器名称\n4. 最后接对应的镜像 hashid 或者 镜像名称:tag\n\n其他常用参数:\n\n1. --network 指定容器运行的网络环境\n2. -v 配置容器数据卷, 更多信息参考 高级篇[容器数据]\n3. --rm 该命令常常与 -v 一起使用, 在删除/停止容器的时候同事清除数据卷映射关系\n4. --link 链接到其他容器, 新版本推荐使用 --network 指定容器网络环境即可\n\n容器镜像操作:\n\n```bash\ndocker ps; #查看当前运行的容器\ndocker ps -a; # 查看所有的容器\ndocker logs <镜像hashid/镜像名称> # 查看指定容器的日记\ndocker start <容器hashid/容器名称> # 启动容器\ndocker stop <容器hashid/容器名称> # 停止容器\ndocker stop -f <镜像hashid/镜像名称> # 停止容器, 同时删除容器\ndocker rm <容器hashid/容器名称>... # 删除容器, 可以同时指定多个 <容器hashid/容器名称>\ndocker rmi <镜像hashid/镜像名称> # 删除镜像, 必须注意的是, 先删除容器才能删除镜像\n```\n\n推送镜像到仓库\n\n1. 登陆docker仓库 `docker login ...`\n2. 给镜像打标签 `docker tag [本地镜像名称]:[版本号] [存储库名称]:[版本号]`\n3. 推送到镜像仓库 `docker push [账号名]/[存储库名称]:[版本号]`\n4. 尝试拉取镜像 `docker pull [账号名]/[存储库名称]:[版本号]`\n\n案例\n\n```sh\n# 登陆dockerhub\ndocker login\n\n# 构建镜像\ndocker build -t arm64v8/myblog:latest .\n\n# 将本地镜像打标签\ndocker tag arm64v8/myblog:latest jiangzwyz/myblog:latest\n\n# 推送到镜像仓库\ndocker push jiangzwyz/myblog:latest\n```\n\n### 服务Swarms\n\n待补充\n\n## 高级篇\n\n### 容器数据\n\n深入了解docker的都会知道docker的方便,但是也会明白docker的缺点,就是容器在被销毁时,其内部的数据将会全部丢失,那么这里我们就将解决这个问题\n\n最常见的案例就是数据库了, 这里我们以配置 mysql容器为例, 示范如何使用**数据卷**将容器的数据保存到主机上.\n\nDockerfile文件:\n\n```Dockerfile\n# 拉取 mysql:5.7 官方镜像\nFROM mysql:5.7\n\n# 设置时区 Shanghai\nRUN cp /usr/share/zoneinfo/PRC /etc/localtime\n\n# ENV 设置 镜像环境变量 mysql 镜像参考官方说明,可以在此配置账户密码\nENV MYSQL_ROOT_PASSWORD=you_password\nENV MYSQL_USER=you_name\nENV MYSQL_PASSWORD=you_passowrd\n\n# 这里我使用了自定义mysql的配置文件\nCOPY ./mysql/mysql.cnf /etc/mysql/conf.d/mysql.cnf\nCOPY ./mysql/mysqld.cnf /etc/mysql/mysql.conf.d/mysqld.cnf\n```\n\n**重点**在这里\n\n```bash\ndocker build -t mysql . -f MYSQL.Dockerfile;\ndocker run -d -p 3306:3306 --rm -v /mysql/db:/var/lib/mysql --name mysql mysql;\n```\n\n从当前项目中构建mysql镜像, 然后运行容器时指定主机/mysql/db目录挂载到容器/var/lib/mysql目录(此目录是mysql数据库文件所在)\n\n数据类的容器,官方都会说明其数据文件存放的位置, 当然我们也可以挂载网盘到容器中.\n\n![ ](/../img/docker_01.png)\n\n### 容器网络\n\n#### 使用容器,你就不应该再去管理烦人的IP\n\n我们载部署项目的时候经常会遇到这个问题, 我们的项目需要连接mysql, 一般我们通过ip去连接*(localhost:3306、127.0.0.1:3306), 这样到还简单,如果我们的mysql IP是动态的, 怎么办? 你改的几次就会抓狂的. 所以我们需要使用到 容器网络  network\n\n#### 在Docker中建立 自定义 桥网络\n\n1. 连接到默认bridge网络的容器可以通过IP地址相互通信。Docker不支持默认网桥上的自动服务发现。如果希望容器能够按容器名称解析IP地址，则应使用用户定义的网络。您可以使用旧版docker run --link选项将两个容器链接在一起，但在大多数情况下不建议这样做。\n2. 使用自定义 bridge网络 运行在其中的容器可以发现对方\n3. 要实现 容器间通讯，采用 自定义 桥网络 （容器必须在同一主机中）\n4. network  桥网络，容器运行再 用户自定义桥网络 中，容器间可以通过 局域网访问（**不适用于分布式主机**），默认桥网络不支持这样\n\n```bash\n# 查看当前主机中网络列表\n$ docker network ls\n\n# 创建 桥网络\n$ docker network create --driver bridge [network-name]\n\n# 将容器运行在对应的 bridge网络 中，使用 --network=[network-name]\n$ docker run -d -p 80:80 -p 443:443 --network=[network-name] --name mynginx [container-images-id]\n$ docker run -d -p 80:80 -p 443:443 --rm -v ~/../workspace/myimages/images:/app/images &&\\\n  --network=[network-name] & --name=1.2.3.4 [container-images-id]\n```\n\n在同一个 network 网络中的两个容器之间通信可以直接使用 容器名称:端口 的方式去访问,\n如: mysql:3306\n\n### k8s\n\n容器编排\n\n## 其他\n\n### 设置容器时区\n\n时区问题一直都是我们需要解决的问题, 容器同样避免不了这个问题.\n\n在linux中, 我们可以将本地时间文件拷贝到/etc/localtime即可设置容器时间\n\nlinux的时区设置文件在 /usr/share/zoneinfo/Asia\n\n我们将设置系统时间为 上海 例:\n\n```bash\n# 在Dockerfile中添加:\n\n# linux版本: node:9.3.0-alpine\nRUN apk add --no-cache tzdata && \\\n    cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime && echo \"Asia/Shanghai\" > /etc/timezone && \\\n    apk del tzdata\n\n# 镜像 mysql:5.7\nRUN cp /usr/share/zoneinfo/PRC /etc/localtime\n```\n\n> 上海时区/usr/share/zoneinfo/Asia/Shanghai实际上是链接到/usr/share/zoneinfo/PRC时区, 所以在第二个中我们的做法也是可取的.\n\n## 结语\n\n官方文档是最好的学习资料\n","source":"_posts/docker.md","raw":"---\ntitle: Docker学习笔记\ndate: 2019-05-16 11:29:14\ntags: 容器\n---\n\n我是一个java程序猿, 当前已经转为nodejs开发, 因为工作需要接触docker到目前为止已经有一年多的时间了, 一下是我学习和使用docker的一些总结.\n\n## 前言\n\n### 认识docker\n\nDocker是一个容器平台, 可以说他是一个虚拟机平台, 但是它又比虚拟机强大. Docker是开发人员和系统管理员使用容器开发，部署和运行应用程序的平台。\n使用Linux容器部署应用程序称为容器化。容器不是新的，但它们用于轻松部署应用程序。\n\n### docker能解决什么问题\n\n1. 生产开发环境不一致的问题\n\n### 基本概念\n\n1. 容器\n2. 镜像\n3. 仓库\n\n## 安装\n\n[参考这里](https://docs.docker.com/install/)\n\n```bash\n# 查看docker版本\ndocker --version\n\n# 查看docker信息\ndocker info\n\n# 测试docker是否安装成功\ndocker run hello-world\n\nUnable to find image 'hello-world:latest' locally\nlatest: Pulling from library/hello-world\nca4f61b1923c: Pull complete\nDigest: sha256:ca0eeb6fb05351dfc8759c20733c91def84cb8007aa89a5bf606bc8b315b9fc7\nStatus: Downloaded newer image for hello-world:latest\n\nHello from Docker!\nThis message shows that your installation appears to be working correctly.\n...\n```\n\n## 入门\n\n前提条件: 安装好Docker\n\n### 容器\n\n#### 创建Dockerfile文件\n\n在项目根目录下创建一个Dockerfile文件, 如:\n\n```Dockerfile\n# 将官方 node:9.3.0-alpine 运行时用作父镜像\nFROM node:9.3.0-alpine\n\nRUN mkdir -p /app\n# 将工作目录设置为 /app\nWORKDIR /app\n\n# 将当前目录内容复制到位于 /app 中的容器中\nCOPY . /app/temp\n\nRUN cp /app/temp/package.json /app/package.json &&\\\n    npm install --registry=https://registry.npm.taobao.org &&\\\n    cp -r /app/temp/pages /app/pages &&\\\n    cp -r /app/temp/components /app/components &&\\\n    cp -r /app/temp/next.config.js /app/next.config.js &&\\\n    rm -rf /app/temp\n\n# 在容器启动时运行\nCMD [\"npm\", \"start\"]\n```\n\n有关Dockerfile的命令可以参考这里[编写Dockerfile的最佳实践](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/)\n\n#### 构建镜像\n\n命令:\n\n`docker build -t <image-name> .`;\n\n> -t image-name 是给镜像添加名称  \n> . 代表当前根目录  \n> 可选参数 -f Dockerfile-name 指定Dockerfile文件, 默认是 Dockerfile, 当我们有如: MYSQL.Dockerfile 则可以使用该参数指定 例: `docker build -t imagename . -f MySQL.Dockerfile`\n\n#### 运行容器\n\n命令:\n\n`docker run -d -p 3000:3000 --name <容器名称> <镜像hashid/镜像名称>`\n\n1. -d 参数指定容器在后台运行\n2. -p 指定容器端口映射, 主机端口:容器端口, 容器端口指容器内部服务对外暴露的端口,如果tomcat对外提供服务的端口为8080\n3. --name 参数设置容器名称\n4. 最后接对应的镜像 hashid 或者 镜像名称:tag\n\n其他常用参数:\n\n1. --network 指定容器运行的网络环境\n2. -v 配置容器数据卷, 更多信息参考 高级篇[容器数据]\n3. --rm 该命令常常与 -v 一起使用, 在删除/停止容器的时候同事清除数据卷映射关系\n4. --link 链接到其他容器, 新版本推荐使用 --network 指定容器网络环境即可\n\n容器镜像操作:\n\n```bash\ndocker ps; #查看当前运行的容器\ndocker ps -a; # 查看所有的容器\ndocker logs <镜像hashid/镜像名称> # 查看指定容器的日记\ndocker start <容器hashid/容器名称> # 启动容器\ndocker stop <容器hashid/容器名称> # 停止容器\ndocker stop -f <镜像hashid/镜像名称> # 停止容器, 同时删除容器\ndocker rm <容器hashid/容器名称>... # 删除容器, 可以同时指定多个 <容器hashid/容器名称>\ndocker rmi <镜像hashid/镜像名称> # 删除镜像, 必须注意的是, 先删除容器才能删除镜像\n```\n\n推送镜像到仓库\n\n1. 登陆docker仓库 `docker login ...`\n2. 给镜像打标签 `docker tag [本地镜像名称]:[版本号] [存储库名称]:[版本号]`\n3. 推送到镜像仓库 `docker push [账号名]/[存储库名称]:[版本号]`\n4. 尝试拉取镜像 `docker pull [账号名]/[存储库名称]:[版本号]`\n\n案例\n\n```sh\n# 登陆dockerhub\ndocker login\n\n# 构建镜像\ndocker build -t arm64v8/myblog:latest .\n\n# 将本地镜像打标签\ndocker tag arm64v8/myblog:latest jiangzwyz/myblog:latest\n\n# 推送到镜像仓库\ndocker push jiangzwyz/myblog:latest\n```\n\n### 服务Swarms\n\n待补充\n\n## 高级篇\n\n### 容器数据\n\n深入了解docker的都会知道docker的方便,但是也会明白docker的缺点,就是容器在被销毁时,其内部的数据将会全部丢失,那么这里我们就将解决这个问题\n\n最常见的案例就是数据库了, 这里我们以配置 mysql容器为例, 示范如何使用**数据卷**将容器的数据保存到主机上.\n\nDockerfile文件:\n\n```Dockerfile\n# 拉取 mysql:5.7 官方镜像\nFROM mysql:5.7\n\n# 设置时区 Shanghai\nRUN cp /usr/share/zoneinfo/PRC /etc/localtime\n\n# ENV 设置 镜像环境变量 mysql 镜像参考官方说明,可以在此配置账户密码\nENV MYSQL_ROOT_PASSWORD=you_password\nENV MYSQL_USER=you_name\nENV MYSQL_PASSWORD=you_passowrd\n\n# 这里我使用了自定义mysql的配置文件\nCOPY ./mysql/mysql.cnf /etc/mysql/conf.d/mysql.cnf\nCOPY ./mysql/mysqld.cnf /etc/mysql/mysql.conf.d/mysqld.cnf\n```\n\n**重点**在这里\n\n```bash\ndocker build -t mysql . -f MYSQL.Dockerfile;\ndocker run -d -p 3306:3306 --rm -v /mysql/db:/var/lib/mysql --name mysql mysql;\n```\n\n从当前项目中构建mysql镜像, 然后运行容器时指定主机/mysql/db目录挂载到容器/var/lib/mysql目录(此目录是mysql数据库文件所在)\n\n数据类的容器,官方都会说明其数据文件存放的位置, 当然我们也可以挂载网盘到容器中.\n\n![ ](/../img/docker_01.png)\n\n### 容器网络\n\n#### 使用容器,你就不应该再去管理烦人的IP\n\n我们载部署项目的时候经常会遇到这个问题, 我们的项目需要连接mysql, 一般我们通过ip去连接*(localhost:3306、127.0.0.1:3306), 这样到还简单,如果我们的mysql IP是动态的, 怎么办? 你改的几次就会抓狂的. 所以我们需要使用到 容器网络  network\n\n#### 在Docker中建立 自定义 桥网络\n\n1. 连接到默认bridge网络的容器可以通过IP地址相互通信。Docker不支持默认网桥上的自动服务发现。如果希望容器能够按容器名称解析IP地址，则应使用用户定义的网络。您可以使用旧版docker run --link选项将两个容器链接在一起，但在大多数情况下不建议这样做。\n2. 使用自定义 bridge网络 运行在其中的容器可以发现对方\n3. 要实现 容器间通讯，采用 自定义 桥网络 （容器必须在同一主机中）\n4. network  桥网络，容器运行再 用户自定义桥网络 中，容器间可以通过 局域网访问（**不适用于分布式主机**），默认桥网络不支持这样\n\n```bash\n# 查看当前主机中网络列表\n$ docker network ls\n\n# 创建 桥网络\n$ docker network create --driver bridge [network-name]\n\n# 将容器运行在对应的 bridge网络 中，使用 --network=[network-name]\n$ docker run -d -p 80:80 -p 443:443 --network=[network-name] --name mynginx [container-images-id]\n$ docker run -d -p 80:80 -p 443:443 --rm -v ~/../workspace/myimages/images:/app/images &&\\\n  --network=[network-name] & --name=1.2.3.4 [container-images-id]\n```\n\n在同一个 network 网络中的两个容器之间通信可以直接使用 容器名称:端口 的方式去访问,\n如: mysql:3306\n\n### k8s\n\n容器编排\n\n## 其他\n\n### 设置容器时区\n\n时区问题一直都是我们需要解决的问题, 容器同样避免不了这个问题.\n\n在linux中, 我们可以将本地时间文件拷贝到/etc/localtime即可设置容器时间\n\nlinux的时区设置文件在 /usr/share/zoneinfo/Asia\n\n我们将设置系统时间为 上海 例:\n\n```bash\n# 在Dockerfile中添加:\n\n# linux版本: node:9.3.0-alpine\nRUN apk add --no-cache tzdata && \\\n    cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime && echo \"Asia/Shanghai\" > /etc/timezone && \\\n    apk del tzdata\n\n# 镜像 mysql:5.7\nRUN cp /usr/share/zoneinfo/PRC /etc/localtime\n```\n\n> 上海时区/usr/share/zoneinfo/Asia/Shanghai实际上是链接到/usr/share/zoneinfo/PRC时区, 所以在第二个中我们的做法也是可取的.\n\n## 结语\n\n官方文档是最好的学习资料\n","slug":"docker","published":1,"updated":"2019-12-28T03:51:01.918Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck550trld0006hm622oeppdi4","content":"<p>我是一个java程序猿, 当前已经转为nodejs开发, 因为工作需要接触docker到目前为止已经有一年多的时间了, 一下是我学习和使用docker的一些总结.</p>\n<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><h3 id=\"认识docker\"><a href=\"#认识docker\" class=\"headerlink\" title=\"认识docker\"></a>认识docker</h3><p>Docker是一个容器平台, 可以说他是一个虚拟机平台, 但是它又比虚拟机强大. Docker是开发人员和系统管理员使用容器开发，部署和运行应用程序的平台。<br>使用Linux容器部署应用程序称为容器化。容器不是新的，但它们用于轻松部署应用程序。</p>\n<h3 id=\"docker能解决什么问题\"><a href=\"#docker能解决什么问题\" class=\"headerlink\" title=\"docker能解决什么问题\"></a>docker能解决什么问题</h3><ol>\n<li>生产开发环境不一致的问题</li>\n</ol>\n<h3 id=\"基本概念\"><a href=\"#基本概念\" class=\"headerlink\" title=\"基本概念\"></a>基本概念</h3><ol>\n<li>容器</li>\n<li>镜像</li>\n<li>仓库</li>\n</ol>\n<h2 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h2><p><a href=\"https://docs.docker.com/install/\" target=\"_blank\" rel=\"noopener\">参考这里</a></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看docker版本</span></span><br><span class=\"line\">docker --version</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查看docker信息</span></span><br><span class=\"line\">docker info</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 测试docker是否安装成功</span></span><br><span class=\"line\">docker run hello-world</span><br><span class=\"line\"></span><br><span class=\"line\">Unable to find image <span class=\"string\">'hello-world:latest'</span> locally</span><br><span class=\"line\">latest: Pulling from library/hello-world</span><br><span class=\"line\">ca4f61b1923c: Pull complete</span><br><span class=\"line\">Digest: sha256:ca0eeb6fb05351dfc8759c20733c91def84cb8007aa89a5bf606bc8b315b9fc7</span><br><span class=\"line\">Status: Downloaded newer image <span class=\"keyword\">for</span> hello-world:latest</span><br><span class=\"line\"></span><br><span class=\"line\">Hello from Docker!</span><br><span class=\"line\">This message shows that your installation appears to be working correctly.</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n<h2 id=\"入门\"><a href=\"#入门\" class=\"headerlink\" title=\"入门\"></a>入门</h2><p>前提条件: 安装好Docker</p>\n<h3 id=\"容器\"><a href=\"#容器\" class=\"headerlink\" title=\"容器\"></a>容器</h3><h4 id=\"创建Dockerfile文件\"><a href=\"#创建Dockerfile文件\" class=\"headerlink\" title=\"创建Dockerfile文件\"></a>创建Dockerfile文件</h4><p>在项目根目录下创建一个Dockerfile文件, 如:</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 将官方 node:9.3.0-alpine 运行时用作父镜像</span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span> node:<span class=\"number\">9.3</span>.<span class=\"number\">0</span>-alpine</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> mkdir -p /app</span></span><br><span class=\"line\"><span class=\"comment\"># 将工作目录设置为 /app</span></span><br><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"bash\"> /app</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 将当前目录内容复制到位于 /app 中的容器中</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"bash\"> . /app/temp</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> cp /app/temp/package.json /app/package.json &amp;&amp;\\</span></span><br><span class=\"line\"><span class=\"bash\">    npm install --registry=https://registry.npm.taobao.org &amp;&amp;\\</span></span><br><span class=\"line\"><span class=\"bash\">    cp -r /app/temp/pages /app/pages &amp;&amp;\\</span></span><br><span class=\"line\"><span class=\"bash\">    cp -r /app/temp/components /app/components &amp;&amp;\\</span></span><br><span class=\"line\"><span class=\"bash\">    cp -r /app/temp/next.config.js /app/next.config.js &amp;&amp;\\</span></span><br><span class=\"line\"><span class=\"bash\">    rm -rf /app/temp</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 在容器启动时运行</span></span><br><span class=\"line\"><span class=\"keyword\">CMD</span><span class=\"bash\"> [<span class=\"string\">\"npm\"</span>, <span class=\"string\">\"start\"</span>]</span></span><br></pre></td></tr></table></figure>\n<p>有关Dockerfile的命令可以参考这里<a href=\"https://docs.docker.com/develop/develop-images/dockerfile_best-practices/\" target=\"_blank\" rel=\"noopener\">编写Dockerfile的最佳实践</a></p>\n<h4 id=\"构建镜像\"><a href=\"#构建镜像\" class=\"headerlink\" title=\"构建镜像\"></a>构建镜像</h4><p>命令:</p>\n<p><code>docker build -t &lt;image-name&gt; .</code>;</p>\n<blockquote>\n<p>-t image-name 是给镜像添加名称<br>. 代表当前根目录<br>可选参数 -f Dockerfile-name 指定Dockerfile文件, 默认是 Dockerfile, 当我们有如: MYSQL.Dockerfile 则可以使用该参数指定 例: <code>docker build -t imagename . -f MySQL.Dockerfile</code></p>\n</blockquote>\n<h4 id=\"运行容器\"><a href=\"#运行容器\" class=\"headerlink\" title=\"运行容器\"></a>运行容器</h4><p>命令:</p>\n<p><code>docker run -d -p 3000:3000 --name &lt;容器名称&gt; &lt;镜像hashid/镜像名称&gt;</code></p>\n<ol>\n<li>-d 参数指定容器在后台运行</li>\n<li>-p 指定容器端口映射, 主机端口:容器端口, 容器端口指容器内部服务对外暴露的端口,如果tomcat对外提供服务的端口为8080</li>\n<li>–name 参数设置容器名称</li>\n<li>最后接对应的镜像 hashid 或者 镜像名称:tag</li>\n</ol>\n<p>其他常用参数:</p>\n<ol>\n<li>–network 指定容器运行的网络环境</li>\n<li>-v 配置容器数据卷, 更多信息参考 高级篇[容器数据]</li>\n<li>–rm 该命令常常与 -v 一起使用, 在删除/停止容器的时候同事清除数据卷映射关系</li>\n<li>–link 链接到其他容器, 新版本推荐使用 –network 指定容器网络环境即可</li>\n</ol>\n<p>容器镜像操作:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker ps; <span class=\"comment\">#查看当前运行的容器</span></span><br><span class=\"line\">docker ps -a; <span class=\"comment\"># 查看所有的容器</span></span><br><span class=\"line\">docker logs &lt;镜像hashid/镜像名称&gt; <span class=\"comment\"># 查看指定容器的日记</span></span><br><span class=\"line\">docker start &lt;容器hashid/容器名称&gt; <span class=\"comment\"># 启动容器</span></span><br><span class=\"line\">docker stop &lt;容器hashid/容器名称&gt; <span class=\"comment\"># 停止容器</span></span><br><span class=\"line\">docker stop -f &lt;镜像hashid/镜像名称&gt; <span class=\"comment\"># 停止容器, 同时删除容器</span></span><br><span class=\"line\">docker rm &lt;容器hashid/容器名称&gt;... <span class=\"comment\"># 删除容器, 可以同时指定多个 &lt;容器hashid/容器名称&gt;</span></span><br><span class=\"line\">docker rmi &lt;镜像hashid/镜像名称&gt; <span class=\"comment\"># 删除镜像, 必须注意的是, 先删除容器才能删除镜像</span></span><br></pre></td></tr></table></figure>\n<p>推送镜像到仓库</p>\n<ol>\n<li>登陆docker仓库 <code>docker login ...</code></li>\n<li>给镜像打标签 <code>docker tag [本地镜像名称]:[版本号] [存储库名称]:[版本号]</code></li>\n<li>推送到镜像仓库 <code>docker push [账号名]/[存储库名称]:[版本号]</code></li>\n<li>尝试拉取镜像 <code>docker pull [账号名]/[存储库名称]:[版本号]</code></li>\n</ol>\n<p>案例</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 登陆dockerhub</span></span><br><span class=\"line\">docker login</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 构建镜像</span></span><br><span class=\"line\">docker build -t arm64v8/myblog:latest .</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 将本地镜像打标签</span></span><br><span class=\"line\">docker tag arm64v8/myblog:latest jiangzwyz/myblog:latest</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 推送到镜像仓库</span></span><br><span class=\"line\">docker push jiangzwyz/myblog:latest</span><br></pre></td></tr></table></figure>\n<h3 id=\"服务Swarms\"><a href=\"#服务Swarms\" class=\"headerlink\" title=\"服务Swarms\"></a>服务Swarms</h3><p>待补充</p>\n<h2 id=\"高级篇\"><a href=\"#高级篇\" class=\"headerlink\" title=\"高级篇\"></a>高级篇</h2><h3 id=\"容器数据\"><a href=\"#容器数据\" class=\"headerlink\" title=\"容器数据\"></a>容器数据</h3><p>深入了解docker的都会知道docker的方便,但是也会明白docker的缺点,就是容器在被销毁时,其内部的数据将会全部丢失,那么这里我们就将解决这个问题</p>\n<p>最常见的案例就是数据库了, 这里我们以配置 mysql容器为例, 示范如何使用<strong>数据卷</strong>将容器的数据保存到主机上.</p>\n<p>Dockerfile文件:</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 拉取 mysql:5.7 官方镜像</span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span> mysql:<span class=\"number\">5.7</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 设置时区 Shanghai</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> cp /usr/share/zoneinfo/PRC /etc/localtime</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ENV 设置 镜像环境变量 mysql 镜像参考官方说明,可以在此配置账户密码</span></span><br><span class=\"line\"><span class=\"keyword\">ENV</span> MYSQL_ROOT_PASSWORD=you_password</span><br><span class=\"line\"><span class=\"keyword\">ENV</span> MYSQL_USER=you_name</span><br><span class=\"line\"><span class=\"keyword\">ENV</span> MYSQL_PASSWORD=you_passowrd</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 这里我使用了自定义mysql的配置文件</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"bash\"> ./mysql/mysql.cnf /etc/mysql/conf.d/mysql.cnf</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"bash\"> ./mysql/mysqld.cnf /etc/mysql/mysql.conf.d/mysqld.cnf</span></span><br></pre></td></tr></table></figure>\n<p><strong>重点</strong>在这里</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker build -t mysql . -f MYSQL.Dockerfile;</span><br><span class=\"line\">docker run -d -p 3306:3306 --rm -v /mysql/db:/var/lib/mysql --name mysql mysql;</span><br></pre></td></tr></table></figure>\n<p>从当前项目中构建mysql镜像, 然后运行容器时指定主机/mysql/db目录挂载到容器/var/lib/mysql目录(此目录是mysql数据库文件所在)</p>\n<p>数据类的容器,官方都会说明其数据文件存放的位置, 当然我们也可以挂载网盘到容器中.</p>\n<p><img src=\"/../img/docker_01.png\" alt=\" \"></p>\n<h3 id=\"容器网络\"><a href=\"#容器网络\" class=\"headerlink\" title=\"容器网络\"></a>容器网络</h3><h4 id=\"使用容器-你就不应该再去管理烦人的IP\"><a href=\"#使用容器-你就不应该再去管理烦人的IP\" class=\"headerlink\" title=\"使用容器,你就不应该再去管理烦人的IP\"></a>使用容器,你就不应该再去管理烦人的IP</h4><p>我们载部署项目的时候经常会遇到这个问题, 我们的项目需要连接mysql, 一般我们通过ip去连接*(localhost:3306、127.0.0.1:3306), 这样到还简单,如果我们的mysql IP是动态的, 怎么办? 你改的几次就会抓狂的. 所以我们需要使用到 容器网络  network</p>\n<h4 id=\"在Docker中建立-自定义-桥网络\"><a href=\"#在Docker中建立-自定义-桥网络\" class=\"headerlink\" title=\"在Docker中建立 自定义 桥网络\"></a>在Docker中建立 自定义 桥网络</h4><ol>\n<li>连接到默认bridge网络的容器可以通过IP地址相互通信。Docker不支持默认网桥上的自动服务发现。如果希望容器能够按容器名称解析IP地址，则应使用用户定义的网络。您可以使用旧版docker run –link选项将两个容器链接在一起，但在大多数情况下不建议这样做。</li>\n<li>使用自定义 bridge网络 运行在其中的容器可以发现对方</li>\n<li>要实现 容器间通讯，采用 自定义 桥网络 （容器必须在同一主机中）</li>\n<li>network  桥网络，容器运行再 用户自定义桥网络 中，容器间可以通过 局域网访问（<strong>不适用于分布式主机</strong>），默认桥网络不支持这样</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看当前主机中网络列表</span></span><br><span class=\"line\">$ docker network ls</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 创建 桥网络</span></span><br><span class=\"line\">$ docker network create --driver bridge [network-name]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 将容器运行在对应的 bridge网络 中，使用 --network=[network-name]</span></span><br><span class=\"line\">$ docker run -d -p 80:80 -p 443:443 --network=[network-name] --name mynginx [container-images-id]</span><br><span class=\"line\">$ docker run -d -p 80:80 -p 443:443 --rm -v ~/../workspace/myimages/images:/app/images &amp;&amp;\\</span><br><span class=\"line\">  --network=[network-name] &amp; --name=1.2.3.4 [container-images-id]</span><br></pre></td></tr></table></figure>\n<p>在同一个 network 网络中的两个容器之间通信可以直接使用 容器名称:端口 的方式去访问,<br>如: mysql:3306</p>\n<h3 id=\"k8s\"><a href=\"#k8s\" class=\"headerlink\" title=\"k8s\"></a>k8s</h3><p>容器编排</p>\n<h2 id=\"其他\"><a href=\"#其他\" class=\"headerlink\" title=\"其他\"></a>其他</h2><h3 id=\"设置容器时区\"><a href=\"#设置容器时区\" class=\"headerlink\" title=\"设置容器时区\"></a>设置容器时区</h3><p>时区问题一直都是我们需要解决的问题, 容器同样避免不了这个问题.</p>\n<p>在linux中, 我们可以将本地时间文件拷贝到/etc/localtime即可设置容器时间</p>\n<p>linux的时区设置文件在 /usr/share/zoneinfo/Asia</p>\n<p>我们将设置系统时间为 上海 例:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 在Dockerfile中添加:</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># linux版本: node:9.3.0-alpine</span></span><br><span class=\"line\">RUN apk add --no-cache tzdata &amp;&amp; \\</span><br><span class=\"line\">    cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime &amp;&amp; <span class=\"built_in\">echo</span> <span class=\"string\">\"Asia/Shanghai\"</span> &gt; /etc/timezone &amp;&amp; \\</span><br><span class=\"line\">    apk del tzdata</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 镜像 mysql:5.7</span></span><br><span class=\"line\">RUN cp /usr/share/zoneinfo/PRC /etc/localtime</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>上海时区/usr/share/zoneinfo/Asia/Shanghai实际上是链接到/usr/share/zoneinfo/PRC时区, 所以在第二个中我们的做法也是可取的.</p>\n</blockquote>\n<h2 id=\"结语\"><a href=\"#结语\" class=\"headerlink\" title=\"结语\"></a>结语</h2><p>官方文档是最好的学习资料</p>\n","site":{"data":{}},"excerpt":"","more":"<p>我是一个java程序猿, 当前已经转为nodejs开发, 因为工作需要接触docker到目前为止已经有一年多的时间了, 一下是我学习和使用docker的一些总结.</p>\n<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><h3 id=\"认识docker\"><a href=\"#认识docker\" class=\"headerlink\" title=\"认识docker\"></a>认识docker</h3><p>Docker是一个容器平台, 可以说他是一个虚拟机平台, 但是它又比虚拟机强大. Docker是开发人员和系统管理员使用容器开发，部署和运行应用程序的平台。<br>使用Linux容器部署应用程序称为容器化。容器不是新的，但它们用于轻松部署应用程序。</p>\n<h3 id=\"docker能解决什么问题\"><a href=\"#docker能解决什么问题\" class=\"headerlink\" title=\"docker能解决什么问题\"></a>docker能解决什么问题</h3><ol>\n<li>生产开发环境不一致的问题</li>\n</ol>\n<h3 id=\"基本概念\"><a href=\"#基本概念\" class=\"headerlink\" title=\"基本概念\"></a>基本概念</h3><ol>\n<li>容器</li>\n<li>镜像</li>\n<li>仓库</li>\n</ol>\n<h2 id=\"安装\"><a href=\"#安装\" class=\"headerlink\" title=\"安装\"></a>安装</h2><p><a href=\"https://docs.docker.com/install/\" target=\"_blank\" rel=\"noopener\">参考这里</a></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看docker版本</span></span><br><span class=\"line\">docker --version</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 查看docker信息</span></span><br><span class=\"line\">docker info</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 测试docker是否安装成功</span></span><br><span class=\"line\">docker run hello-world</span><br><span class=\"line\"></span><br><span class=\"line\">Unable to find image <span class=\"string\">'hello-world:latest'</span> locally</span><br><span class=\"line\">latest: Pulling from library/hello-world</span><br><span class=\"line\">ca4f61b1923c: Pull complete</span><br><span class=\"line\">Digest: sha256:ca0eeb6fb05351dfc8759c20733c91def84cb8007aa89a5bf606bc8b315b9fc7</span><br><span class=\"line\">Status: Downloaded newer image <span class=\"keyword\">for</span> hello-world:latest</span><br><span class=\"line\"></span><br><span class=\"line\">Hello from Docker!</span><br><span class=\"line\">This message shows that your installation appears to be working correctly.</span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n<h2 id=\"入门\"><a href=\"#入门\" class=\"headerlink\" title=\"入门\"></a>入门</h2><p>前提条件: 安装好Docker</p>\n<h3 id=\"容器\"><a href=\"#容器\" class=\"headerlink\" title=\"容器\"></a>容器</h3><h4 id=\"创建Dockerfile文件\"><a href=\"#创建Dockerfile文件\" class=\"headerlink\" title=\"创建Dockerfile文件\"></a>创建Dockerfile文件</h4><p>在项目根目录下创建一个Dockerfile文件, 如:</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 将官方 node:9.3.0-alpine 运行时用作父镜像</span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span> node:<span class=\"number\">9.3</span>.<span class=\"number\">0</span>-alpine</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> mkdir -p /app</span></span><br><span class=\"line\"><span class=\"comment\"># 将工作目录设置为 /app</span></span><br><span class=\"line\"><span class=\"keyword\">WORKDIR</span><span class=\"bash\"> /app</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 将当前目录内容复制到位于 /app 中的容器中</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"bash\"> . /app/temp</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> cp /app/temp/package.json /app/package.json &amp;&amp;\\</span></span><br><span class=\"line\"><span class=\"bash\">    npm install --registry=https://registry.npm.taobao.org &amp;&amp;\\</span></span><br><span class=\"line\"><span class=\"bash\">    cp -r /app/temp/pages /app/pages &amp;&amp;\\</span></span><br><span class=\"line\"><span class=\"bash\">    cp -r /app/temp/components /app/components &amp;&amp;\\</span></span><br><span class=\"line\"><span class=\"bash\">    cp -r /app/temp/next.config.js /app/next.config.js &amp;&amp;\\</span></span><br><span class=\"line\"><span class=\"bash\">    rm -rf /app/temp</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 在容器启动时运行</span></span><br><span class=\"line\"><span class=\"keyword\">CMD</span><span class=\"bash\"> [<span class=\"string\">\"npm\"</span>, <span class=\"string\">\"start\"</span>]</span></span><br></pre></td></tr></table></figure>\n<p>有关Dockerfile的命令可以参考这里<a href=\"https://docs.docker.com/develop/develop-images/dockerfile_best-practices/\" target=\"_blank\" rel=\"noopener\">编写Dockerfile的最佳实践</a></p>\n<h4 id=\"构建镜像\"><a href=\"#构建镜像\" class=\"headerlink\" title=\"构建镜像\"></a>构建镜像</h4><p>命令:</p>\n<p><code>docker build -t &lt;image-name&gt; .</code>;</p>\n<blockquote>\n<p>-t image-name 是给镜像添加名称<br>. 代表当前根目录<br>可选参数 -f Dockerfile-name 指定Dockerfile文件, 默认是 Dockerfile, 当我们有如: MYSQL.Dockerfile 则可以使用该参数指定 例: <code>docker build -t imagename . -f MySQL.Dockerfile</code></p>\n</blockquote>\n<h4 id=\"运行容器\"><a href=\"#运行容器\" class=\"headerlink\" title=\"运行容器\"></a>运行容器</h4><p>命令:</p>\n<p><code>docker run -d -p 3000:3000 --name &lt;容器名称&gt; &lt;镜像hashid/镜像名称&gt;</code></p>\n<ol>\n<li>-d 参数指定容器在后台运行</li>\n<li>-p 指定容器端口映射, 主机端口:容器端口, 容器端口指容器内部服务对外暴露的端口,如果tomcat对外提供服务的端口为8080</li>\n<li>–name 参数设置容器名称</li>\n<li>最后接对应的镜像 hashid 或者 镜像名称:tag</li>\n</ol>\n<p>其他常用参数:</p>\n<ol>\n<li>–network 指定容器运行的网络环境</li>\n<li>-v 配置容器数据卷, 更多信息参考 高级篇[容器数据]</li>\n<li>–rm 该命令常常与 -v 一起使用, 在删除/停止容器的时候同事清除数据卷映射关系</li>\n<li>–link 链接到其他容器, 新版本推荐使用 –network 指定容器网络环境即可</li>\n</ol>\n<p>容器镜像操作:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker ps; <span class=\"comment\">#查看当前运行的容器</span></span><br><span class=\"line\">docker ps -a; <span class=\"comment\"># 查看所有的容器</span></span><br><span class=\"line\">docker logs &lt;镜像hashid/镜像名称&gt; <span class=\"comment\"># 查看指定容器的日记</span></span><br><span class=\"line\">docker start &lt;容器hashid/容器名称&gt; <span class=\"comment\"># 启动容器</span></span><br><span class=\"line\">docker stop &lt;容器hashid/容器名称&gt; <span class=\"comment\"># 停止容器</span></span><br><span class=\"line\">docker stop -f &lt;镜像hashid/镜像名称&gt; <span class=\"comment\"># 停止容器, 同时删除容器</span></span><br><span class=\"line\">docker rm &lt;容器hashid/容器名称&gt;... <span class=\"comment\"># 删除容器, 可以同时指定多个 &lt;容器hashid/容器名称&gt;</span></span><br><span class=\"line\">docker rmi &lt;镜像hashid/镜像名称&gt; <span class=\"comment\"># 删除镜像, 必须注意的是, 先删除容器才能删除镜像</span></span><br></pre></td></tr></table></figure>\n<p>推送镜像到仓库</p>\n<ol>\n<li>登陆docker仓库 <code>docker login ...</code></li>\n<li>给镜像打标签 <code>docker tag [本地镜像名称]:[版本号] [存储库名称]:[版本号]</code></li>\n<li>推送到镜像仓库 <code>docker push [账号名]/[存储库名称]:[版本号]</code></li>\n<li>尝试拉取镜像 <code>docker pull [账号名]/[存储库名称]:[版本号]</code></li>\n</ol>\n<p>案例</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 登陆dockerhub</span></span><br><span class=\"line\">docker login</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 构建镜像</span></span><br><span class=\"line\">docker build -t arm64v8/myblog:latest .</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 将本地镜像打标签</span></span><br><span class=\"line\">docker tag arm64v8/myblog:latest jiangzwyz/myblog:latest</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 推送到镜像仓库</span></span><br><span class=\"line\">docker push jiangzwyz/myblog:latest</span><br></pre></td></tr></table></figure>\n<h3 id=\"服务Swarms\"><a href=\"#服务Swarms\" class=\"headerlink\" title=\"服务Swarms\"></a>服务Swarms</h3><p>待补充</p>\n<h2 id=\"高级篇\"><a href=\"#高级篇\" class=\"headerlink\" title=\"高级篇\"></a>高级篇</h2><h3 id=\"容器数据\"><a href=\"#容器数据\" class=\"headerlink\" title=\"容器数据\"></a>容器数据</h3><p>深入了解docker的都会知道docker的方便,但是也会明白docker的缺点,就是容器在被销毁时,其内部的数据将会全部丢失,那么这里我们就将解决这个问题</p>\n<p>最常见的案例就是数据库了, 这里我们以配置 mysql容器为例, 示范如何使用<strong>数据卷</strong>将容器的数据保存到主机上.</p>\n<p>Dockerfile文件:</p>\n<figure class=\"highlight dockerfile\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 拉取 mysql:5.7 官方镜像</span></span><br><span class=\"line\"><span class=\"keyword\">FROM</span> mysql:<span class=\"number\">5.7</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 设置时区 Shanghai</span></span><br><span class=\"line\"><span class=\"keyword\">RUN</span><span class=\"bash\"> cp /usr/share/zoneinfo/PRC /etc/localtime</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ENV 设置 镜像环境变量 mysql 镜像参考官方说明,可以在此配置账户密码</span></span><br><span class=\"line\"><span class=\"keyword\">ENV</span> MYSQL_ROOT_PASSWORD=you_password</span><br><span class=\"line\"><span class=\"keyword\">ENV</span> MYSQL_USER=you_name</span><br><span class=\"line\"><span class=\"keyword\">ENV</span> MYSQL_PASSWORD=you_passowrd</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 这里我使用了自定义mysql的配置文件</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"bash\"> ./mysql/mysql.cnf /etc/mysql/conf.d/mysql.cnf</span></span><br><span class=\"line\"><span class=\"keyword\">COPY</span><span class=\"bash\"> ./mysql/mysqld.cnf /etc/mysql/mysql.conf.d/mysqld.cnf</span></span><br></pre></td></tr></table></figure>\n<p><strong>重点</strong>在这里</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker build -t mysql . -f MYSQL.Dockerfile;</span><br><span class=\"line\">docker run -d -p 3306:3306 --rm -v /mysql/db:/var/lib/mysql --name mysql mysql;</span><br></pre></td></tr></table></figure>\n<p>从当前项目中构建mysql镜像, 然后运行容器时指定主机/mysql/db目录挂载到容器/var/lib/mysql目录(此目录是mysql数据库文件所在)</p>\n<p>数据类的容器,官方都会说明其数据文件存放的位置, 当然我们也可以挂载网盘到容器中.</p>\n<p><img src=\"/../img/docker_01.png\" alt=\" \"></p>\n<h3 id=\"容器网络\"><a href=\"#容器网络\" class=\"headerlink\" title=\"容器网络\"></a>容器网络</h3><h4 id=\"使用容器-你就不应该再去管理烦人的IP\"><a href=\"#使用容器-你就不应该再去管理烦人的IP\" class=\"headerlink\" title=\"使用容器,你就不应该再去管理烦人的IP\"></a>使用容器,你就不应该再去管理烦人的IP</h4><p>我们载部署项目的时候经常会遇到这个问题, 我们的项目需要连接mysql, 一般我们通过ip去连接*(localhost:3306、127.0.0.1:3306), 这样到还简单,如果我们的mysql IP是动态的, 怎么办? 你改的几次就会抓狂的. 所以我们需要使用到 容器网络  network</p>\n<h4 id=\"在Docker中建立-自定义-桥网络\"><a href=\"#在Docker中建立-自定义-桥网络\" class=\"headerlink\" title=\"在Docker中建立 自定义 桥网络\"></a>在Docker中建立 自定义 桥网络</h4><ol>\n<li>连接到默认bridge网络的容器可以通过IP地址相互通信。Docker不支持默认网桥上的自动服务发现。如果希望容器能够按容器名称解析IP地址，则应使用用户定义的网络。您可以使用旧版docker run –link选项将两个容器链接在一起，但在大多数情况下不建议这样做。</li>\n<li>使用自定义 bridge网络 运行在其中的容器可以发现对方</li>\n<li>要实现 容器间通讯，采用 自定义 桥网络 （容器必须在同一主机中）</li>\n<li>network  桥网络，容器运行再 用户自定义桥网络 中，容器间可以通过 局域网访问（<strong>不适用于分布式主机</strong>），默认桥网络不支持这样</li>\n</ol>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查看当前主机中网络列表</span></span><br><span class=\"line\">$ docker network ls</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 创建 桥网络</span></span><br><span class=\"line\">$ docker network create --driver bridge [network-name]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 将容器运行在对应的 bridge网络 中，使用 --network=[network-name]</span></span><br><span class=\"line\">$ docker run -d -p 80:80 -p 443:443 --network=[network-name] --name mynginx [container-images-id]</span><br><span class=\"line\">$ docker run -d -p 80:80 -p 443:443 --rm -v ~/../workspace/myimages/images:/app/images &amp;&amp;\\</span><br><span class=\"line\">  --network=[network-name] &amp; --name=1.2.3.4 [container-images-id]</span><br></pre></td></tr></table></figure>\n<p>在同一个 network 网络中的两个容器之间通信可以直接使用 容器名称:端口 的方式去访问,<br>如: mysql:3306</p>\n<h3 id=\"k8s\"><a href=\"#k8s\" class=\"headerlink\" title=\"k8s\"></a>k8s</h3><p>容器编排</p>\n<h2 id=\"其他\"><a href=\"#其他\" class=\"headerlink\" title=\"其他\"></a>其他</h2><h3 id=\"设置容器时区\"><a href=\"#设置容器时区\" class=\"headerlink\" title=\"设置容器时区\"></a>设置容器时区</h3><p>时区问题一直都是我们需要解决的问题, 容器同样避免不了这个问题.</p>\n<p>在linux中, 我们可以将本地时间文件拷贝到/etc/localtime即可设置容器时间</p>\n<p>linux的时区设置文件在 /usr/share/zoneinfo/Asia</p>\n<p>我们将设置系统时间为 上海 例:</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 在Dockerfile中添加:</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># linux版本: node:9.3.0-alpine</span></span><br><span class=\"line\">RUN apk add --no-cache tzdata &amp;&amp; \\</span><br><span class=\"line\">    cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime &amp;&amp; <span class=\"built_in\">echo</span> <span class=\"string\">\"Asia/Shanghai\"</span> &gt; /etc/timezone &amp;&amp; \\</span><br><span class=\"line\">    apk del tzdata</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 镜像 mysql:5.7</span></span><br><span class=\"line\">RUN cp /usr/share/zoneinfo/PRC /etc/localtime</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>上海时区/usr/share/zoneinfo/Asia/Shanghai实际上是链接到/usr/share/zoneinfo/PRC时区, 所以在第二个中我们的做法也是可取的.</p>\n</blockquote>\n<h2 id=\"结语\"><a href=\"#结语\" class=\"headerlink\" title=\"结语\"></a>结语</h2><p>官方文档是最好的学习资料</p>\n"},{"title":"cron表达式","date":"2019-07-17T10:08:11.000Z","_content":"\ncron表达式常用于调度任务\n\n本文摘自:[cron表达式详解](https://www.cnblogs.com/javahr/p/8318728.html)\n\n## 结构\n\ncorn从左到右（用空格隔开）：秒 分 小时 月份中的日期 月份 星期中的日期 年份\n\n## 各字段的含义\n\n字段|允许值|允许的特殊字符\n:-------:|:-----------------------:|:------------:\n秒（Seconds）|0~59的整数|, - * /    四个字符\n分（Minutes）|0~59的整数|, - * /    四个字符\n小时（Hours）|0~23的整数|, - * /    四个字符\n日期（DayofMonth）|1~31的整数（但是你需要考虑你月的天数）|,- * ? / L W C     八个字符\n月份（Month）|1~12的整数或者 JAN-DEC|, - * /    四个字符\n星期（DayofWeek）|1~7的整数或者 SUN-SAT （1=SUN）|, - * ? / L C #     八个字符\n年(可选，留空)（Year）|1970~2099|, - * /    四个字符\n\n## 注意事项\n\n每一个域都使用数字，但还可以出现如下特殊字符，它们的含义是:\n\n1. *：表示匹配该域的任意值。假如在Minutes域使用*, 即表示每分钟都会触发事件。\n2. ?：只能用在DayofMonth和DayofWeek两个域。它也匹配域的任意值，但实际不会。因为DayofMonth和DayofWeek会相互影响。例如想在每月的20日触发调度，不管20日到底是星期几，则只能使用如下写法： 13 13 15 20 * ?, 其中最后一位只能用？，而不能使用*，如果使用*表示不管星期几都会触发，实际上并不是这样。\n3. -：表示范围。例如在Minutes域使用5-20，表示从5分到20分钟每分钟触发一次\n4. /：表示起始时间开始触发，然后每隔固定时间触发一次。例如在Minutes域使用5/20,则意味着从5分开始每20分钟触发一次\n5. ,：表示列出枚举值。例如：在Minutes域使用5,20，则意味着在5和20分每分钟触发一次。\n6. L：表示最后，只能出现在DayofWeek和DayofMonth域。如果在DayofWeek域使用5L,意味着在最后的一个星期四触发。\n7. W:表示有效工作日(周一到周五),只能出现在DayofMonth域，系统将在离指定日期的最近的有效工作日触发事件。例如：在 DayofMonth使用5W，如果5日是星期六，则将在最近的工作日：星期五，即4日触发。如果5日是星期天，则在6日(周一)触发；如果5日在星期一到星期五中的一天，则就在5日触发。另外一点，W的最近寻找不会跨过月份 。\n8. LW:这两个字符可以连用，表示在某个月最后一个工作日，即最后一个星期五。\n9. #:用于确定每个月第几个星期几，只能出现在DayofMonth域。例如在4#2，表示某月的第二个星期三。\n\n## 常用表达式例子\n\n1. 0 0 2 1 * ? *   表示在每月的1日的凌晨2点调整任务\n2. 0 15 10 ? * MON-FRI   表示周一到周五每天上午10:15执行作业\n3. 0 15 10 ? 6L 2002-2006   表示2002-2006年的每个月的最后一个星期五上午10:15执行作\n4. 0 0 10,14,16 * * ?   每天上午10点，下午2点，4点\n5. 0 0/30 9-17 * * ?   朝九晚五工作时间内每半小时\n6. 0 0 12 ? * WED    表示每个星期三中午12点\n7. 0 0 12 * * ?   每天中午12点触发\n8. 0 15 10 ? * *    每天上午10:15触发\n9. 0 15 10 * * ?     每天上午10:15触发\n10. 0 15 10 * * ? *    每天上午10:15触发\n11. 0 15 10 * * ? 2005    2005年的每天上午10:15触发\n12. 0 * 14 * * ?     在每天下午2点到下午2:59期间的每1分钟触发\n13. 0 0/5 14 * * ?    在每天下午2点到下午2:55期间的每5分钟触发\n14. 0 0/5 14,18 * * ?     在每天下午2点到2:55期间和下午6点到6:55期间的每5分钟触发\n15. 0 0-5 14 * * ?    在每天下午2点到下午2:05期间的每1分钟触发\n16. 0 10,44 14 ? 3 WED    每年三月的星期三的下午2:10和2:44触发\n17. 0 15 10 ? * MON-FRI    周一至周五的上午10:15触发\n18. 0 15 10 15 * ?    每月15日上午10:15触发\n19. 0 15 10 L * ?    每月最后一日的上午10:15触发\n20. 0 15 10 ? * 6L    每月的最后一个星期五上午10:15触发\n21. 0 15 10 ? * 6L 2002-2005   2002年至2005年的每月的最后一个星期五上午10:15触发\n22. 0 15 10 ? * 6#3   每月的第三个星期五上午10:15触发\n\n## 最后\n\n有些子表达式能包含一些范围或列表\n\n例如：子表达式（天（星期））可以为 “MON-FRI”，“MON，WED，FRI”，“MON-WED,SAT”\n\n“*”字符代表所有可能的值\n\n因此，“*”在子表达式（月）里表示每个月的含义，“*”在子表达式（天（星期））表示星期的每一天\n\n“/”字符用来指定数值的增量 \n例如：在子表达式（分钟）里的“0/15”表示从第0分钟开始，每15分钟 \n在子表达式（分钟）里的“3/20”表示从第3分钟开始，每20分钟（它和“3，23，43”）的含义一样\n\n“？”字符仅被用于天（月）和天（星期）两个子表达式，表示不指定值 \n当2个子表达式其中之一被指定了值以后，为了避免冲突，需要将另一个子表达式的值设为“？”\n\n“L” 字符仅被用于天（月）和天（星期）两个子表达式，它是单词“last”的缩写 \n但是它在两个子表达式里的含义是不同的。 \n在天（月）子表达式中，“L”表示一个月的最后一天 \n在天（星期）自表达式中，“L”表示一个星期的最后一天，也就是SAT\n\n如果在“L”前有具体的内容，它就具有其他的含义了\n\n例如：“6L”表示这个月的倒数第６天，“FRIL”表示这个月的最一个星期五 \n注意：在使用“L”参数时，不要指定列表或范围，因为这会导致问题\n","source":"_posts/cron.md","raw":"---\ntitle: cron表达式\ndate: 2019-07-17 18:08:11\ntags: \n---\n\ncron表达式常用于调度任务\n\n本文摘自:[cron表达式详解](https://www.cnblogs.com/javahr/p/8318728.html)\n\n## 结构\n\ncorn从左到右（用空格隔开）：秒 分 小时 月份中的日期 月份 星期中的日期 年份\n\n## 各字段的含义\n\n字段|允许值|允许的特殊字符\n:-------:|:-----------------------:|:------------:\n秒（Seconds）|0~59的整数|, - * /    四个字符\n分（Minutes）|0~59的整数|, - * /    四个字符\n小时（Hours）|0~23的整数|, - * /    四个字符\n日期（DayofMonth）|1~31的整数（但是你需要考虑你月的天数）|,- * ? / L W C     八个字符\n月份（Month）|1~12的整数或者 JAN-DEC|, - * /    四个字符\n星期（DayofWeek）|1~7的整数或者 SUN-SAT （1=SUN）|, - * ? / L C #     八个字符\n年(可选，留空)（Year）|1970~2099|, - * /    四个字符\n\n## 注意事项\n\n每一个域都使用数字，但还可以出现如下特殊字符，它们的含义是:\n\n1. *：表示匹配该域的任意值。假如在Minutes域使用*, 即表示每分钟都会触发事件。\n2. ?：只能用在DayofMonth和DayofWeek两个域。它也匹配域的任意值，但实际不会。因为DayofMonth和DayofWeek会相互影响。例如想在每月的20日触发调度，不管20日到底是星期几，则只能使用如下写法： 13 13 15 20 * ?, 其中最后一位只能用？，而不能使用*，如果使用*表示不管星期几都会触发，实际上并不是这样。\n3. -：表示范围。例如在Minutes域使用5-20，表示从5分到20分钟每分钟触发一次\n4. /：表示起始时间开始触发，然后每隔固定时间触发一次。例如在Minutes域使用5/20,则意味着从5分开始每20分钟触发一次\n5. ,：表示列出枚举值。例如：在Minutes域使用5,20，则意味着在5和20分每分钟触发一次。\n6. L：表示最后，只能出现在DayofWeek和DayofMonth域。如果在DayofWeek域使用5L,意味着在最后的一个星期四触发。\n7. W:表示有效工作日(周一到周五),只能出现在DayofMonth域，系统将在离指定日期的最近的有效工作日触发事件。例如：在 DayofMonth使用5W，如果5日是星期六，则将在最近的工作日：星期五，即4日触发。如果5日是星期天，则在6日(周一)触发；如果5日在星期一到星期五中的一天，则就在5日触发。另外一点，W的最近寻找不会跨过月份 。\n8. LW:这两个字符可以连用，表示在某个月最后一个工作日，即最后一个星期五。\n9. #:用于确定每个月第几个星期几，只能出现在DayofMonth域。例如在4#2，表示某月的第二个星期三。\n\n## 常用表达式例子\n\n1. 0 0 2 1 * ? *   表示在每月的1日的凌晨2点调整任务\n2. 0 15 10 ? * MON-FRI   表示周一到周五每天上午10:15执行作业\n3. 0 15 10 ? 6L 2002-2006   表示2002-2006年的每个月的最后一个星期五上午10:15执行作\n4. 0 0 10,14,16 * * ?   每天上午10点，下午2点，4点\n5. 0 0/30 9-17 * * ?   朝九晚五工作时间内每半小时\n6. 0 0 12 ? * WED    表示每个星期三中午12点\n7. 0 0 12 * * ?   每天中午12点触发\n8. 0 15 10 ? * *    每天上午10:15触发\n9. 0 15 10 * * ?     每天上午10:15触发\n10. 0 15 10 * * ? *    每天上午10:15触发\n11. 0 15 10 * * ? 2005    2005年的每天上午10:15触发\n12. 0 * 14 * * ?     在每天下午2点到下午2:59期间的每1分钟触发\n13. 0 0/5 14 * * ?    在每天下午2点到下午2:55期间的每5分钟触发\n14. 0 0/5 14,18 * * ?     在每天下午2点到2:55期间和下午6点到6:55期间的每5分钟触发\n15. 0 0-5 14 * * ?    在每天下午2点到下午2:05期间的每1分钟触发\n16. 0 10,44 14 ? 3 WED    每年三月的星期三的下午2:10和2:44触发\n17. 0 15 10 ? * MON-FRI    周一至周五的上午10:15触发\n18. 0 15 10 15 * ?    每月15日上午10:15触发\n19. 0 15 10 L * ?    每月最后一日的上午10:15触发\n20. 0 15 10 ? * 6L    每月的最后一个星期五上午10:15触发\n21. 0 15 10 ? * 6L 2002-2005   2002年至2005年的每月的最后一个星期五上午10:15触发\n22. 0 15 10 ? * 6#3   每月的第三个星期五上午10:15触发\n\n## 最后\n\n有些子表达式能包含一些范围或列表\n\n例如：子表达式（天（星期））可以为 “MON-FRI”，“MON，WED，FRI”，“MON-WED,SAT”\n\n“*”字符代表所有可能的值\n\n因此，“*”在子表达式（月）里表示每个月的含义，“*”在子表达式（天（星期））表示星期的每一天\n\n“/”字符用来指定数值的增量 \n例如：在子表达式（分钟）里的“0/15”表示从第0分钟开始，每15分钟 \n在子表达式（分钟）里的“3/20”表示从第3分钟开始，每20分钟（它和“3，23，43”）的含义一样\n\n“？”字符仅被用于天（月）和天（星期）两个子表达式，表示不指定值 \n当2个子表达式其中之一被指定了值以后，为了避免冲突，需要将另一个子表达式的值设为“？”\n\n“L” 字符仅被用于天（月）和天（星期）两个子表达式，它是单词“last”的缩写 \n但是它在两个子表达式里的含义是不同的。 \n在天（月）子表达式中，“L”表示一个月的最后一天 \n在天（星期）自表达式中，“L”表示一个星期的最后一天，也就是SAT\n\n如果在“L”前有具体的内容，它就具有其他的含义了\n\n例如：“6L”表示这个月的倒数第６天，“FRIL”表示这个月的最一个星期五 \n注意：在使用“L”参数时，不要指定列表或范围，因为这会导致问题\n","slug":"cron","published":1,"updated":"2019-07-17T10:19:12.992Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck550trlf0008hm62qyugr1u5","content":"<p>cron表达式常用于调度任务</p>\n<p>本文摘自:<a href=\"https://www.cnblogs.com/javahr/p/8318728.html\" target=\"_blank\" rel=\"noopener\">cron表达式详解</a></p>\n<h2 id=\"结构\"><a href=\"#结构\" class=\"headerlink\" title=\"结构\"></a>结构</h2><p>corn从左到右（用空格隔开）：秒 分 小时 月份中的日期 月份 星期中的日期 年份</p>\n<h2 id=\"各字段的含义\"><a href=\"#各字段的含义\" class=\"headerlink\" title=\"各字段的含义\"></a>各字段的含义</h2><table>\n<thead>\n<tr>\n<th style=\"text-align:center\">字段</th>\n<th style=\"text-align:center\">允许值</th>\n<th style=\"text-align:center\">允许的特殊字符</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">秒（Seconds）</td>\n<td style=\"text-align:center\">0~59的整数</td>\n<td style=\"text-align:center\">, - * /    四个字符</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">分（Minutes）</td>\n<td style=\"text-align:center\">0~59的整数</td>\n<td style=\"text-align:center\">, - * /    四个字符</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">小时（Hours）</td>\n<td style=\"text-align:center\">0~23的整数</td>\n<td style=\"text-align:center\">, - * /    四个字符</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">日期（DayofMonth）</td>\n<td style=\"text-align:center\">1~31的整数（但是你需要考虑你月的天数）</td>\n<td style=\"text-align:center\">,- * ? / L W C     八个字符</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">月份（Month）</td>\n<td style=\"text-align:center\">1~12的整数或者 JAN-DEC</td>\n<td style=\"text-align:center\">, - * /    四个字符</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">星期（DayofWeek）</td>\n<td style=\"text-align:center\">1~7的整数或者 SUN-SAT （1=SUN）</td>\n<td style=\"text-align:center\">, - * ? / L C #     八个字符</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">年(可选，留空)（Year）</td>\n<td style=\"text-align:center\">1970~2099</td>\n<td style=\"text-align:center\">, - * /    四个字符</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"注意事项\"><a href=\"#注意事项\" class=\"headerlink\" title=\"注意事项\"></a>注意事项</h2><p>每一个域都使用数字，但还可以出现如下特殊字符，它们的含义是:</p>\n<ol>\n<li><em>：表示匹配该域的任意值。假如在Minutes域使用</em>, 即表示每分钟都会触发事件。</li>\n<li>?：只能用在DayofMonth和DayofWeek两个域。它也匹配域的任意值，但实际不会。因为DayofMonth和DayofWeek会相互影响。例如想在每月的20日触发调度，不管20日到底是星期几，则只能使用如下写法： 13 13 15 20 <em> ?, 其中最后一位只能用？，而不能使用</em>，如果使用*表示不管星期几都会触发，实际上并不是这样。</li>\n<li>-：表示范围。例如在Minutes域使用5-20，表示从5分到20分钟每分钟触发一次</li>\n<li>/：表示起始时间开始触发，然后每隔固定时间触发一次。例如在Minutes域使用5/20,则意味着从5分开始每20分钟触发一次</li>\n<li>,：表示列出枚举值。例如：在Minutes域使用5,20，则意味着在5和20分每分钟触发一次。</li>\n<li>L：表示最后，只能出现在DayofWeek和DayofMonth域。如果在DayofWeek域使用5L,意味着在最后的一个星期四触发。</li>\n<li>W:表示有效工作日(周一到周五),只能出现在DayofMonth域，系统将在离指定日期的最近的有效工作日触发事件。例如：在 DayofMonth使用5W，如果5日是星期六，则将在最近的工作日：星期五，即4日触发。如果5日是星期天，则在6日(周一)触发；如果5日在星期一到星期五中的一天，则就在5日触发。另外一点，W的最近寻找不会跨过月份 。</li>\n<li>LW:这两个字符可以连用，表示在某个月最后一个工作日，即最后一个星期五。</li>\n<li>#:用于确定每个月第几个星期几，只能出现在DayofMonth域。例如在4#2，表示某月的第二个星期三。</li>\n</ol>\n<h2 id=\"常用表达式例子\"><a href=\"#常用表达式例子\" class=\"headerlink\" title=\"常用表达式例子\"></a>常用表达式例子</h2><ol>\n<li>0 0 2 1 <em> ? </em>   表示在每月的1日的凌晨2点调整任务</li>\n<li>0 15 10 ? * MON-FRI   表示周一到周五每天上午10:15执行作业</li>\n<li>0 15 10 ? 6L 2002-2006   表示2002-2006年的每个月的最后一个星期五上午10:15执行作</li>\n<li>0 0 10,14,16 <em> </em> ?   每天上午10点，下午2点，4点</li>\n<li>0 0/30 9-17 <em> </em> ?   朝九晚五工作时间内每半小时</li>\n<li>0 0 12 ? * WED    表示每个星期三中午12点</li>\n<li>0 0 12 <em> </em> ?   每天中午12点触发</li>\n<li>0 15 10 ? <em> </em>    每天上午10:15触发</li>\n<li>0 15 10 <em> </em> ?     每天上午10:15触发</li>\n<li>0 15 10 <em> </em> ? *    每天上午10:15触发</li>\n<li>0 15 10 <em> </em> ? 2005    2005年的每天上午10:15触发</li>\n<li>0 <em> 14 </em> * ?     在每天下午2点到下午2:59期间的每1分钟触发</li>\n<li>0 0/5 14 <em> </em> ?    在每天下午2点到下午2:55期间的每5分钟触发</li>\n<li>0 0/5 14,18 <em> </em> ?     在每天下午2点到2:55期间和下午6点到6:55期间的每5分钟触发</li>\n<li>0 0-5 14 <em> </em> ?    在每天下午2点到下午2:05期间的每1分钟触发</li>\n<li>0 10,44 14 ? 3 WED    每年三月的星期三的下午2:10和2:44触发</li>\n<li>0 15 10 ? * MON-FRI    周一至周五的上午10:15触发</li>\n<li>0 15 10 15 * ?    每月15日上午10:15触发</li>\n<li>0 15 10 L * ?    每月最后一日的上午10:15触发</li>\n<li>0 15 10 ? * 6L    每月的最后一个星期五上午10:15触发</li>\n<li>0 15 10 ? * 6L 2002-2005   2002年至2005年的每月的最后一个星期五上午10:15触发</li>\n<li>0 15 10 ? * 6#3   每月的第三个星期五上午10:15触发</li>\n</ol>\n<h2 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h2><p>有些子表达式能包含一些范围或列表</p>\n<p>例如：子表达式（天（星期））可以为 “MON-FRI”，“MON，WED，FRI”，“MON-WED,SAT”</p>\n<p>“*”字符代表所有可能的值</p>\n<p>因此，“<em>”在子表达式（月）里表示每个月的含义，“</em>”在子表达式（天（星期））表示星期的每一天</p>\n<p>“/”字符用来指定数值的增量<br>例如：在子表达式（分钟）里的“0/15”表示从第0分钟开始，每15分钟<br>在子表达式（分钟）里的“3/20”表示从第3分钟开始，每20分钟（它和“3，23，43”）的含义一样</p>\n<p>“？”字符仅被用于天（月）和天（星期）两个子表达式，表示不指定值<br>当2个子表达式其中之一被指定了值以后，为了避免冲突，需要将另一个子表达式的值设为“？”</p>\n<p>“L” 字符仅被用于天（月）和天（星期）两个子表达式，它是单词“last”的缩写<br>但是它在两个子表达式里的含义是不同的。<br>在天（月）子表达式中，“L”表示一个月的最后一天<br>在天（星期）自表达式中，“L”表示一个星期的最后一天，也就是SAT</p>\n<p>如果在“L”前有具体的内容，它就具有其他的含义了</p>\n<p>例如：“6L”表示这个月的倒数第６天，“FRIL”表示这个月的最一个星期五<br>注意：在使用“L”参数时，不要指定列表或范围，因为这会导致问题</p>\n","site":{"data":{}},"excerpt":"","more":"<p>cron表达式常用于调度任务</p>\n<p>本文摘自:<a href=\"https://www.cnblogs.com/javahr/p/8318728.html\" target=\"_blank\" rel=\"noopener\">cron表达式详解</a></p>\n<h2 id=\"结构\"><a href=\"#结构\" class=\"headerlink\" title=\"结构\"></a>结构</h2><p>corn从左到右（用空格隔开）：秒 分 小时 月份中的日期 月份 星期中的日期 年份</p>\n<h2 id=\"各字段的含义\"><a href=\"#各字段的含义\" class=\"headerlink\" title=\"各字段的含义\"></a>各字段的含义</h2><table>\n<thead>\n<tr>\n<th style=\"text-align:center\">字段</th>\n<th style=\"text-align:center\">允许值</th>\n<th style=\"text-align:center\">允许的特殊字符</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">秒（Seconds）</td>\n<td style=\"text-align:center\">0~59的整数</td>\n<td style=\"text-align:center\">, - * /    四个字符</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">分（Minutes）</td>\n<td style=\"text-align:center\">0~59的整数</td>\n<td style=\"text-align:center\">, - * /    四个字符</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">小时（Hours）</td>\n<td style=\"text-align:center\">0~23的整数</td>\n<td style=\"text-align:center\">, - * /    四个字符</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">日期（DayofMonth）</td>\n<td style=\"text-align:center\">1~31的整数（但是你需要考虑你月的天数）</td>\n<td style=\"text-align:center\">,- * ? / L W C     八个字符</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">月份（Month）</td>\n<td style=\"text-align:center\">1~12的整数或者 JAN-DEC</td>\n<td style=\"text-align:center\">, - * /    四个字符</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">星期（DayofWeek）</td>\n<td style=\"text-align:center\">1~7的整数或者 SUN-SAT （1=SUN）</td>\n<td style=\"text-align:center\">, - * ? / L C #     八个字符</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">年(可选，留空)（Year）</td>\n<td style=\"text-align:center\">1970~2099</td>\n<td style=\"text-align:center\">, - * /    四个字符</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"注意事项\"><a href=\"#注意事项\" class=\"headerlink\" title=\"注意事项\"></a>注意事项</h2><p>每一个域都使用数字，但还可以出现如下特殊字符，它们的含义是:</p>\n<ol>\n<li><em>：表示匹配该域的任意值。假如在Minutes域使用</em>, 即表示每分钟都会触发事件。</li>\n<li>?：只能用在DayofMonth和DayofWeek两个域。它也匹配域的任意值，但实际不会。因为DayofMonth和DayofWeek会相互影响。例如想在每月的20日触发调度，不管20日到底是星期几，则只能使用如下写法： 13 13 15 20 <em> ?, 其中最后一位只能用？，而不能使用</em>，如果使用*表示不管星期几都会触发，实际上并不是这样。</li>\n<li>-：表示范围。例如在Minutes域使用5-20，表示从5分到20分钟每分钟触发一次</li>\n<li>/：表示起始时间开始触发，然后每隔固定时间触发一次。例如在Minutes域使用5/20,则意味着从5分开始每20分钟触发一次</li>\n<li>,：表示列出枚举值。例如：在Minutes域使用5,20，则意味着在5和20分每分钟触发一次。</li>\n<li>L：表示最后，只能出现在DayofWeek和DayofMonth域。如果在DayofWeek域使用5L,意味着在最后的一个星期四触发。</li>\n<li>W:表示有效工作日(周一到周五),只能出现在DayofMonth域，系统将在离指定日期的最近的有效工作日触发事件。例如：在 DayofMonth使用5W，如果5日是星期六，则将在最近的工作日：星期五，即4日触发。如果5日是星期天，则在6日(周一)触发；如果5日在星期一到星期五中的一天，则就在5日触发。另外一点，W的最近寻找不会跨过月份 。</li>\n<li>LW:这两个字符可以连用，表示在某个月最后一个工作日，即最后一个星期五。</li>\n<li>#:用于确定每个月第几个星期几，只能出现在DayofMonth域。例如在4#2，表示某月的第二个星期三。</li>\n</ol>\n<h2 id=\"常用表达式例子\"><a href=\"#常用表达式例子\" class=\"headerlink\" title=\"常用表达式例子\"></a>常用表达式例子</h2><ol>\n<li>0 0 2 1 <em> ? </em>   表示在每月的1日的凌晨2点调整任务</li>\n<li>0 15 10 ? * MON-FRI   表示周一到周五每天上午10:15执行作业</li>\n<li>0 15 10 ? 6L 2002-2006   表示2002-2006年的每个月的最后一个星期五上午10:15执行作</li>\n<li>0 0 10,14,16 <em> </em> ?   每天上午10点，下午2点，4点</li>\n<li>0 0/30 9-17 <em> </em> ?   朝九晚五工作时间内每半小时</li>\n<li>0 0 12 ? * WED    表示每个星期三中午12点</li>\n<li>0 0 12 <em> </em> ?   每天中午12点触发</li>\n<li>0 15 10 ? <em> </em>    每天上午10:15触发</li>\n<li>0 15 10 <em> </em> ?     每天上午10:15触发</li>\n<li>0 15 10 <em> </em> ? *    每天上午10:15触发</li>\n<li>0 15 10 <em> </em> ? 2005    2005年的每天上午10:15触发</li>\n<li>0 <em> 14 </em> * ?     在每天下午2点到下午2:59期间的每1分钟触发</li>\n<li>0 0/5 14 <em> </em> ?    在每天下午2点到下午2:55期间的每5分钟触发</li>\n<li>0 0/5 14,18 <em> </em> ?     在每天下午2点到2:55期间和下午6点到6:55期间的每5分钟触发</li>\n<li>0 0-5 14 <em> </em> ?    在每天下午2点到下午2:05期间的每1分钟触发</li>\n<li>0 10,44 14 ? 3 WED    每年三月的星期三的下午2:10和2:44触发</li>\n<li>0 15 10 ? * MON-FRI    周一至周五的上午10:15触发</li>\n<li>0 15 10 15 * ?    每月15日上午10:15触发</li>\n<li>0 15 10 L * ?    每月最后一日的上午10:15触发</li>\n<li>0 15 10 ? * 6L    每月的最后一个星期五上午10:15触发</li>\n<li>0 15 10 ? * 6L 2002-2005   2002年至2005年的每月的最后一个星期五上午10:15触发</li>\n<li>0 15 10 ? * 6#3   每月的第三个星期五上午10:15触发</li>\n</ol>\n<h2 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h2><p>有些子表达式能包含一些范围或列表</p>\n<p>例如：子表达式（天（星期））可以为 “MON-FRI”，“MON，WED，FRI”，“MON-WED,SAT”</p>\n<p>“*”字符代表所有可能的值</p>\n<p>因此，“<em>”在子表达式（月）里表示每个月的含义，“</em>”在子表达式（天（星期））表示星期的每一天</p>\n<p>“/”字符用来指定数值的增量<br>例如：在子表达式（分钟）里的“0/15”表示从第0分钟开始，每15分钟<br>在子表达式（分钟）里的“3/20”表示从第3分钟开始，每20分钟（它和“3，23，43”）的含义一样</p>\n<p>“？”字符仅被用于天（月）和天（星期）两个子表达式，表示不指定值<br>当2个子表达式其中之一被指定了值以后，为了避免冲突，需要将另一个子表达式的值设为“？”</p>\n<p>“L” 字符仅被用于天（月）和天（星期）两个子表达式，它是单词“last”的缩写<br>但是它在两个子表达式里的含义是不同的。<br>在天（月）子表达式中，“L”表示一个月的最后一天<br>在天（星期）自表达式中，“L”表示一个星期的最后一天，也就是SAT</p>\n<p>如果在“L”前有具体的内容，它就具有其他的含义了</p>\n<p>例如：“6L”表示这个月的倒数第６天，“FRIL”表示这个月的最一个星期五<br>注意：在使用“L”参数时，不要指定列表或范围，因为这会导致问题</p>\n"},{"title":"IIS服务器学习","date":"2019-05-15T08:13:34.000Z","_content":"\nIIS是Internet Information Services的缩写. 微软公司提供的基于运行Microsoft Windows的互联网基本服务. IIS是一种Web（网页）服务组件，其中包括Web服务器、FTP服务器、NNTP服务器和SMTP服务器，分别用于网页浏览、文件传输、新闻服务和邮件发送等方面，它使得在网络（包括互联网和局域网）上发布信息成了一件很容易的事.\n\n## IIS 服务器\n\nIIS服务器是Windows自带的一个服务器, 默认是禁用的, 我们需要在 控制面板 -> 程序与应用 中开启这个服务, 然后在管理工具中添加你的网站即可.\n\n## 配置IIS服务\n\n> 我以 windows 10 为例\n\n找到控制面板, 打开**程序和功能**, 点击左侧的**启用和关闭windows功能**\n\n![ ](/img/iis_01.png)\n\n![ ](/../img/iis_02.png)\n\n如图所示, 勾选 **Internet Information Service** 选项, 会自动帮你选中子选项, 到这里一个简单的iis服务器就算启动了\n\n![ ](/../img/iis_03.png)\n\n> [浏览器输入(或点击这里)](http://localhost)就可以看到以下信息\n\n![ ](/../img/iis_04.png)\n\n## 管理你的网站\n\n### 管理界面\n\n同样的在控制面板, 打开**管理工具**, 找到**Internet Information Service(IIS)管理器**\n\n![ ](/../img/iis_05.png)\n\n这个就是你的IIS服务器的管理界面\n\n### 添加网站\n\n右键**服务器**/**网站**选择**添加网站**, 出现如下界面, 填写网站相关信息即可.\n\n![ ](/../img/iis_06.png)\n\n我将本机的一个图片目录部署为一个网站, *图片服务器*\n\n1. 网站名称, 即你的网站名字.\n2. 应用程序池, 默认即可, 深入的再探讨.\n3. 物理路径, 就是你的项目所在路径\n4. 绑定\n   1. 类型 http/htts, 如果选择为 https 还需要配置证书\n   2. IP地址段, 你可以在你局域网的IP段内自定义, 默认就是本机IP(localhost、127.0.0.1)\n   3. 端口不能重复, 这里我配置为 8001\n5. 主机名,就是你的域名, 默认不需要修改, 相应的修改需要配置 hosts 文件 (路径\"C:\\Windows\\System32\\drivers\\etc\\hosts\")\n\n最后一步, 点击确认保存, 你可以看到:\n\n![ ](/../img/iis_07.png)\n\n打开浏览器,输入 [localhost:8001/1.jpg](http://localhost:8001/1.jpg), 你可以看到:\n\n![ ](/../img/iis_08.png)\n\n## 结语\n\n学无止境","source":"_posts/iis.md","raw":"---\ntitle: IIS服务器学习\ndate: 2019-05-15 16:13:34\ntags: 服务器\n---\n\nIIS是Internet Information Services的缩写. 微软公司提供的基于运行Microsoft Windows的互联网基本服务. IIS是一种Web（网页）服务组件，其中包括Web服务器、FTP服务器、NNTP服务器和SMTP服务器，分别用于网页浏览、文件传输、新闻服务和邮件发送等方面，它使得在网络（包括互联网和局域网）上发布信息成了一件很容易的事.\n\n## IIS 服务器\n\nIIS服务器是Windows自带的一个服务器, 默认是禁用的, 我们需要在 控制面板 -> 程序与应用 中开启这个服务, 然后在管理工具中添加你的网站即可.\n\n## 配置IIS服务\n\n> 我以 windows 10 为例\n\n找到控制面板, 打开**程序和功能**, 点击左侧的**启用和关闭windows功能**\n\n![ ](/img/iis_01.png)\n\n![ ](/../img/iis_02.png)\n\n如图所示, 勾选 **Internet Information Service** 选项, 会自动帮你选中子选项, 到这里一个简单的iis服务器就算启动了\n\n![ ](/../img/iis_03.png)\n\n> [浏览器输入(或点击这里)](http://localhost)就可以看到以下信息\n\n![ ](/../img/iis_04.png)\n\n## 管理你的网站\n\n### 管理界面\n\n同样的在控制面板, 打开**管理工具**, 找到**Internet Information Service(IIS)管理器**\n\n![ ](/../img/iis_05.png)\n\n这个就是你的IIS服务器的管理界面\n\n### 添加网站\n\n右键**服务器**/**网站**选择**添加网站**, 出现如下界面, 填写网站相关信息即可.\n\n![ ](/../img/iis_06.png)\n\n我将本机的一个图片目录部署为一个网站, *图片服务器*\n\n1. 网站名称, 即你的网站名字.\n2. 应用程序池, 默认即可, 深入的再探讨.\n3. 物理路径, 就是你的项目所在路径\n4. 绑定\n   1. 类型 http/htts, 如果选择为 https 还需要配置证书\n   2. IP地址段, 你可以在你局域网的IP段内自定义, 默认就是本机IP(localhost、127.0.0.1)\n   3. 端口不能重复, 这里我配置为 8001\n5. 主机名,就是你的域名, 默认不需要修改, 相应的修改需要配置 hosts 文件 (路径\"C:\\Windows\\System32\\drivers\\etc\\hosts\")\n\n最后一步, 点击确认保存, 你可以看到:\n\n![ ](/../img/iis_07.png)\n\n打开浏览器,输入 [localhost:8001/1.jpg](http://localhost:8001/1.jpg), 你可以看到:\n\n![ ](/../img/iis_08.png)\n\n## 结语\n\n学无止境","slug":"iis","published":1,"updated":"2019-05-15T09:17:27.608Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck550trlk000ahm62q6fhrdmm","content":"<p>IIS是Internet Information Services的缩写. 微软公司提供的基于运行Microsoft Windows的互联网基本服务. IIS是一种Web（网页）服务组件，其中包括Web服务器、FTP服务器、NNTP服务器和SMTP服务器，分别用于网页浏览、文件传输、新闻服务和邮件发送等方面，它使得在网络（包括互联网和局域网）上发布信息成了一件很容易的事.</p>\n<h2 id=\"IIS-服务器\"><a href=\"#IIS-服务器\" class=\"headerlink\" title=\"IIS 服务器\"></a>IIS 服务器</h2><p>IIS服务器是Windows自带的一个服务器, 默认是禁用的, 我们需要在 控制面板 -&gt; 程序与应用 中开启这个服务, 然后在管理工具中添加你的网站即可.</p>\n<h2 id=\"配置IIS服务\"><a href=\"#配置IIS服务\" class=\"headerlink\" title=\"配置IIS服务\"></a>配置IIS服务</h2><blockquote>\n<p>我以 windows 10 为例</p>\n</blockquote>\n<p>找到控制面板, 打开<strong>程序和功能</strong>, 点击左侧的<strong>启用和关闭windows功能</strong></p>\n<p><img src=\"/img/iis_01.png\" alt=\" \"></p>\n<p><img src=\"/../img/iis_02.png\" alt=\" \"></p>\n<p>如图所示, 勾选 <strong>Internet Information Service</strong> 选项, 会自动帮你选中子选项, 到这里一个简单的iis服务器就算启动了</p>\n<p><img src=\"/../img/iis_03.png\" alt=\" \"></p>\n<blockquote>\n<p><a href=\"http://localhost\" target=\"_blank\" rel=\"noopener\">浏览器输入(或点击这里)</a>就可以看到以下信息</p>\n</blockquote>\n<p><img src=\"/../img/iis_04.png\" alt=\" \"></p>\n<h2 id=\"管理你的网站\"><a href=\"#管理你的网站\" class=\"headerlink\" title=\"管理你的网站\"></a>管理你的网站</h2><h3 id=\"管理界面\"><a href=\"#管理界面\" class=\"headerlink\" title=\"管理界面\"></a>管理界面</h3><p>同样的在控制面板, 打开<strong>管理工具</strong>, 找到<strong>Internet Information Service(IIS)管理器</strong></p>\n<p><img src=\"/../img/iis_05.png\" alt=\" \"></p>\n<p>这个就是你的IIS服务器的管理界面</p>\n<h3 id=\"添加网站\"><a href=\"#添加网站\" class=\"headerlink\" title=\"添加网站\"></a>添加网站</h3><p>右键<strong>服务器</strong>/<strong>网站</strong>选择<strong>添加网站</strong>, 出现如下界面, 填写网站相关信息即可.</p>\n<p><img src=\"/../img/iis_06.png\" alt=\" \"></p>\n<p>我将本机的一个图片目录部署为一个网站, <em>图片服务器</em></p>\n<ol>\n<li>网站名称, 即你的网站名字.</li>\n<li>应用程序池, 默认即可, 深入的再探讨.</li>\n<li>物理路径, 就是你的项目所在路径</li>\n<li>绑定<ol>\n<li>类型 http/htts, 如果选择为 https 还需要配置证书</li>\n<li>IP地址段, 你可以在你局域网的IP段内自定义, 默认就是本机IP(localhost、127.0.0.1)</li>\n<li>端口不能重复, 这里我配置为 8001</li>\n</ol>\n</li>\n<li>主机名,就是你的域名, 默认不需要修改, 相应的修改需要配置 hosts 文件 (路径”C:\\Windows\\System32\\drivers\\etc\\hosts”)</li>\n</ol>\n<p>最后一步, 点击确认保存, 你可以看到:</p>\n<p><img src=\"/../img/iis_07.png\" alt=\" \"></p>\n<p>打开浏览器,输入 <a href=\"http://localhost:8001/1.jpg\" target=\"_blank\" rel=\"noopener\">localhost:8001/1.jpg</a>, 你可以看到:</p>\n<p><img src=\"/../img/iis_08.png\" alt=\" \"></p>\n<h2 id=\"结语\"><a href=\"#结语\" class=\"headerlink\" title=\"结语\"></a>结语</h2><p>学无止境</p>\n","site":{"data":{}},"excerpt":"","more":"<p>IIS是Internet Information Services的缩写. 微软公司提供的基于运行Microsoft Windows的互联网基本服务. IIS是一种Web（网页）服务组件，其中包括Web服务器、FTP服务器、NNTP服务器和SMTP服务器，分别用于网页浏览、文件传输、新闻服务和邮件发送等方面，它使得在网络（包括互联网和局域网）上发布信息成了一件很容易的事.</p>\n<h2 id=\"IIS-服务器\"><a href=\"#IIS-服务器\" class=\"headerlink\" title=\"IIS 服务器\"></a>IIS 服务器</h2><p>IIS服务器是Windows自带的一个服务器, 默认是禁用的, 我们需要在 控制面板 -&gt; 程序与应用 中开启这个服务, 然后在管理工具中添加你的网站即可.</p>\n<h2 id=\"配置IIS服务\"><a href=\"#配置IIS服务\" class=\"headerlink\" title=\"配置IIS服务\"></a>配置IIS服务</h2><blockquote>\n<p>我以 windows 10 为例</p>\n</blockquote>\n<p>找到控制面板, 打开<strong>程序和功能</strong>, 点击左侧的<strong>启用和关闭windows功能</strong></p>\n<p><img src=\"/img/iis_01.png\" alt=\" \"></p>\n<p><img src=\"/../img/iis_02.png\" alt=\" \"></p>\n<p>如图所示, 勾选 <strong>Internet Information Service</strong> 选项, 会自动帮你选中子选项, 到这里一个简单的iis服务器就算启动了</p>\n<p><img src=\"/../img/iis_03.png\" alt=\" \"></p>\n<blockquote>\n<p><a href=\"http://localhost\" target=\"_blank\" rel=\"noopener\">浏览器输入(或点击这里)</a>就可以看到以下信息</p>\n</blockquote>\n<p><img src=\"/../img/iis_04.png\" alt=\" \"></p>\n<h2 id=\"管理你的网站\"><a href=\"#管理你的网站\" class=\"headerlink\" title=\"管理你的网站\"></a>管理你的网站</h2><h3 id=\"管理界面\"><a href=\"#管理界面\" class=\"headerlink\" title=\"管理界面\"></a>管理界面</h3><p>同样的在控制面板, 打开<strong>管理工具</strong>, 找到<strong>Internet Information Service(IIS)管理器</strong></p>\n<p><img src=\"/../img/iis_05.png\" alt=\" \"></p>\n<p>这个就是你的IIS服务器的管理界面</p>\n<h3 id=\"添加网站\"><a href=\"#添加网站\" class=\"headerlink\" title=\"添加网站\"></a>添加网站</h3><p>右键<strong>服务器</strong>/<strong>网站</strong>选择<strong>添加网站</strong>, 出现如下界面, 填写网站相关信息即可.</p>\n<p><img src=\"/../img/iis_06.png\" alt=\" \"></p>\n<p>我将本机的一个图片目录部署为一个网站, <em>图片服务器</em></p>\n<ol>\n<li>网站名称, 即你的网站名字.</li>\n<li>应用程序池, 默认即可, 深入的再探讨.</li>\n<li>物理路径, 就是你的项目所在路径</li>\n<li>绑定<ol>\n<li>类型 http/htts, 如果选择为 https 还需要配置证书</li>\n<li>IP地址段, 你可以在你局域网的IP段内自定义, 默认就是本机IP(localhost、127.0.0.1)</li>\n<li>端口不能重复, 这里我配置为 8001</li>\n</ol>\n</li>\n<li>主机名,就是你的域名, 默认不需要修改, 相应的修改需要配置 hosts 文件 (路径”C:\\Windows\\System32\\drivers\\etc\\hosts”)</li>\n</ol>\n<p>最后一步, 点击确认保存, 你可以看到:</p>\n<p><img src=\"/../img/iis_07.png\" alt=\" \"></p>\n<p>打开浏览器,输入 <a href=\"http://localhost:8001/1.jpg\" target=\"_blank\" rel=\"noopener\">localhost:8001/1.jpg</a>, 你可以看到:</p>\n<p><img src=\"/../img/iis_08.png\" alt=\" \"></p>\n<h2 id=\"结语\"><a href=\"#结语\" class=\"headerlink\" title=\"结语\"></a>结语</h2><p>学无止境</p>\n"},{"title":"GraphQL 学习","date":"2019-10-22T08:52:00.000Z","_content":"\nGraphQL 既是一种用于 API 的查询语言也是一个满足你数据查询的运行时。 GraphQL 对你的 API 中的数据提供了一套易于理解的完整描述，使得客户端能够准确地获得它需要的数据，而且没有任何冗余，也让 API 更容易地随着时间推移而演进，还能用于构建强大的开发者工具。\n\n[官网文档](https://www.apollographql.com/docs/apollo-server)\n\n## 入门\n\n这里使用 nodejs 来创建demo, 使用到的npm包如下:\n\n1. fastify\n2. apollo-server-fastify\n\n### 定义GraphQL 模型\n\n```typescript\nimport { gql } from 'apollo-server-core';\n\nconst typeDefs = gql`\n    # 自定义 类型\n    scalar Date\n\n    # 自定义一个模型\n    type Book {\n        title: String\n        author: String\n        sex: String\n    }\n    ...\n\n    # 定义输入模型\n    input BookForm {\n        title: String!\n        author: String!\n        sex: String!\n    }\n\n    # Query 定义查询的方法\n    type Query {\n        # 查询所以 books 的方法\n        getBooks: [Book]\n    }\n\n    # Mutation 定义更新的方法\n    type Mutation {\n        addBook(book: BookForm): Boolean\n    }\n`\n```\n\n1. 自定义类型用 `scalar` 标注\n2. 自定义模型用 `type` 标注\n3. 输入模型用 `input` 标注 (与模型的唯一区别是 关键字不同)\n\n> Query 和 Mutation 是GraphQL内的两个特殊模型, 我们在这里定义 *查询* 和 *更新* 及返回类型, typeDefs中只能各存在一个.\n\n### 定义GraphQL的 resolver\n\n```typescript\n    const resolvers = {\n        Query: {\n            // Query中实现typeDefs中定义的查询\n            getBooks: (obj: any, args: any, context: any, info: any) => {\n                return [];\n            }\n        },\n        Mutation: {\n            // Mutation中实现typeDefs中定义的更新\n            addBook: (obj: any, args: any, context: any, info: any) => {\n                console.log('----> params', args['book'])\n                return true;\n            }\n        },\n        // 实现typeDefs中自定义的模型\n        Book: {\n            // 针对 单个属性定义\n            sex: (book:any, args: any, context: any, info: any) => {\n                return book.sex === 1 ? '男' : '女';\n            }\n        }\n        // ... 多个自定义模型\n    }\n```\n\n> 注意: resolver 中 Query和Mutation 只能有一个\n\n### 开始使用\n\n```typescript\nimport { ApolloServer } from 'apollo-server-fastify';\nimport * as fastify from 'fastify';\n\nconst gqlserver =  new ApolloServer({\n    typeDefs,\n    resolvers\n})\n\nfast.register(gqlserver.createHandler());\n\nfast.listen(3000, '0.0.0.0', async (err, address) => {\n    if (err) {\n        fast.log.error(err, address);\n    } else {\n        console.info(`service start success > ${address}`);\n    }\n})\n```\n\n## 参考链接\n\n[](http://www.zhaiqianfeng.com/2017/06/learn-graphql-first-demo.html)\n\n[](http://www.zhaiqianfeng.com/2017/06/learn-graphql-type-system.html)\n\n[](http://www.zhaiqianfeng.com/2017/06/learn-graphql-action-by-javascript.html)\n","source":"_posts/graphql.md","raw":"---\ntitle: GraphQL 学习\ndate: 2019-10-22 16:52:00\ntags: API\n---\n\nGraphQL 既是一种用于 API 的查询语言也是一个满足你数据查询的运行时。 GraphQL 对你的 API 中的数据提供了一套易于理解的完整描述，使得客户端能够准确地获得它需要的数据，而且没有任何冗余，也让 API 更容易地随着时间推移而演进，还能用于构建强大的开发者工具。\n\n[官网文档](https://www.apollographql.com/docs/apollo-server)\n\n## 入门\n\n这里使用 nodejs 来创建demo, 使用到的npm包如下:\n\n1. fastify\n2. apollo-server-fastify\n\n### 定义GraphQL 模型\n\n```typescript\nimport { gql } from 'apollo-server-core';\n\nconst typeDefs = gql`\n    # 自定义 类型\n    scalar Date\n\n    # 自定义一个模型\n    type Book {\n        title: String\n        author: String\n        sex: String\n    }\n    ...\n\n    # 定义输入模型\n    input BookForm {\n        title: String!\n        author: String!\n        sex: String!\n    }\n\n    # Query 定义查询的方法\n    type Query {\n        # 查询所以 books 的方法\n        getBooks: [Book]\n    }\n\n    # Mutation 定义更新的方法\n    type Mutation {\n        addBook(book: BookForm): Boolean\n    }\n`\n```\n\n1. 自定义类型用 `scalar` 标注\n2. 自定义模型用 `type` 标注\n3. 输入模型用 `input` 标注 (与模型的唯一区别是 关键字不同)\n\n> Query 和 Mutation 是GraphQL内的两个特殊模型, 我们在这里定义 *查询* 和 *更新* 及返回类型, typeDefs中只能各存在一个.\n\n### 定义GraphQL的 resolver\n\n```typescript\n    const resolvers = {\n        Query: {\n            // Query中实现typeDefs中定义的查询\n            getBooks: (obj: any, args: any, context: any, info: any) => {\n                return [];\n            }\n        },\n        Mutation: {\n            // Mutation中实现typeDefs中定义的更新\n            addBook: (obj: any, args: any, context: any, info: any) => {\n                console.log('----> params', args['book'])\n                return true;\n            }\n        },\n        // 实现typeDefs中自定义的模型\n        Book: {\n            // 针对 单个属性定义\n            sex: (book:any, args: any, context: any, info: any) => {\n                return book.sex === 1 ? '男' : '女';\n            }\n        }\n        // ... 多个自定义模型\n    }\n```\n\n> 注意: resolver 中 Query和Mutation 只能有一个\n\n### 开始使用\n\n```typescript\nimport { ApolloServer } from 'apollo-server-fastify';\nimport * as fastify from 'fastify';\n\nconst gqlserver =  new ApolloServer({\n    typeDefs,\n    resolvers\n})\n\nfast.register(gqlserver.createHandler());\n\nfast.listen(3000, '0.0.0.0', async (err, address) => {\n    if (err) {\n        fast.log.error(err, address);\n    } else {\n        console.info(`service start success > ${address}`);\n    }\n})\n```\n\n## 参考链接\n\n[](http://www.zhaiqianfeng.com/2017/06/learn-graphql-first-demo.html)\n\n[](http://www.zhaiqianfeng.com/2017/06/learn-graphql-type-system.html)\n\n[](http://www.zhaiqianfeng.com/2017/06/learn-graphql-action-by-javascript.html)\n","slug":"graphql","published":1,"updated":"2019-12-31T11:06:54.287Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck550trlm000dhm62j5q97729","content":"<p>GraphQL 既是一种用于 API 的查询语言也是一个满足你数据查询的运行时。 GraphQL 对你的 API 中的数据提供了一套易于理解的完整描述，使得客户端能够准确地获得它需要的数据，而且没有任何冗余，也让 API 更容易地随着时间推移而演进，还能用于构建强大的开发者工具。</p>\n<p><a href=\"https://www.apollographql.com/docs/apollo-server\" target=\"_blank\" rel=\"noopener\">官网文档</a></p>\n<h2 id=\"入门\"><a href=\"#入门\" class=\"headerlink\" title=\"入门\"></a>入门</h2><p>这里使用 nodejs 来创建demo, 使用到的npm包如下:</p>\n<ol>\n<li>fastify</li>\n<li>apollo-server-fastify</li>\n</ol>\n<h3 id=\"定义GraphQL-模型\"><a href=\"#定义GraphQL-模型\" class=\"headerlink\" title=\"定义GraphQL 模型\"></a>定义GraphQL 模型</h3><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; gql &#125; <span class=\"keyword\">from</span> <span class=\"string\">'apollo-server-core'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> typeDefs = gql<span class=\"string\">`</span></span><br><span class=\"line\"><span class=\"string\">    # 自定义 类型</span></span><br><span class=\"line\"><span class=\"string\">    scalar Date</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    # 自定义一个模型</span></span><br><span class=\"line\"><span class=\"string\">    type Book &#123;</span></span><br><span class=\"line\"><span class=\"string\">        title: String</span></span><br><span class=\"line\"><span class=\"string\">        author: String</span></span><br><span class=\"line\"><span class=\"string\">        sex: String</span></span><br><span class=\"line\"><span class=\"string\">    &#125;</span></span><br><span class=\"line\"><span class=\"string\">    ...</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    # 定义输入模型</span></span><br><span class=\"line\"><span class=\"string\">    input BookForm &#123;</span></span><br><span class=\"line\"><span class=\"string\">        title: String!</span></span><br><span class=\"line\"><span class=\"string\">        author: String!</span></span><br><span class=\"line\"><span class=\"string\">        sex: String!</span></span><br><span class=\"line\"><span class=\"string\">    &#125;</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    # Query 定义查询的方法</span></span><br><span class=\"line\"><span class=\"string\">    type Query &#123;</span></span><br><span class=\"line\"><span class=\"string\">        # 查询所以 books 的方法</span></span><br><span class=\"line\"><span class=\"string\">        getBooks: [Book]</span></span><br><span class=\"line\"><span class=\"string\">    &#125;</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    # Mutation 定义更新的方法</span></span><br><span class=\"line\"><span class=\"string\">    type Mutation &#123;</span></span><br><span class=\"line\"><span class=\"string\">        addBook(book: BookForm): Boolean</span></span><br><span class=\"line\"><span class=\"string\">    &#125;</span></span><br><span class=\"line\"><span class=\"string\">`</span></span><br></pre></td></tr></table></figure>\n<ol>\n<li>自定义类型用 <code>scalar</code> 标注</li>\n<li>自定义模型用 <code>type</code> 标注</li>\n<li>输入模型用 <code>input</code> 标注 (与模型的唯一区别是 关键字不同)</li>\n</ol>\n<blockquote>\n<p>Query 和 Mutation 是GraphQL内的两个特殊模型, 我们在这里定义 <em>查询</em> 和 <em>更新</em> 及返回类型, typeDefs中只能各存在一个.</p>\n</blockquote>\n<h3 id=\"定义GraphQL的-resolver\"><a href=\"#定义GraphQL的-resolver\" class=\"headerlink\" title=\"定义GraphQL的 resolver\"></a>定义GraphQL的 resolver</h3><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> resolvers = &#123;</span><br><span class=\"line\">    Query: &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Query中实现typeDefs中定义的查询</span></span><br><span class=\"line\">        getBooks: <span class=\"function\">(<span class=\"params\">obj: <span class=\"built_in\">any</span>, args: <span class=\"built_in\">any</span>, context: <span class=\"built_in\">any</span>, info: <span class=\"built_in\">any</span></span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> [];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    Mutation: &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Mutation中实现typeDefs中定义的更新</span></span><br><span class=\"line\">        addBook: <span class=\"function\">(<span class=\"params\">obj: <span class=\"built_in\">any</span>, args: <span class=\"built_in\">any</span>, context: <span class=\"built_in\">any</span>, info: <span class=\"built_in\">any</span></span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">console</span>.log(<span class=\"string\">'----&gt; params'</span>, args[<span class=\"string\">'book'</span>])</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"comment\">// 实现typeDefs中自定义的模型</span></span><br><span class=\"line\">    Book: &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 针对 单个属性定义</span></span><br><span class=\"line\">        sex: <span class=\"function\">(<span class=\"params\">book:<span class=\"built_in\">any</span>, args: <span class=\"built_in\">any</span>, context: <span class=\"built_in\">any</span>, info: <span class=\"built_in\">any</span></span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> book.sex === <span class=\"number\">1</span> ? <span class=\"string\">'男'</span> : <span class=\"string\">'女'</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// ... 多个自定义模型</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>注意: resolver 中 Query和Mutation 只能有一个</p>\n</blockquote>\n<h3 id=\"开始使用\"><a href=\"#开始使用\" class=\"headerlink\" title=\"开始使用\"></a>开始使用</h3><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; ApolloServer &#125; <span class=\"keyword\">from</span> <span class=\"string\">'apollo-server-fastify'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> * <span class=\"keyword\">as</span> fastify <span class=\"keyword\">from</span> <span class=\"string\">'fastify'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> gqlserver =  <span class=\"keyword\">new</span> ApolloServer(&#123;</span><br><span class=\"line\">    typeDefs,</span><br><span class=\"line\">    resolvers</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">fast.register(gqlserver.createHandler());</span><br><span class=\"line\"></span><br><span class=\"line\">fast.listen(<span class=\"number\">3000</span>, <span class=\"string\">'0.0.0.0'</span>, <span class=\"keyword\">async</span> (err, address) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (err) &#123;</span><br><span class=\"line\">        fast.log.error(err, address);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.info(<span class=\"string\">`service start success &gt; <span class=\"subst\">$&#123;address&#125;</span>`</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<h2 id=\"参考链接\"><a href=\"#参考链接\" class=\"headerlink\" title=\"参考链接\"></a>参考链接</h2><p><a href=\"http://www.zhaiqianfeng.com/2017/06/learn-graphql-first-demo.html\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p><a href=\"http://www.zhaiqianfeng.com/2017/06/learn-graphql-type-system.html\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p><a href=\"http://www.zhaiqianfeng.com/2017/06/learn-graphql-action-by-javascript.html\" target=\"_blank\" rel=\"noopener\"></a></p>\n","site":{"data":{}},"excerpt":"","more":"<p>GraphQL 既是一种用于 API 的查询语言也是一个满足你数据查询的运行时。 GraphQL 对你的 API 中的数据提供了一套易于理解的完整描述，使得客户端能够准确地获得它需要的数据，而且没有任何冗余，也让 API 更容易地随着时间推移而演进，还能用于构建强大的开发者工具。</p>\n<p><a href=\"https://www.apollographql.com/docs/apollo-server\" target=\"_blank\" rel=\"noopener\">官网文档</a></p>\n<h2 id=\"入门\"><a href=\"#入门\" class=\"headerlink\" title=\"入门\"></a>入门</h2><p>这里使用 nodejs 来创建demo, 使用到的npm包如下:</p>\n<ol>\n<li>fastify</li>\n<li>apollo-server-fastify</li>\n</ol>\n<h3 id=\"定义GraphQL-模型\"><a href=\"#定义GraphQL-模型\" class=\"headerlink\" title=\"定义GraphQL 模型\"></a>定义GraphQL 模型</h3><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; gql &#125; <span class=\"keyword\">from</span> <span class=\"string\">'apollo-server-core'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> typeDefs = gql<span class=\"string\">`</span></span><br><span class=\"line\"><span class=\"string\">    # 自定义 类型</span></span><br><span class=\"line\"><span class=\"string\">    scalar Date</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    # 自定义一个模型</span></span><br><span class=\"line\"><span class=\"string\">    type Book &#123;</span></span><br><span class=\"line\"><span class=\"string\">        title: String</span></span><br><span class=\"line\"><span class=\"string\">        author: String</span></span><br><span class=\"line\"><span class=\"string\">        sex: String</span></span><br><span class=\"line\"><span class=\"string\">    &#125;</span></span><br><span class=\"line\"><span class=\"string\">    ...</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    # 定义输入模型</span></span><br><span class=\"line\"><span class=\"string\">    input BookForm &#123;</span></span><br><span class=\"line\"><span class=\"string\">        title: String!</span></span><br><span class=\"line\"><span class=\"string\">        author: String!</span></span><br><span class=\"line\"><span class=\"string\">        sex: String!</span></span><br><span class=\"line\"><span class=\"string\">    &#125;</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    # Query 定义查询的方法</span></span><br><span class=\"line\"><span class=\"string\">    type Query &#123;</span></span><br><span class=\"line\"><span class=\"string\">        # 查询所以 books 的方法</span></span><br><span class=\"line\"><span class=\"string\">        getBooks: [Book]</span></span><br><span class=\"line\"><span class=\"string\">    &#125;</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">    # Mutation 定义更新的方法</span></span><br><span class=\"line\"><span class=\"string\">    type Mutation &#123;</span></span><br><span class=\"line\"><span class=\"string\">        addBook(book: BookForm): Boolean</span></span><br><span class=\"line\"><span class=\"string\">    &#125;</span></span><br><span class=\"line\"><span class=\"string\">`</span></span><br></pre></td></tr></table></figure>\n<ol>\n<li>自定义类型用 <code>scalar</code> 标注</li>\n<li>自定义模型用 <code>type</code> 标注</li>\n<li>输入模型用 <code>input</code> 标注 (与模型的唯一区别是 关键字不同)</li>\n</ol>\n<blockquote>\n<p>Query 和 Mutation 是GraphQL内的两个特殊模型, 我们在这里定义 <em>查询</em> 和 <em>更新</em> 及返回类型, typeDefs中只能各存在一个.</p>\n</blockquote>\n<h3 id=\"定义GraphQL的-resolver\"><a href=\"#定义GraphQL的-resolver\" class=\"headerlink\" title=\"定义GraphQL的 resolver\"></a>定义GraphQL的 resolver</h3><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> resolvers = &#123;</span><br><span class=\"line\">    Query: &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Query中实现typeDefs中定义的查询</span></span><br><span class=\"line\">        getBooks: <span class=\"function\">(<span class=\"params\">obj: <span class=\"built_in\">any</span>, args: <span class=\"built_in\">any</span>, context: <span class=\"built_in\">any</span>, info: <span class=\"built_in\">any</span></span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> [];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    Mutation: &#123;</span><br><span class=\"line\">        <span class=\"comment\">// Mutation中实现typeDefs中定义的更新</span></span><br><span class=\"line\">        addBook: <span class=\"function\">(<span class=\"params\">obj: <span class=\"built_in\">any</span>, args: <span class=\"built_in\">any</span>, context: <span class=\"built_in\">any</span>, info: <span class=\"built_in\">any</span></span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"built_in\">console</span>.log(<span class=\"string\">'----&gt; params'</span>, args[<span class=\"string\">'book'</span>])</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">true</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"comment\">// 实现typeDefs中自定义的模型</span></span><br><span class=\"line\">    Book: &#123;</span><br><span class=\"line\">        <span class=\"comment\">// 针对 单个属性定义</span></span><br><span class=\"line\">        sex: <span class=\"function\">(<span class=\"params\">book:<span class=\"built_in\">any</span>, args: <span class=\"built_in\">any</span>, context: <span class=\"built_in\">any</span>, info: <span class=\"built_in\">any</span></span>) =&gt;</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">return</span> book.sex === <span class=\"number\">1</span> ? <span class=\"string\">'男'</span> : <span class=\"string\">'女'</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// ... 多个自定义模型</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>注意: resolver 中 Query和Mutation 只能有一个</p>\n</blockquote>\n<h3 id=\"开始使用\"><a href=\"#开始使用\" class=\"headerlink\" title=\"开始使用\"></a>开始使用</h3><figure class=\"highlight typescript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> &#123; ApolloServer &#125; <span class=\"keyword\">from</span> <span class=\"string\">'apollo-server-fastify'</span>;</span><br><span class=\"line\"><span class=\"keyword\">import</span> * <span class=\"keyword\">as</span> fastify <span class=\"keyword\">from</span> <span class=\"string\">'fastify'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">const</span> gqlserver =  <span class=\"keyword\">new</span> ApolloServer(&#123;</span><br><span class=\"line\">    typeDefs,</span><br><span class=\"line\">    resolvers</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">fast.register(gqlserver.createHandler());</span><br><span class=\"line\"></span><br><span class=\"line\">fast.listen(<span class=\"number\">3000</span>, <span class=\"string\">'0.0.0.0'</span>, <span class=\"keyword\">async</span> (err, address) =&gt; &#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (err) &#123;</span><br><span class=\"line\">        fast.log.error(err, address);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"built_in\">console</span>.info(<span class=\"string\">`service start success &gt; <span class=\"subst\">$&#123;address&#125;</span>`</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<h2 id=\"参考链接\"><a href=\"#参考链接\" class=\"headerlink\" title=\"参考链接\"></a>参考链接</h2><p><a href=\"http://www.zhaiqianfeng.com/2017/06/learn-graphql-first-demo.html\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p><a href=\"http://www.zhaiqianfeng.com/2017/06/learn-graphql-type-system.html\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p><a href=\"http://www.zhaiqianfeng.com/2017/06/learn-graphql-action-by-javascript.html\" target=\"_blank\" rel=\"noopener\"></a></p>\n"},{"title":"Markdown学习","date":"2019-04-26T07:18:49.000Z","_content":"\n这个网站都是所有的文章都是使用 Markdown 编写的,所以我们有必要了解一下 Markdown 的基本语法\n\n## 我们需要了解的\n\n1. Markdown 是什么\n2. 为什么要用 Markdown\n3. 怎么使用 Markdown 基本语法\n4. 总结\n\n### 什么是 Markdown\n\n* Markdown 是一个简单的标记语言,通过**简单的**几个标记使得普通文本文字具有一定的格式,用来写博客再好不过了.\n\n### 为什么要用 Markdown\n\n* **上手快**,语法简单 只需要记住几个符号就能上手了.\n* Markdwon 有着 易读、易写、易更改 等特点\n* Markdwon 最终是被编译成 HTML 代码执行的\n\n### Markdown 的基本语法\n\n#### 标题标签 (#、=、-)\n\n>两种形式:使用 # 符号代表1-6级标题标签, **个数**为级别;  使用 =、- 代表 一、二级标签\n\n```\n# 一级标题<h1>\n## 二级标题 <h2>\n### 三级标题 <h3>\n#### 四级标题 <h4>\n##### 五级标题 <h5>\n```\n\n#### 段落标签 (>)\n\n> 段落(引用)标签 符号与内容之间要有空格, 单个为主,内嵌几层就打几个 **>**    (ps:貌似可以一致打下去)\n>> 内嵌1     >> 内嵌1\n>>> 内嵌2    >>> 内嵌2\n>>>> 内嵌3   >>>> 内嵌3\n\n#### 字体属性\n\n```\n* **字体加粗**  给字体加粗,在字体左右各加两个 *\n* *斜体字*  使文字倾斜,在文字左右各加一个 *\n* ***斜体加粗***  要使文字加粗、倾斜,在文字左右各加三个 *\n* ~~加删除线的文字~~ 左右各 两个 ~\n```\n\n* **字体加粗**  给字体加粗,在字体左右各加两个 *\n* *斜体字*  使文字倾斜,在文字左右各加一个 *\n* ***斜体加粗***  要使文字加粗、倾斜,在文字左右各加三个 *\n* ~~加删除线的文字~~ 左右各 两个 ~\n\n#### 分割线 (-、*)\n\n> 三个(-、*)及三个以上符号即可\n\n效果如下:\n\n```\n---\n***\n* * *\n```\n\n符号(-)分割线\n\n---\n\n符号(*)分割线\n\n******\n\n#### 图片\n\n基本语法\n\n```sh\n![图片语法](https://images.jzwyz.com/blog/tpurl.png \"这是对图片语法的说明图\")\n![图片alt](https://images.jzwyz.com/blog/1.jpg \"图片title\")\n![链接语法](https://images.jzwyz.com/blog/urlsm.png \"链接语法说明\")\n```\n\n效果:\n\n![图片语法](https://images.jzwyz.com/blog/tpurl.png \"这是对图片语法的说明图\")\n\n![图片alt](https://images.jzwyz.com/blog/1.jpg \"图片title\")\n\n![链接语法](https://images.jzwyz.com/blog/urlsm.png \"链接语法说明\")\n\n> 图片alt 显示在图片下方\n> 图片title 就是图片描述,当鼠标移到图片上时显示的内容。title可加可不加 title与url之间以 空格 隔开\n\n#### 链接\n\n与图片语法类似, 开始 不要 ! 符号\n\n```sh\n[百度](https://www.baidu.com \"百度一下\")\n[Github](https://www.github.com \"去Github\")\n```\n\n[百度](https://www.baidu.com \"百度一下\")\n\n[Github](https://www.github.com \"去Github\")\n\n#### 列表\n\n```md\n1. 有序列表\n2. 有序列表\n3. 有序列表\n\n* 无序列表 *\n  + 无序列表 +\n    - 无序列表 -\n  + 无序列白\n* 无序列表\n```\n\n效果:\n\n1. 有序列表\n2. 有序列表\n3. 有序列表\n\n* 无序列表 *\n  + 无序列表 +\n    - 无序列表 -\n  + 无序列白\n* 无序列表\n\n> 列表 分为无序和有序,其语法区别就是 有序列表以**数字.**为符号 序号和内容之间空格分开\n\n> 无序列表 有 (*、+、-) 三个符号, 使用多个时,最顶层应使用 *,次级使用 +,再次级使用 -\n\n> 列表嵌套 下级与上级换行,缩进三个空格\n\n#### 表格\n\n示列 md 代码:\n\n```sh\n列名|列名|列名\n--|:-:|:--—\n内容|内|内容呀\n```\n\n第一行 | 符号分格列名\n\n第二行 - 代码该列中一个字符,一般设置为该列最长字符数量, : 放在 - 哪边就表示 该列字段向:对齐, | 符号分隔列\n  \n再往下,就是每列的数据列\n\n编号|姓名|性别|年龄\n--:|:---:|-:|:--\n01|小明|男|12\n02|小小红|女|15\n\n#### 代码块语法\n\n效果如下:\n\n```sh\n 这是代码块\n```\n\n`这是代码行`\n\n```bash\n# 指定 语言\ndocker run -d --rm -v ~/../workspace/my-blog/source:/app/source --network=app-bridge --name=webblog myblog:1.0\n```\n\n```node\nnode --version\n```\n\n![代码块语法](https://images.jzwyz.com/blog/dmkyf.png \"代码块语法\")","source":"_posts/markdown.md","raw":"---\ntitle: Markdown学习\ndate: 2019-04-26 15:18:49\ntags: 基础\n---\n\n这个网站都是所有的文章都是使用 Markdown 编写的,所以我们有必要了解一下 Markdown 的基本语法\n\n## 我们需要了解的\n\n1. Markdown 是什么\n2. 为什么要用 Markdown\n3. 怎么使用 Markdown 基本语法\n4. 总结\n\n### 什么是 Markdown\n\n* Markdown 是一个简单的标记语言,通过**简单的**几个标记使得普通文本文字具有一定的格式,用来写博客再好不过了.\n\n### 为什么要用 Markdown\n\n* **上手快**,语法简单 只需要记住几个符号就能上手了.\n* Markdwon 有着 易读、易写、易更改 等特点\n* Markdwon 最终是被编译成 HTML 代码执行的\n\n### Markdown 的基本语法\n\n#### 标题标签 (#、=、-)\n\n>两种形式:使用 # 符号代表1-6级标题标签, **个数**为级别;  使用 =、- 代表 一、二级标签\n\n```\n# 一级标题<h1>\n## 二级标题 <h2>\n### 三级标题 <h3>\n#### 四级标题 <h4>\n##### 五级标题 <h5>\n```\n\n#### 段落标签 (>)\n\n> 段落(引用)标签 符号与内容之间要有空格, 单个为主,内嵌几层就打几个 **>**    (ps:貌似可以一致打下去)\n>> 内嵌1     >> 内嵌1\n>>> 内嵌2    >>> 内嵌2\n>>>> 内嵌3   >>>> 内嵌3\n\n#### 字体属性\n\n```\n* **字体加粗**  给字体加粗,在字体左右各加两个 *\n* *斜体字*  使文字倾斜,在文字左右各加一个 *\n* ***斜体加粗***  要使文字加粗、倾斜,在文字左右各加三个 *\n* ~~加删除线的文字~~ 左右各 两个 ~\n```\n\n* **字体加粗**  给字体加粗,在字体左右各加两个 *\n* *斜体字*  使文字倾斜,在文字左右各加一个 *\n* ***斜体加粗***  要使文字加粗、倾斜,在文字左右各加三个 *\n* ~~加删除线的文字~~ 左右各 两个 ~\n\n#### 分割线 (-、*)\n\n> 三个(-、*)及三个以上符号即可\n\n效果如下:\n\n```\n---\n***\n* * *\n```\n\n符号(-)分割线\n\n---\n\n符号(*)分割线\n\n******\n\n#### 图片\n\n基本语法\n\n```sh\n![图片语法](https://images.jzwyz.com/blog/tpurl.png \"这是对图片语法的说明图\")\n![图片alt](https://images.jzwyz.com/blog/1.jpg \"图片title\")\n![链接语法](https://images.jzwyz.com/blog/urlsm.png \"链接语法说明\")\n```\n\n效果:\n\n![图片语法](https://images.jzwyz.com/blog/tpurl.png \"这是对图片语法的说明图\")\n\n![图片alt](https://images.jzwyz.com/blog/1.jpg \"图片title\")\n\n![链接语法](https://images.jzwyz.com/blog/urlsm.png \"链接语法说明\")\n\n> 图片alt 显示在图片下方\n> 图片title 就是图片描述,当鼠标移到图片上时显示的内容。title可加可不加 title与url之间以 空格 隔开\n\n#### 链接\n\n与图片语法类似, 开始 不要 ! 符号\n\n```sh\n[百度](https://www.baidu.com \"百度一下\")\n[Github](https://www.github.com \"去Github\")\n```\n\n[百度](https://www.baidu.com \"百度一下\")\n\n[Github](https://www.github.com \"去Github\")\n\n#### 列表\n\n```md\n1. 有序列表\n2. 有序列表\n3. 有序列表\n\n* 无序列表 *\n  + 无序列表 +\n    - 无序列表 -\n  + 无序列白\n* 无序列表\n```\n\n效果:\n\n1. 有序列表\n2. 有序列表\n3. 有序列表\n\n* 无序列表 *\n  + 无序列表 +\n    - 无序列表 -\n  + 无序列白\n* 无序列表\n\n> 列表 分为无序和有序,其语法区别就是 有序列表以**数字.**为符号 序号和内容之间空格分开\n\n> 无序列表 有 (*、+、-) 三个符号, 使用多个时,最顶层应使用 *,次级使用 +,再次级使用 -\n\n> 列表嵌套 下级与上级换行,缩进三个空格\n\n#### 表格\n\n示列 md 代码:\n\n```sh\n列名|列名|列名\n--|:-:|:--—\n内容|内|内容呀\n```\n\n第一行 | 符号分格列名\n\n第二行 - 代码该列中一个字符,一般设置为该列最长字符数量, : 放在 - 哪边就表示 该列字段向:对齐, | 符号分隔列\n  \n再往下,就是每列的数据列\n\n编号|姓名|性别|年龄\n--:|:---:|-:|:--\n01|小明|男|12\n02|小小红|女|15\n\n#### 代码块语法\n\n效果如下:\n\n```sh\n 这是代码块\n```\n\n`这是代码行`\n\n```bash\n# 指定 语言\ndocker run -d --rm -v ~/../workspace/my-blog/source:/app/source --network=app-bridge --name=webblog myblog:1.0\n```\n\n```node\nnode --version\n```\n\n![代码块语法](https://images.jzwyz.com/blog/dmkyf.png \"代码块语法\")","slug":"markdown","published":1,"updated":"2019-06-18T07:30:12.814Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck550trlo000ehm62hexrse46","content":"<p>这个网站都是所有的文章都是使用 Markdown 编写的,所以我们有必要了解一下 Markdown 的基本语法</p>\n<h2 id=\"我们需要了解的\"><a href=\"#我们需要了解的\" class=\"headerlink\" title=\"我们需要了解的\"></a>我们需要了解的</h2><ol>\n<li>Markdown 是什么</li>\n<li>为什么要用 Markdown</li>\n<li>怎么使用 Markdown 基本语法</li>\n<li>总结</li>\n</ol>\n<h3 id=\"什么是-Markdown\"><a href=\"#什么是-Markdown\" class=\"headerlink\" title=\"什么是 Markdown\"></a>什么是 Markdown</h3><ul>\n<li>Markdown 是一个简单的标记语言,通过<strong>简单的</strong>几个标记使得普通文本文字具有一定的格式,用来写博客再好不过了.</li>\n</ul>\n<h3 id=\"为什么要用-Markdown\"><a href=\"#为什么要用-Markdown\" class=\"headerlink\" title=\"为什么要用 Markdown\"></a>为什么要用 Markdown</h3><ul>\n<li><strong>上手快</strong>,语法简单 只需要记住几个符号就能上手了.</li>\n<li>Markdwon 有着 易读、易写、易更改 等特点</li>\n<li>Markdwon 最终是被编译成 HTML 代码执行的</li>\n</ul>\n<h3 id=\"Markdown-的基本语法\"><a href=\"#Markdown-的基本语法\" class=\"headerlink\" title=\"Markdown 的基本语法\"></a>Markdown 的基本语法</h3><h4 id=\"标题标签-、-、\"><a href=\"#标题标签-、-、\" class=\"headerlink\" title=\"标题标签 (#、=、-)\"></a>标题标签 (#、=、-)</h4><blockquote>\n<p>两种形式:使用 # 符号代表1-6级标题标签, <strong>个数</strong>为级别;  使用 =、- 代表 一、二级标签</p>\n</blockquote>\n<figure class=\"highlight clean\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 一级标题&lt;h1&gt;</span><br><span class=\"line\">## 二级标题 &lt;h2&gt;</span><br><span class=\"line\">### 三级标题 &lt;h3&gt;</span><br><span class=\"line\">#### 四级标题 &lt;h4&gt;</span><br><span class=\"line\">##### 五级标题 &lt;h5&gt;</span><br></pre></td></tr></table></figure>\n<h4 id=\"段落标签-gt\"><a href=\"#段落标签-gt\" class=\"headerlink\" title=\"段落标签 (&gt;)\"></a>段落标签 (&gt;)</h4><blockquote>\n<p>段落(引用)标签 符号与内容之间要有空格, 单个为主,内嵌几层就打几个 <strong>&gt;</strong>    (ps:貌似可以一致打下去)</p>\n<blockquote>\n<p>内嵌1     &gt;&gt; 内嵌1</p>\n<blockquote>\n<p>内嵌2    &gt;&gt;&gt; 内嵌2</p>\n<blockquote>\n<p>内嵌3   &gt;&gt;&gt;&gt; 内嵌3</p>\n</blockquote>\n</blockquote>\n</blockquote>\n</blockquote>\n<h4 id=\"字体属性\"><a href=\"#字体属性\" class=\"headerlink\" title=\"字体属性\"></a>字体属性</h4><figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"bullet\">* </span><span class=\"strong\">**字体加粗**</span>  给字体加粗,在字体左右各加两个 *</span><br><span class=\"line\"><span class=\"bullet\">* </span><span class=\"emphasis\">*斜体字*</span>  使文字倾斜,在文字左右各加一个 *</span><br><span class=\"line\"><span class=\"bullet\">* </span><span class=\"strong\">***斜体加粗**</span><span class=\"bullet\">*  要使文字加粗、倾斜,在文字左右各加三个 *</span></span><br><span class=\"line\"><span class=\"bullet\">* </span>~~加删除线的文字~~ 左右各 两个 ~</span><br></pre></td></tr></table></figure>\n<ul>\n<li><strong>字体加粗</strong>  给字体加粗,在字体左右各加两个 *</li>\n<li><em>斜体字</em>  使文字倾斜,在文字左右各加一个 *</li>\n<li><strong><em>斜体加粗</em></strong>  要使文字加粗、倾斜,在文字左右各加三个 *</li>\n<li><del>加删除线的文字</del> 左右各 两个 ~</li>\n</ul>\n<h4 id=\"分割线-、\"><a href=\"#分割线-、\" class=\"headerlink\" title=\"分割线 (-、*)\"></a>分割线 (-、*)</h4><blockquote>\n<p>三个(-、*)及三个以上符号即可</p>\n</blockquote>\n<p>效果如下:</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"string\">***</span></span><br><span class=\"line\"><span class=\"string\">*</span> <span class=\"string\">*</span> <span class=\"string\">*</span></span><br></pre></td></tr></table></figure>\n<p>符号(-)分割线</p>\n<hr>\n<p>符号(*)分割线</p>\n<hr>\n<h4 id=\"图片\"><a href=\"#图片\" class=\"headerlink\" title=\"图片\"></a>图片</h4><p>基本语法</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">![图片语法](https://images.jzwyz.com/blog/tpurl.png <span class=\"string\">\"这是对图片语法的说明图\"</span>)</span><br><span class=\"line\">![图片alt](https://images.jzwyz.com/blog/1.jpg <span class=\"string\">\"图片title\"</span>)</span><br><span class=\"line\">![链接语法](https://images.jzwyz.com/blog/urlsm.png <span class=\"string\">\"链接语法说明\"</span>)</span><br></pre></td></tr></table></figure>\n<p>效果:</p>\n<p><img src=\"https://images.jzwyz.com/blog/tpurl.png\" alt=\"图片语法\" title=\"这是对图片语法的说明图\"></p>\n<p><img src=\"https://images.jzwyz.com/blog/1.jpg\" alt=\"图片alt\" title=\"图片title\"></p>\n<p><img src=\"https://images.jzwyz.com/blog/urlsm.png\" alt=\"链接语法\" title=\"链接语法说明\"></p>\n<blockquote>\n<p>图片alt 显示在图片下方<br>图片title 就是图片描述,当鼠标移到图片上时显示的内容。title可加可不加 title与url之间以 空格 隔开</p>\n</blockquote>\n<h4 id=\"链接\"><a href=\"#链接\" class=\"headerlink\" title=\"链接\"></a>链接</h4><p>与图片语法类似, 开始 不要 ! 符号</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[百度](https://www.baidu.com <span class=\"string\">\"百度一下\"</span>)</span><br><span class=\"line\">[Github](https://www.github.com <span class=\"string\">\"去Github\"</span>)</span><br></pre></td></tr></table></figure>\n<p><a href=\"https://www.baidu.com\" title=\"百度一下\" target=\"_blank\" rel=\"noopener\">百度</a></p>\n<p><a href=\"https://www.github.com\" title=\"去Github\" target=\"_blank\" rel=\"noopener\">Github</a></p>\n<h4 id=\"列表\"><a href=\"#列表\" class=\"headerlink\" title=\"列表\"></a>列表</h4><figure class=\"highlight md\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"bullet\">1. </span>有序列表</span><br><span class=\"line\"><span class=\"bullet\">2. </span>有序列表</span><br><span class=\"line\"><span class=\"bullet\">3. </span>有序列表</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"bullet\">* </span>无序列表 *</span><br><span class=\"line\">  + 无序列表 +</span><br><span class=\"line\"><span class=\"code\">    - 无序列表 -</span></span><br><span class=\"line\">  + 无序列白</span><br><span class=\"line\"><span class=\"bullet\">* </span>无序列表</span><br></pre></td></tr></table></figure>\n<p>效果:</p>\n<ol>\n<li>有序列表</li>\n<li>有序列表</li>\n<li>有序列表</li>\n</ol>\n<ul>\n<li>无序列表 *<ul>\n<li>无序列表 +<ul>\n<li>无序列表 -</li>\n</ul>\n</li>\n<li>无序列白</li>\n</ul>\n</li>\n<li>无序列表</li>\n</ul>\n<blockquote>\n<p>列表 分为无序和有序,其语法区别就是 有序列表以<strong>数字.</strong>为符号 序号和内容之间空格分开</p>\n</blockquote>\n<blockquote>\n<p>无序列表 有 (<em>、+、-) 三个符号, 使用多个时,最顶层应使用 </em>,次级使用 +,再次级使用 -</p>\n</blockquote>\n<blockquote>\n<p>列表嵌套 下级与上级换行,缩进三个空格</p>\n</blockquote>\n<h4 id=\"表格\"><a href=\"#表格\" class=\"headerlink\" title=\"表格\"></a>表格</h4><p>示列 md 代码:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">列名|列名|列名</span><br><span class=\"line\">--|:-:|:--—</span><br><span class=\"line\">内容|内|内容呀</span><br></pre></td></tr></table></figure>\n<p>第一行 | 符号分格列名</p>\n<p>第二行 - 代码该列中一个字符,一般设置为该列最长字符数量, : 放在 - 哪边就表示 该列字段向:对齐, | 符号分隔列</p>\n<p>再往下,就是每列的数据列</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:right\">编号</th>\n<th style=\"text-align:center\">姓名</th>\n<th style=\"text-align:right\">性别</th>\n<th style=\"text-align:left\">年龄</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:right\">01</td>\n<td style=\"text-align:center\">小明</td>\n<td style=\"text-align:right\">男</td>\n<td style=\"text-align:left\">12</td>\n</tr>\n<tr>\n<td style=\"text-align:right\">02</td>\n<td style=\"text-align:center\">小小红</td>\n<td style=\"text-align:right\">女</td>\n<td style=\"text-align:left\">15</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"代码块语法\"><a href=\"#代码块语法\" class=\"headerlink\" title=\"代码块语法\"></a>代码块语法</h4><p>效果如下:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">这是代码块</span><br></pre></td></tr></table></figure>\n<p><code>这是代码行</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 指定 语言</span></span><br><span class=\"line\">docker run -d --rm -v ~/../workspace/my-blog/<span class=\"built_in\">source</span>:/app/<span class=\"built_in\">source</span> --network=app-bridge --name=webblog myblog:1.0</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">node --version</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://images.jzwyz.com/blog/dmkyf.png\" alt=\"代码块语法\" title=\"代码块语法\"></p>\n","site":{"data":{}},"excerpt":"","more":"<p>这个网站都是所有的文章都是使用 Markdown 编写的,所以我们有必要了解一下 Markdown 的基本语法</p>\n<h2 id=\"我们需要了解的\"><a href=\"#我们需要了解的\" class=\"headerlink\" title=\"我们需要了解的\"></a>我们需要了解的</h2><ol>\n<li>Markdown 是什么</li>\n<li>为什么要用 Markdown</li>\n<li>怎么使用 Markdown 基本语法</li>\n<li>总结</li>\n</ol>\n<h3 id=\"什么是-Markdown\"><a href=\"#什么是-Markdown\" class=\"headerlink\" title=\"什么是 Markdown\"></a>什么是 Markdown</h3><ul>\n<li>Markdown 是一个简单的标记语言,通过<strong>简单的</strong>几个标记使得普通文本文字具有一定的格式,用来写博客再好不过了.</li>\n</ul>\n<h3 id=\"为什么要用-Markdown\"><a href=\"#为什么要用-Markdown\" class=\"headerlink\" title=\"为什么要用 Markdown\"></a>为什么要用 Markdown</h3><ul>\n<li><strong>上手快</strong>,语法简单 只需要记住几个符号就能上手了.</li>\n<li>Markdwon 有着 易读、易写、易更改 等特点</li>\n<li>Markdwon 最终是被编译成 HTML 代码执行的</li>\n</ul>\n<h3 id=\"Markdown-的基本语法\"><a href=\"#Markdown-的基本语法\" class=\"headerlink\" title=\"Markdown 的基本语法\"></a>Markdown 的基本语法</h3><h4 id=\"标题标签-、-、\"><a href=\"#标题标签-、-、\" class=\"headerlink\" title=\"标题标签 (#、=、-)\"></a>标题标签 (#、=、-)</h4><blockquote>\n<p>两种形式:使用 # 符号代表1-6级标题标签, <strong>个数</strong>为级别;  使用 =、- 代表 一、二级标签</p>\n</blockquote>\n<figure class=\"highlight clean\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 一级标题&lt;h1&gt;</span><br><span class=\"line\">## 二级标题 &lt;h2&gt;</span><br><span class=\"line\">### 三级标题 &lt;h3&gt;</span><br><span class=\"line\">#### 四级标题 &lt;h4&gt;</span><br><span class=\"line\">##### 五级标题 &lt;h5&gt;</span><br></pre></td></tr></table></figure>\n<h4 id=\"段落标签-gt\"><a href=\"#段落标签-gt\" class=\"headerlink\" title=\"段落标签 (&gt;)\"></a>段落标签 (&gt;)</h4><blockquote>\n<p>段落(引用)标签 符号与内容之间要有空格, 单个为主,内嵌几层就打几个 <strong>&gt;</strong>    (ps:貌似可以一致打下去)</p>\n<blockquote>\n<p>内嵌1     &gt;&gt; 内嵌1</p>\n<blockquote>\n<p>内嵌2    &gt;&gt;&gt; 内嵌2</p>\n<blockquote>\n<p>内嵌3   &gt;&gt;&gt;&gt; 内嵌3</p>\n</blockquote>\n</blockquote>\n</blockquote>\n</blockquote>\n<h4 id=\"字体属性\"><a href=\"#字体属性\" class=\"headerlink\" title=\"字体属性\"></a>字体属性</h4><figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"bullet\">* </span><span class=\"strong\">**字体加粗**</span>  给字体加粗,在字体左右各加两个 *</span><br><span class=\"line\"><span class=\"bullet\">* </span><span class=\"emphasis\">*斜体字*</span>  使文字倾斜,在文字左右各加一个 *</span><br><span class=\"line\"><span class=\"bullet\">* </span><span class=\"strong\">***斜体加粗**</span><span class=\"bullet\">*  要使文字加粗、倾斜,在文字左右各加三个 *</span></span><br><span class=\"line\"><span class=\"bullet\">* </span>~~加删除线的文字~~ 左右各 两个 ~</span><br></pre></td></tr></table></figure>\n<ul>\n<li><strong>字体加粗</strong>  给字体加粗,在字体左右各加两个 *</li>\n<li><em>斜体字</em>  使文字倾斜,在文字左右各加一个 *</li>\n<li><strong><em>斜体加粗</em></strong>  要使文字加粗、倾斜,在文字左右各加三个 *</li>\n<li><del>加删除线的文字</del> 左右各 两个 ~</li>\n</ul>\n<h4 id=\"分割线-、\"><a href=\"#分割线-、\" class=\"headerlink\" title=\"分割线 (-、*)\"></a>分割线 (-、*)</h4><blockquote>\n<p>三个(-、*)及三个以上符号即可</p>\n</blockquote>\n<p>效果如下:</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">---</span></span><br><span class=\"line\"><span class=\"string\">***</span></span><br><span class=\"line\"><span class=\"string\">*</span> <span class=\"string\">*</span> <span class=\"string\">*</span></span><br></pre></td></tr></table></figure>\n<p>符号(-)分割线</p>\n<hr>\n<p>符号(*)分割线</p>\n<hr>\n<h4 id=\"图片\"><a href=\"#图片\" class=\"headerlink\" title=\"图片\"></a>图片</h4><p>基本语法</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">![图片语法](https://images.jzwyz.com/blog/tpurl.png <span class=\"string\">\"这是对图片语法的说明图\"</span>)</span><br><span class=\"line\">![图片alt](https://images.jzwyz.com/blog/1.jpg <span class=\"string\">\"图片title\"</span>)</span><br><span class=\"line\">![链接语法](https://images.jzwyz.com/blog/urlsm.png <span class=\"string\">\"链接语法说明\"</span>)</span><br></pre></td></tr></table></figure>\n<p>效果:</p>\n<p><img src=\"https://images.jzwyz.com/blog/tpurl.png\" alt=\"图片语法\" title=\"这是对图片语法的说明图\"></p>\n<p><img src=\"https://images.jzwyz.com/blog/1.jpg\" alt=\"图片alt\" title=\"图片title\"></p>\n<p><img src=\"https://images.jzwyz.com/blog/urlsm.png\" alt=\"链接语法\" title=\"链接语法说明\"></p>\n<blockquote>\n<p>图片alt 显示在图片下方<br>图片title 就是图片描述,当鼠标移到图片上时显示的内容。title可加可不加 title与url之间以 空格 隔开</p>\n</blockquote>\n<h4 id=\"链接\"><a href=\"#链接\" class=\"headerlink\" title=\"链接\"></a>链接</h4><p>与图片语法类似, 开始 不要 ! 符号</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[百度](https://www.baidu.com <span class=\"string\">\"百度一下\"</span>)</span><br><span class=\"line\">[Github](https://www.github.com <span class=\"string\">\"去Github\"</span>)</span><br></pre></td></tr></table></figure>\n<p><a href=\"https://www.baidu.com\" title=\"百度一下\" target=\"_blank\" rel=\"noopener\">百度</a></p>\n<p><a href=\"https://www.github.com\" title=\"去Github\" target=\"_blank\" rel=\"noopener\">Github</a></p>\n<h4 id=\"列表\"><a href=\"#列表\" class=\"headerlink\" title=\"列表\"></a>列表</h4><figure class=\"highlight md\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"bullet\">1. </span>有序列表</span><br><span class=\"line\"><span class=\"bullet\">2. </span>有序列表</span><br><span class=\"line\"><span class=\"bullet\">3. </span>有序列表</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"bullet\">* </span>无序列表 *</span><br><span class=\"line\">  + 无序列表 +</span><br><span class=\"line\"><span class=\"code\">    - 无序列表 -</span></span><br><span class=\"line\">  + 无序列白</span><br><span class=\"line\"><span class=\"bullet\">* </span>无序列表</span><br></pre></td></tr></table></figure>\n<p>效果:</p>\n<ol>\n<li>有序列表</li>\n<li>有序列表</li>\n<li>有序列表</li>\n</ol>\n<ul>\n<li>无序列表 *<ul>\n<li>无序列表 +<ul>\n<li>无序列表 -</li>\n</ul>\n</li>\n<li>无序列白</li>\n</ul>\n</li>\n<li>无序列表</li>\n</ul>\n<blockquote>\n<p>列表 分为无序和有序,其语法区别就是 有序列表以<strong>数字.</strong>为符号 序号和内容之间空格分开</p>\n</blockquote>\n<blockquote>\n<p>无序列表 有 (<em>、+、-) 三个符号, 使用多个时,最顶层应使用 </em>,次级使用 +,再次级使用 -</p>\n</blockquote>\n<blockquote>\n<p>列表嵌套 下级与上级换行,缩进三个空格</p>\n</blockquote>\n<h4 id=\"表格\"><a href=\"#表格\" class=\"headerlink\" title=\"表格\"></a>表格</h4><p>示列 md 代码:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">列名|列名|列名</span><br><span class=\"line\">--|:-:|:--—</span><br><span class=\"line\">内容|内|内容呀</span><br></pre></td></tr></table></figure>\n<p>第一行 | 符号分格列名</p>\n<p>第二行 - 代码该列中一个字符,一般设置为该列最长字符数量, : 放在 - 哪边就表示 该列字段向:对齐, | 符号分隔列</p>\n<p>再往下,就是每列的数据列</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:right\">编号</th>\n<th style=\"text-align:center\">姓名</th>\n<th style=\"text-align:right\">性别</th>\n<th style=\"text-align:left\">年龄</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:right\">01</td>\n<td style=\"text-align:center\">小明</td>\n<td style=\"text-align:right\">男</td>\n<td style=\"text-align:left\">12</td>\n</tr>\n<tr>\n<td style=\"text-align:right\">02</td>\n<td style=\"text-align:center\">小小红</td>\n<td style=\"text-align:right\">女</td>\n<td style=\"text-align:left\">15</td>\n</tr>\n</tbody>\n</table>\n<h4 id=\"代码块语法\"><a href=\"#代码块语法\" class=\"headerlink\" title=\"代码块语法\"></a>代码块语法</h4><p>效果如下:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">这是代码块</span><br></pre></td></tr></table></figure>\n<p><code>这是代码行</code></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 指定 语言</span></span><br><span class=\"line\">docker run -d --rm -v ~/../workspace/my-blog/<span class=\"built_in\">source</span>:/app/<span class=\"built_in\">source</span> --network=app-bridge --name=webblog myblog:1.0</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">node --version</span><br></pre></td></tr></table></figure>\n<p><img src=\"https://images.jzwyz.com/blog/dmkyf.png\" alt=\"代码块语法\" title=\"代码块语法\"></p>\n"},{"title":"梅林安装zerotier","date":"2020-01-02T10:50:50.000Z","_content":"\n网件R7000刷梅林, 安装zerotier内网穿透工具, 并配置开机自启\n\n[参考](http://koolshare.cn/forum.php?mod=viewthread&tid=134930&extra=&ordertype=1)\n\n## 安装 entware\n\n```sh\nrm -rf /opt\n\nmkdir /opt\n\ncd /opt\n\nwget -O - http://qnapware.zyxmon.org/binaries-armv7/installer/entware_install_arm.sh | sh\n```\n\n> 然后会提示你选择哪个分区，选择你挂载的U盘分区\n\n```sh\n···省略\nInfo:  Looking for available partitions...\n[1] --> /tmp/mnt/sda1\n=>  Please enter partition number or 0 to exit\n[0-1]: 1 # 选1回车\n···省略\n```\n\n> 跑完之后只要不提示错误，就是安装成功了\n\n### 配置entware环境变量\n\n`vim /etc/profile`\n\n直接在前面/usr/sbin:这行下直接添加下面两行并保存退出（ESC+:wq+Enter）\n\n`/opt/bin:/opt/sbin:`\n\n使配置生效\n\n`source /etc/profile`\n\n### 检查entware环境安装情况看是否报错\n\n```sh\nopkg update\n\nopkg list\n```\n\n## 安装 zerotier\n\n```sh\nopkg update\n\nopkg install zerotier\n```\n\n## 启动zerotier服务\n\n## 添加端口映射表\n\n## 重启zerotier服务\n\n## 注意事项\n\n1. 安装zerotier之前先安装 entware, 这样才能安装最新版本的zerotier\n\n## 最后\n\n......\n","source":"_posts/meilin-zerotier.md","raw":"---\ntitle: 梅林安装zerotier\ndate: 2020-01-02 18:50:50\ntags: 路由器\n---\n\n网件R7000刷梅林, 安装zerotier内网穿透工具, 并配置开机自启\n\n[参考](http://koolshare.cn/forum.php?mod=viewthread&tid=134930&extra=&ordertype=1)\n\n## 安装 entware\n\n```sh\nrm -rf /opt\n\nmkdir /opt\n\ncd /opt\n\nwget -O - http://qnapware.zyxmon.org/binaries-armv7/installer/entware_install_arm.sh | sh\n```\n\n> 然后会提示你选择哪个分区，选择你挂载的U盘分区\n\n```sh\n···省略\nInfo:  Looking for available partitions...\n[1] --> /tmp/mnt/sda1\n=>  Please enter partition number or 0 to exit\n[0-1]: 1 # 选1回车\n···省略\n```\n\n> 跑完之后只要不提示错误，就是安装成功了\n\n### 配置entware环境变量\n\n`vim /etc/profile`\n\n直接在前面/usr/sbin:这行下直接添加下面两行并保存退出（ESC+:wq+Enter）\n\n`/opt/bin:/opt/sbin:`\n\n使配置生效\n\n`source /etc/profile`\n\n### 检查entware环境安装情况看是否报错\n\n```sh\nopkg update\n\nopkg list\n```\n\n## 安装 zerotier\n\n```sh\nopkg update\n\nopkg install zerotier\n```\n\n## 启动zerotier服务\n\n## 添加端口映射表\n\n## 重启zerotier服务\n\n## 注意事项\n\n1. 安装zerotier之前先安装 entware, 这样才能安装最新版本的zerotier\n\n## 最后\n\n......\n","slug":"meilin-zerotier","published":1,"updated":"2020-01-02T11:06:25.037Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck550trlp000ghm62gjdsldxm","content":"<p>网件R7000刷梅林, 安装zerotier内网穿透工具, 并配置开机自启</p>\n<p><a href=\"http://koolshare.cn/forum.php?mod=viewthread&amp;tid=134930&amp;extra=&amp;ordertype=1\" target=\"_blank\" rel=\"noopener\">参考</a></p>\n<h2 id=\"安装-entware\"><a href=\"#安装-entware\" class=\"headerlink\" title=\"安装 entware\"></a>安装 entware</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rm -rf /opt</span><br><span class=\"line\"></span><br><span class=\"line\">mkdir /opt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">cd</span> /opt</span><br><span class=\"line\"></span><br><span class=\"line\">wget -O - http://qnapware.zyxmon.org/binaries-armv7/installer/entware_install_arm.sh | sh</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>然后会提示你选择哪个分区，选择你挂载的U盘分区</p>\n</blockquote>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">···省略</span><br><span class=\"line\">Info:  Looking <span class=\"keyword\">for</span> available partitions...</span><br><span class=\"line\">[1] --&gt; /tmp/mnt/sda1</span><br><span class=\"line\">=&gt;  Please enter partition number or 0 to <span class=\"built_in\">exit</span></span><br><span class=\"line\">[0-1]: 1 <span class=\"comment\"># 选1回车</span></span><br><span class=\"line\">···省略</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>跑完之后只要不提示错误，就是安装成功了</p>\n</blockquote>\n<h3 id=\"配置entware环境变量\"><a href=\"#配置entware环境变量\" class=\"headerlink\" title=\"配置entware环境变量\"></a>配置entware环境变量</h3><p><code>vim /etc/profile</code></p>\n<p>直接在前面/usr/sbin:这行下直接添加下面两行并保存退出（ESC+:wq+Enter）</p>\n<p><code>/opt/bin:/opt/sbin:</code></p>\n<p>使配置生效</p>\n<p><code>source /etc/profile</code></p>\n<h3 id=\"检查entware环境安装情况看是否报错\"><a href=\"#检查entware环境安装情况看是否报错\" class=\"headerlink\" title=\"检查entware环境安装情况看是否报错\"></a>检查entware环境安装情况看是否报错</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">opkg update</span><br><span class=\"line\"></span><br><span class=\"line\">opkg list</span><br></pre></td></tr></table></figure>\n<h2 id=\"安装-zerotier\"><a href=\"#安装-zerotier\" class=\"headerlink\" title=\"安装 zerotier\"></a>安装 zerotier</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">opkg update</span><br><span class=\"line\"></span><br><span class=\"line\">opkg install zerotier</span><br></pre></td></tr></table></figure>\n<h2 id=\"启动zerotier服务\"><a href=\"#启动zerotier服务\" class=\"headerlink\" title=\"启动zerotier服务\"></a>启动zerotier服务</h2><h2 id=\"添加端口映射表\"><a href=\"#添加端口映射表\" class=\"headerlink\" title=\"添加端口映射表\"></a>添加端口映射表</h2><h2 id=\"重启zerotier服务\"><a href=\"#重启zerotier服务\" class=\"headerlink\" title=\"重启zerotier服务\"></a>重启zerotier服务</h2><h2 id=\"注意事项\"><a href=\"#注意事项\" class=\"headerlink\" title=\"注意事项\"></a>注意事项</h2><ol>\n<li>安装zerotier之前先安装 entware, 这样才能安装最新版本的zerotier</li>\n</ol>\n<h2 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h2><p>……</p>\n","site":{"data":{}},"excerpt":"","more":"<p>网件R7000刷梅林, 安装zerotier内网穿透工具, 并配置开机自启</p>\n<p><a href=\"http://koolshare.cn/forum.php?mod=viewthread&amp;tid=134930&amp;extra=&amp;ordertype=1\" target=\"_blank\" rel=\"noopener\">参考</a></p>\n<h2 id=\"安装-entware\"><a href=\"#安装-entware\" class=\"headerlink\" title=\"安装 entware\"></a>安装 entware</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rm -rf /opt</span><br><span class=\"line\"></span><br><span class=\"line\">mkdir /opt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">cd</span> /opt</span><br><span class=\"line\"></span><br><span class=\"line\">wget -O - http://qnapware.zyxmon.org/binaries-armv7/installer/entware_install_arm.sh | sh</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>然后会提示你选择哪个分区，选择你挂载的U盘分区</p>\n</blockquote>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">···省略</span><br><span class=\"line\">Info:  Looking <span class=\"keyword\">for</span> available partitions...</span><br><span class=\"line\">[1] --&gt; /tmp/mnt/sda1</span><br><span class=\"line\">=&gt;  Please enter partition number or 0 to <span class=\"built_in\">exit</span></span><br><span class=\"line\">[0-1]: 1 <span class=\"comment\"># 选1回车</span></span><br><span class=\"line\">···省略</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>跑完之后只要不提示错误，就是安装成功了</p>\n</blockquote>\n<h3 id=\"配置entware环境变量\"><a href=\"#配置entware环境变量\" class=\"headerlink\" title=\"配置entware环境变量\"></a>配置entware环境变量</h3><p><code>vim /etc/profile</code></p>\n<p>直接在前面/usr/sbin:这行下直接添加下面两行并保存退出（ESC+:wq+Enter）</p>\n<p><code>/opt/bin:/opt/sbin:</code></p>\n<p>使配置生效</p>\n<p><code>source /etc/profile</code></p>\n<h3 id=\"检查entware环境安装情况看是否报错\"><a href=\"#检查entware环境安装情况看是否报错\" class=\"headerlink\" title=\"检查entware环境安装情况看是否报错\"></a>检查entware环境安装情况看是否报错</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">opkg update</span><br><span class=\"line\"></span><br><span class=\"line\">opkg list</span><br></pre></td></tr></table></figure>\n<h2 id=\"安装-zerotier\"><a href=\"#安装-zerotier\" class=\"headerlink\" title=\"安装 zerotier\"></a>安装 zerotier</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">opkg update</span><br><span class=\"line\"></span><br><span class=\"line\">opkg install zerotier</span><br></pre></td></tr></table></figure>\n<h2 id=\"启动zerotier服务\"><a href=\"#启动zerotier服务\" class=\"headerlink\" title=\"启动zerotier服务\"></a>启动zerotier服务</h2><h2 id=\"添加端口映射表\"><a href=\"#添加端口映射表\" class=\"headerlink\" title=\"添加端口映射表\"></a>添加端口映射表</h2><h2 id=\"重启zerotier服务\"><a href=\"#重启zerotier服务\" class=\"headerlink\" title=\"重启zerotier服务\"></a>重启zerotier服务</h2><h2 id=\"注意事项\"><a href=\"#注意事项\" class=\"headerlink\" title=\"注意事项\"></a>注意事项</h2><ol>\n<li>安装zerotier之前先安装 entware, 这样才能安装最新版本的zerotier</li>\n</ol>\n<h2 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h2><p>……</p>\n"},{"title":"mysql的explain命令","date":"2020-01-02T10:16:21.000Z","_content":"\n**explain**关键字可以模拟MySQL优化器执行SQL语句，可以很好的分析SQL语句或表结构的性能瓶颈.\n\n## explain的用途\n\n1. 表的读取顺序如何\n2. 数据读取操作有哪些操作类型\n3. 哪些索引可以使用\n4. 哪些索引被实际使用\n5. 表之间是如何引用\n6. 每张表有多少行被优化器查询\n7. ......\n\n## explain的主要字段有\n\n1. **id** select查询的序列号，包含一组数字，表示查询中执行select子句或操作表的顺序\n2. **select_type** 查询类型\n3. **table** 正在访问哪个表\n4. **partitions** 匹配的分区\n5. **type** 访问的类型\n6. **possible_keys** 显示可能应用在这张表中的索引，一个或多个，但不一定实际使用到\n7. **key** 实际使用到的索引，如果为NULL，则没有使用索引\n8. **key_len** 表示索引中使用的字节数，可通过该列计算查询中使用的索引的长度\n9. **ref** 显示索引的哪一列被使用了，如果可能的话，是一个常数，哪些列或常量被用于查找索引列上的值\n10. **rows** 根据表统计信息及索引选用情况，大致估算出找到所需的记录所需读取的行数\n11. **filtered** 查询的表行占表的百分比\n12. **Extra** 包含不适合在其它列中显示但十分重要的额外信息\n\n## 最后\n\n![ ](./2864885534-202c0878c1abf896.png)\n\n......\n","source":"_posts/mysql-explain.md","raw":"---\ntitle: mysql的explain命令\ndate: 2020-01-02 18:16:21\ntags: 数据库\n---\n\n**explain**关键字可以模拟MySQL优化器执行SQL语句，可以很好的分析SQL语句或表结构的性能瓶颈.\n\n## explain的用途\n\n1. 表的读取顺序如何\n2. 数据读取操作有哪些操作类型\n3. 哪些索引可以使用\n4. 哪些索引被实际使用\n5. 表之间是如何引用\n6. 每张表有多少行被优化器查询\n7. ......\n\n## explain的主要字段有\n\n1. **id** select查询的序列号，包含一组数字，表示查询中执行select子句或操作表的顺序\n2. **select_type** 查询类型\n3. **table** 正在访问哪个表\n4. **partitions** 匹配的分区\n5. **type** 访问的类型\n6. **possible_keys** 显示可能应用在这张表中的索引，一个或多个，但不一定实际使用到\n7. **key** 实际使用到的索引，如果为NULL，则没有使用索引\n8. **key_len** 表示索引中使用的字节数，可通过该列计算查询中使用的索引的长度\n9. **ref** 显示索引的哪一列被使用了，如果可能的话，是一个常数，哪些列或常量被用于查找索引列上的值\n10. **rows** 根据表统计信息及索引选用情况，大致估算出找到所需的记录所需读取的行数\n11. **filtered** 查询的表行占表的百分比\n12. **Extra** 包含不适合在其它列中显示但十分重要的额外信息\n\n## 最后\n\n![ ](./2864885534-202c0878c1abf896.png)\n\n......\n","slug":"mysql-explain","published":1,"updated":"2020-01-02T10:25:49.978Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck550trlq000ihm62f8zcclfj","content":"<p><strong>explain</strong>关键字可以模拟MySQL优化器执行SQL语句，可以很好的分析SQL语句或表结构的性能瓶颈.</p>\n<h2 id=\"explain的用途\"><a href=\"#explain的用途\" class=\"headerlink\" title=\"explain的用途\"></a>explain的用途</h2><ol>\n<li>表的读取顺序如何</li>\n<li>数据读取操作有哪些操作类型</li>\n<li>哪些索引可以使用</li>\n<li>哪些索引被实际使用</li>\n<li>表之间是如何引用</li>\n<li>每张表有多少行被优化器查询</li>\n<li>……</li>\n</ol>\n<h2 id=\"explain的主要字段有\"><a href=\"#explain的主要字段有\" class=\"headerlink\" title=\"explain的主要字段有\"></a>explain的主要字段有</h2><ol>\n<li><strong>id</strong> select查询的序列号，包含一组数字，表示查询中执行select子句或操作表的顺序</li>\n<li><strong>select_type</strong> 查询类型</li>\n<li><strong>table</strong> 正在访问哪个表</li>\n<li><strong>partitions</strong> 匹配的分区</li>\n<li><strong>type</strong> 访问的类型</li>\n<li><strong>possible_keys</strong> 显示可能应用在这张表中的索引，一个或多个，但不一定实际使用到</li>\n<li><strong>key</strong> 实际使用到的索引，如果为NULL，则没有使用索引</li>\n<li><strong>key_len</strong> 表示索引中使用的字节数，可通过该列计算查询中使用的索引的长度</li>\n<li><strong>ref</strong> 显示索引的哪一列被使用了，如果可能的话，是一个常数，哪些列或常量被用于查找索引列上的值</li>\n<li><strong>rows</strong> 根据表统计信息及索引选用情况，大致估算出找到所需的记录所需读取的行数</li>\n<li><strong>filtered</strong> 查询的表行占表的百分比</li>\n<li><strong>Extra</strong> 包含不适合在其它列中显示但十分重要的额外信息</li>\n</ol>\n<h2 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h2><p><img src=\"./2864885534-202c0878c1abf896.png\" alt=\" \"></p>\n<p>……</p>\n","site":{"data":{}},"excerpt":"","more":"<p><strong>explain</strong>关键字可以模拟MySQL优化器执行SQL语句，可以很好的分析SQL语句或表结构的性能瓶颈.</p>\n<h2 id=\"explain的用途\"><a href=\"#explain的用途\" class=\"headerlink\" title=\"explain的用途\"></a>explain的用途</h2><ol>\n<li>表的读取顺序如何</li>\n<li>数据读取操作有哪些操作类型</li>\n<li>哪些索引可以使用</li>\n<li>哪些索引被实际使用</li>\n<li>表之间是如何引用</li>\n<li>每张表有多少行被优化器查询</li>\n<li>……</li>\n</ol>\n<h2 id=\"explain的主要字段有\"><a href=\"#explain的主要字段有\" class=\"headerlink\" title=\"explain的主要字段有\"></a>explain的主要字段有</h2><ol>\n<li><strong>id</strong> select查询的序列号，包含一组数字，表示查询中执行select子句或操作表的顺序</li>\n<li><strong>select_type</strong> 查询类型</li>\n<li><strong>table</strong> 正在访问哪个表</li>\n<li><strong>partitions</strong> 匹配的分区</li>\n<li><strong>type</strong> 访问的类型</li>\n<li><strong>possible_keys</strong> 显示可能应用在这张表中的索引，一个或多个，但不一定实际使用到</li>\n<li><strong>key</strong> 实际使用到的索引，如果为NULL，则没有使用索引</li>\n<li><strong>key_len</strong> 表示索引中使用的字节数，可通过该列计算查询中使用的索引的长度</li>\n<li><strong>ref</strong> 显示索引的哪一列被使用了，如果可能的话，是一个常数，哪些列或常量被用于查找索引列上的值</li>\n<li><strong>rows</strong> 根据表统计信息及索引选用情况，大致估算出找到所需的记录所需读取的行数</li>\n<li><strong>filtered</strong> 查询的表行占表的百分比</li>\n<li><strong>Extra</strong> 包含不适合在其它列中显示但十分重要的额外信息</li>\n</ol>\n<h2 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h2><p><img src=\"./2864885534-202c0878c1abf896.png\" alt=\" \"></p>\n<p>……</p>\n"},{"title":"Windows10下的子系统Linux","date":"2020-01-08T06:41:17.000Z","_content":"\nWindows10出了一款子系统Linux,可以方便开发者不在需要依赖虚拟机啦\n\n## 开始\n\n首先你得是windows10最新版本的系统\n\n进入 系统设置 -> 更新和安全 -> 开发者选项 打开\n\n![ ](./WX20200108-154615@2x.png)\n\n![ ](./WX20200108-154856@2x.png)\n\n其次是 进入 控制面板-程序和功能-启用或关闭Windows功能下 选择 “适用于Linux的Window之系统”\n\n![ ](./WX20200108-155336@2x.png)\n\n然后**重启系统**\n\n## 安装Linux系统\n\n打开Windows10的应用商店, 搜索Linux会得到以下结果, 点击第一个进入\n\n![ ](./A84A183D1145E8245B6A7C8A84FB985F.jpg)\n\n![ ](./WX20200108-155928@2x.png)\n\n这里我安装的是第一个 Ubuntu 系统\n\n![ ](./WX20200108-160028@2x.png)\n\n点击安装, 等待安装完成\n\n## 进入Linux系统\n\n安装完成之后, `Ctrl + R`打开CMD\n输入 `bash` 就会进入Linux系统了\n\n根据提示, 创建用户、设置密码就好了\n\n![ ](./20180912154639866.png)\n\n\n","source":"_posts/msl.md","raw":"---\ntitle: Windows10下的子系统Linux\ndate: 2020-01-08 14:41:17\ntags: Windows\n---\n\nWindows10出了一款子系统Linux,可以方便开发者不在需要依赖虚拟机啦\n\n## 开始\n\n首先你得是windows10最新版本的系统\n\n进入 系统设置 -> 更新和安全 -> 开发者选项 打开\n\n![ ](./WX20200108-154615@2x.png)\n\n![ ](./WX20200108-154856@2x.png)\n\n其次是 进入 控制面板-程序和功能-启用或关闭Windows功能下 选择 “适用于Linux的Window之系统”\n\n![ ](./WX20200108-155336@2x.png)\n\n然后**重启系统**\n\n## 安装Linux系统\n\n打开Windows10的应用商店, 搜索Linux会得到以下结果, 点击第一个进入\n\n![ ](./A84A183D1145E8245B6A7C8A84FB985F.jpg)\n\n![ ](./WX20200108-155928@2x.png)\n\n这里我安装的是第一个 Ubuntu 系统\n\n![ ](./WX20200108-160028@2x.png)\n\n点击安装, 等待安装完成\n\n## 进入Linux系统\n\n安装完成之后, `Ctrl + R`打开CMD\n输入 `bash` 就会进入Linux系统了\n\n根据提示, 创建用户、设置密码就好了\n\n![ ](./20180912154639866.png)\n\n\n","slug":"msl","published":1,"updated":"2020-01-08T08:08:14.748Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck550trlr000khm62lir4fj2t","content":"<p>Windows10出了一款子系统Linux,可以方便开发者不在需要依赖虚拟机啦</p>\n<h2 id=\"开始\"><a href=\"#开始\" class=\"headerlink\" title=\"开始\"></a>开始</h2><p>首先你得是windows10最新版本的系统</p>\n<p>进入 系统设置 -&gt; 更新和安全 -&gt; 开发者选项 打开</p>\n<p><img src=\"./WX20200108-154615@2x.png\" alt=\" \"></p>\n<p><img src=\"./WX20200108-154856@2x.png\" alt=\" \"></p>\n<p>其次是 进入 控制面板-程序和功能-启用或关闭Windows功能下 选择 “适用于Linux的Window之系统”</p>\n<p><img src=\"./WX20200108-155336@2x.png\" alt=\" \"></p>\n<p>然后<strong>重启系统</strong></p>\n<h2 id=\"安装Linux系统\"><a href=\"#安装Linux系统\" class=\"headerlink\" title=\"安装Linux系统\"></a>安装Linux系统</h2><p>打开Windows10的应用商店, 搜索Linux会得到以下结果, 点击第一个进入</p>\n<p><img src=\"./A84A183D1145E8245B6A7C8A84FB985F.jpg\" alt=\" \"></p>\n<p><img src=\"./WX20200108-155928@2x.png\" alt=\" \"></p>\n<p>这里我安装的是第一个 Ubuntu 系统</p>\n<p><img src=\"./WX20200108-160028@2x.png\" alt=\" \"></p>\n<p>点击安装, 等待安装完成</p>\n<h2 id=\"进入Linux系统\"><a href=\"#进入Linux系统\" class=\"headerlink\" title=\"进入Linux系统\"></a>进入Linux系统</h2><p>安装完成之后, <code>Ctrl + R</code>打开CMD<br>输入 <code>bash</code> 就会进入Linux系统了</p>\n<p>根据提示, 创建用户、设置密码就好了</p>\n<p><img src=\"./20180912154639866.png\" alt=\" \"></p>\n","site":{"data":{}},"excerpt":"","more":"<p>Windows10出了一款子系统Linux,可以方便开发者不在需要依赖虚拟机啦</p>\n<h2 id=\"开始\"><a href=\"#开始\" class=\"headerlink\" title=\"开始\"></a>开始</h2><p>首先你得是windows10最新版本的系统</p>\n<p>进入 系统设置 -&gt; 更新和安全 -&gt; 开发者选项 打开</p>\n<p><img src=\"./WX20200108-154615@2x.png\" alt=\" \"></p>\n<p><img src=\"./WX20200108-154856@2x.png\" alt=\" \"></p>\n<p>其次是 进入 控制面板-程序和功能-启用或关闭Windows功能下 选择 “适用于Linux的Window之系统”</p>\n<p><img src=\"./WX20200108-155336@2x.png\" alt=\" \"></p>\n<p>然后<strong>重启系统</strong></p>\n<h2 id=\"安装Linux系统\"><a href=\"#安装Linux系统\" class=\"headerlink\" title=\"安装Linux系统\"></a>安装Linux系统</h2><p>打开Windows10的应用商店, 搜索Linux会得到以下结果, 点击第一个进入</p>\n<p><img src=\"./A84A183D1145E8245B6A7C8A84FB985F.jpg\" alt=\" \"></p>\n<p><img src=\"./WX20200108-155928@2x.png\" alt=\" \"></p>\n<p>这里我安装的是第一个 Ubuntu 系统</p>\n<p><img src=\"./WX20200108-160028@2x.png\" alt=\" \"></p>\n<p>点击安装, 等待安装完成</p>\n<h2 id=\"进入Linux系统\"><a href=\"#进入Linux系统\" class=\"headerlink\" title=\"进入Linux系统\"></a>进入Linux系统</h2><p>安装完成之后, <code>Ctrl + R</code>打开CMD<br>输入 <code>bash</code> 就会进入Linux系统了</p>\n<p>根据提示, 创建用户、设置密码就好了</p>\n<p><img src=\"./20180912154639866.png\" alt=\" \"></p>\n"},{"title":"Nginx学习笔记","date":"2019-05-15T08:14:29.000Z","_content":"\nNginx是一个**轻量级的高性能**HTTP和反向代理服务器, 由俄罗斯人 **伊戈尔·赛索耶夫**\n\n> 这是一个学习笔记, 我想它应该不需要那么详细\n\n## 安装 Nginx\n\n我们既然学习了Docker, 那就要使用Docker\n\n使用 Docker 安装 Nginx\n\n```bash\n# 从docker hub中查找nginx\ndocker search nginx\n\n# 拉取nginx官方最新稳定版 nginx 镜像\ndocker pull nginx\n\n# 启动 nginx 镜像\ndocker run -d -p 80:80 --name nginx nginx\n```\n\n## Nginx基本概念\n\n### 正则表达式\n\n1. ~  表示执行一个正则匹配，区分大小写\n2. ~* 表示执行一个正则匹配，不区分大小写\n3. ^~ 表示普通字符匹配。使用前缀匹配。如果匹配成功，则不再匹配其他location。\n4. =  进行普通字符精确匹配。也就是完全匹配。\n5. @  它定义一个命名的 location，使用在内部定向时，例如 error_page, try_files\n\n### 匹配规则优先级\n\n1. 等号类型（=）的优先级最高。一旦匹配成功，则不再查找其他匹配项。\n2. ^~类型表达式。一旦匹配成功，则不再查找其他匹配项。\n3. 正则表达式类型（~ ~*）的优先级次之。如果有多个location的正则能匹配的话，则使用正则表达式最长的那个。\n4. 常规字符串匹配类型。按前缀匹配。\n\n### 文件及目录匹配\n\n1. -f和!-f用来判断是否存在文件\n2. -d和!-d用来判断是否存在目录\n3. -e和!-e用来判断是否存在文件或目录\n4. -x和!-x用来判断文件是否可执行\n\n### rewrite(重定向)指令的最后一项参数为flag标记，flag标记有\n\n1. last 相当于apache里面的[L]标记，表示rewrite。\n2. break 本条规则匹配完成后，终止匹配，不再匹配后面的规则。\n3. redirect 返回302临时重定向，浏览器地址会显示跳转后的URL地址。\n4. permanent 返回301永久重定向，浏览器地址会显示跳转后的URL地址。\n\n> 使用last和break实现URI重写，浏览器地址栏不变。  \n> 使用alias指令必须用last标记;  \n> 使用proxy_pass指令时，需要使用break标记。  \n> Last标记在本条rewrite规则执行完毕后，会对其所在server{......}标签重新发起请求.  \n> break标记则在本条规则匹配完成后，终止匹配。\n\n## Nginx配置文件\n\n```conf\n# nginx进程数，建议设置为等于CPU总核心数.\nworker_processes 8;\n\n# 全局错误日志定义类型，[ debug | info | notice | warn | error | crit ]\nerror_log /var/log/nginx/error.log info;\n\n# 进程文件\npid /var/run/nginx.pid;\n\n# 一个nginx进程打开的最多文件描述符数目，理论值应该是最多打开文件数（系统的值ulimit -n）与nginx进程数相除，但是nginx分配请求并不均匀，所以建议与ulimit -n的值保持一致。\nworker_rlimit_nofile 65535;\n\n# 工作模式与连接数上限\nevents\n{\n　　#参考事件模型，use [ kqueue | rtsig | epoll | /dev/poll | select | poll ]; epoll模型是Linux 2.6以上版本内核中的高性能网络I/O模型，如果跑在FreeBSD上面，就用kqueue模型。\n　　use epoll;\n　　#单个进程最大连接数（最大连接数=连接数*进程数）\n　　worker_connections 65535;\n}\n\n# 设定http服务器\nhttp\n{\n\n    include mime.types; #文件扩展名与文件类型映射表\n    default_type application/octet-stream; #默认文件类型\n    #charset utf-8; #默认编码\n    server_names_hash_bucket_size 128; #服务器名字的hash表大小\n    client_header_buffer_size 32k; #上传文件大小限制\n    large_client_header_buffers 4 64k; #设定请求缓\n    client_max_body_size 8m; #设定请求缓\n    sendfile on; #开启高效文件传输模式，sendfile指令指定nginx是否调用sendfile函数来输出文件，对于普通应用设为 on，如果用来进行下载等应用磁盘IO重负载应用，可设置为off，以平衡磁盘与网络I/O处理速度，降低系统的负载。注意：如果图片显示不正常把这个改成off。\n    autoindex on; #开启目录列表访问，合适下载服务器，默认关闭。\n    tcp_nopush on; #防止网络阻塞\n    tcp_nodelay on; #防止网络阻塞\n    keepalive_timeout 120; #长连接超时时间，单位是秒\n\n    #FastCGI相关参数是为了改善网站的性能：减少资源占用，提高访问速度。下面参数看字面意思都能理解。\n    fastcgi_connect_timeout 300;\n    fastcgi_send_timeout 300;\n    fastcgi_read_timeout 300;\n    fastcgi_buffer_size 64k;\n    fastcgi_buffers 4 64k;\n    fastcgi_busy_buffers_size 128k;\n    fastcgi_temp_file_write_size 128k;\n\n    #gzip模块设置\n    gzip on; #开启gzip压缩输出\n    gzip_min_length 1k; #最小压缩文件大小\n    gzip_buffers 4 16k; #压缩缓冲区\n    gzip_http_version 1.0; #压缩版本（默认1.1，前端如果是squid2.5请使用1.0）\n    gzip_comp_level 2; #压缩等级\n    gzip_types text/plain application/x-javascript text/css application/xml;\n    #压缩类型，默认就已经包含text/html，所以下面就不用再写了，写上去也不会有问题，但是会有一个warn。\n    gzip_vary on;\n    #limit_zone crawler $binary_remote_addr 10m; #开启限制IP连接数的时候需要使用\n\n    # 应用 myblog 是容器网络中的昵称\n    upstream blogs {\n        #upstream的负载均衡，weight是权重，可以根据机器配置定义权重。weigth参数表示权值，权值越高被分配到的几率越大。\n        # 单台机器 weight 设置无意义\n        server myblog:3001 weight=3;\n    }\n\n    # 虚拟主机的配置\n    server\n    {\n\n        listen 80;　　　　#监听端口\n\n        server_name aa.cn www.aa.cn ; #server_name end  #域名可以有多个，用空格隔开\n\n        index index.html index.htm index.php;  # 设置访问主页\n\n        set $subdomain '';  # 绑定目录为二级域名 bbb.aa.com  根目录 /bbb  文件夹\n\n        if ( $host ~* \"(?:(\\w+\\.){0,})(\\b(?!www\\b)\\w+)\\.\\b(?!(com|org|gov|net|cn)\\b)\\w+\\.[a-zA-Z]+\" )\n        {\n            set $subdomain \"/$2\";\n        }\n\n        root /home/wwwroot/aa.cn/web$subdomain;# 访问域名跟目录  \n\n        include rewrite/dedecms.conf; #rewrite end   #载入其他配置文件\n\n\n        location ~ .*.(php|php5)?$\n        {\n        　　fastcgi_pass 127.0.0.1:9000;\n        　　fastcgi_index index.php;\n        　　include fastcgi.conf;\n        }\n        #图片缓存时间设置\n        location ~ .*.(gif|jpg|jpeg|png|bmp|swf)$\n        {\n        　　expires 10d;\n        }\n        #JS和CSS缓存时间设置\n        location ~ .*.(js|css)?$\n        {\n        　　expires 1h;\n        }\n\n    }\n\n    # 日志格式设定\n\n    log_format access '$remote_addr - $remote_user [$time_local] \"$request\" '\n    '$status $body_bytes_sent \"$http_referer\" '\n    '\"$http_user_agent\" $http_x_forwarded_for';\n    #定义本虚拟主机的访问日志\n    access_log /var/log/nginx/ha97access.log access;\n\n    #对 \"/\" 启用反向代理\n    location / {\n\n        proxy_pass http://127.0.0.1:88;\n        proxy_redirect off;\n        proxy_set_header X-Real-IP $remote_addr;\n        #后端的Web服务器可以通过X-Forwarded-For获取用户真实IP\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        #以下是一些反向代理的配置，可选。\n        proxy_set_header Host $host;\n        client_max_body_size 10m; #允许客户端请求的最大单文件字节数\n        client_body_buffer_size 128k; #缓冲区代理缓冲用户端请求的最大字节数，\n        proxy_connect_timeout 90; #nginx跟后端服务器连接超时时间(代理连接超时)\n        proxy_send_timeout 90; #后端服务器数据回传时间(代理发送超时)\n        proxy_read_timeout 90; #连接成功后，后端服务器响应时间(代理接收超时)\n        proxy_buffer_size 4k; #设置代理服务器（nginx）保存用户头信息的缓冲区大小\n        proxy_buffers 4 32k; #proxy_buffers缓冲区，网页平均在32k以下的设置\n        proxy_busy_buffers_size 64k; #高负荷下缓冲大小（proxy_buffers*2）\n        proxy_temp_file_write_size 64k;\n        #设定缓存文件夹大小，大于这个值，将从upstream服务器传\n\n    }\n\n    # 设定查看Nginx状态的地址\n    location /NginxStatus {\n\n        stub_status on;\n        access_log on;\n        auth_basic \"NginxStatus\";\n        auth_basic_user_file conf/htpasswd;\n        #htpasswd文件的内容可以用apache提供的htpasswd工具来产生。\n\n    }\n\n    #本地动静分离反向代理配置\n    #所有jsp的页面均交由tomcat或resin处理\n    location ~ .(jsp|jspx|do)?$ {\n\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_pass http://127.0.0.1:8080;\n\n    }\n    #所有静态文件由nginx直接读取不经过tomcat或resin\n    location ~ .*.(htm|html|gif|jpg|jpeg|png|bmp|swf|ioc|rar|zip|txt|flv|mid|doc|ppt|pdf|xls|mp3|wma)$\n    {\n        expires 15d;\n    }\n    location ~ .*.(js|css)?$\n    {\n        expires 1h;\n    }\n\n}\n```\n\n### 使用记录\n\n#### nginx热更新\n\n在docker中,实现nginx热更新 `docker exec -i [nginx容器名/id] nginx -s reload`\n\n### nginx 日志配置\n\n[日志配置 参考](https://www.cnblogs.com/biglittleant/p/8979856.html)\n\n## 进阶使用\n\n再文章开始, 我们使用docker安装nginx, 我们完全使用了nginx官方的默认配置, 这里我们将使用自定义配置来启动nginx\n\n首先我们得知道 nginx 官方 docker 镜像得conf文件位置在哪\n\n我得nginx版本conf文件在: /etc/nginx/nginx.conf (可能不同版本的配置文件会有所不同, 所以我们在拉取镜像的时候最好固定版本)\n\n## 相关链接\n\n[Nginx配置文件nginx.conf详解](https://www.cnblogs.com/xuey/p/7631690.html)\n\n[nginx的location配置详解](https://www.cnblogs.com/sign-ptk/p/6723048.html)\n\n## 结语\n\n","source":"_posts/nginx.md","raw":"---\ntitle: Nginx学习笔记\ndate: 2019-05-15 16:14:29\ntags: 服务器\n---\n\nNginx是一个**轻量级的高性能**HTTP和反向代理服务器, 由俄罗斯人 **伊戈尔·赛索耶夫**\n\n> 这是一个学习笔记, 我想它应该不需要那么详细\n\n## 安装 Nginx\n\n我们既然学习了Docker, 那就要使用Docker\n\n使用 Docker 安装 Nginx\n\n```bash\n# 从docker hub中查找nginx\ndocker search nginx\n\n# 拉取nginx官方最新稳定版 nginx 镜像\ndocker pull nginx\n\n# 启动 nginx 镜像\ndocker run -d -p 80:80 --name nginx nginx\n```\n\n## Nginx基本概念\n\n### 正则表达式\n\n1. ~  表示执行一个正则匹配，区分大小写\n2. ~* 表示执行一个正则匹配，不区分大小写\n3. ^~ 表示普通字符匹配。使用前缀匹配。如果匹配成功，则不再匹配其他location。\n4. =  进行普通字符精确匹配。也就是完全匹配。\n5. @  它定义一个命名的 location，使用在内部定向时，例如 error_page, try_files\n\n### 匹配规则优先级\n\n1. 等号类型（=）的优先级最高。一旦匹配成功，则不再查找其他匹配项。\n2. ^~类型表达式。一旦匹配成功，则不再查找其他匹配项。\n3. 正则表达式类型（~ ~*）的优先级次之。如果有多个location的正则能匹配的话，则使用正则表达式最长的那个。\n4. 常规字符串匹配类型。按前缀匹配。\n\n### 文件及目录匹配\n\n1. -f和!-f用来判断是否存在文件\n2. -d和!-d用来判断是否存在目录\n3. -e和!-e用来判断是否存在文件或目录\n4. -x和!-x用来判断文件是否可执行\n\n### rewrite(重定向)指令的最后一项参数为flag标记，flag标记有\n\n1. last 相当于apache里面的[L]标记，表示rewrite。\n2. break 本条规则匹配完成后，终止匹配，不再匹配后面的规则。\n3. redirect 返回302临时重定向，浏览器地址会显示跳转后的URL地址。\n4. permanent 返回301永久重定向，浏览器地址会显示跳转后的URL地址。\n\n> 使用last和break实现URI重写，浏览器地址栏不变。  \n> 使用alias指令必须用last标记;  \n> 使用proxy_pass指令时，需要使用break标记。  \n> Last标记在本条rewrite规则执行完毕后，会对其所在server{......}标签重新发起请求.  \n> break标记则在本条规则匹配完成后，终止匹配。\n\n## Nginx配置文件\n\n```conf\n# nginx进程数，建议设置为等于CPU总核心数.\nworker_processes 8;\n\n# 全局错误日志定义类型，[ debug | info | notice | warn | error | crit ]\nerror_log /var/log/nginx/error.log info;\n\n# 进程文件\npid /var/run/nginx.pid;\n\n# 一个nginx进程打开的最多文件描述符数目，理论值应该是最多打开文件数（系统的值ulimit -n）与nginx进程数相除，但是nginx分配请求并不均匀，所以建议与ulimit -n的值保持一致。\nworker_rlimit_nofile 65535;\n\n# 工作模式与连接数上限\nevents\n{\n　　#参考事件模型，use [ kqueue | rtsig | epoll | /dev/poll | select | poll ]; epoll模型是Linux 2.6以上版本内核中的高性能网络I/O模型，如果跑在FreeBSD上面，就用kqueue模型。\n　　use epoll;\n　　#单个进程最大连接数（最大连接数=连接数*进程数）\n　　worker_connections 65535;\n}\n\n# 设定http服务器\nhttp\n{\n\n    include mime.types; #文件扩展名与文件类型映射表\n    default_type application/octet-stream; #默认文件类型\n    #charset utf-8; #默认编码\n    server_names_hash_bucket_size 128; #服务器名字的hash表大小\n    client_header_buffer_size 32k; #上传文件大小限制\n    large_client_header_buffers 4 64k; #设定请求缓\n    client_max_body_size 8m; #设定请求缓\n    sendfile on; #开启高效文件传输模式，sendfile指令指定nginx是否调用sendfile函数来输出文件，对于普通应用设为 on，如果用来进行下载等应用磁盘IO重负载应用，可设置为off，以平衡磁盘与网络I/O处理速度，降低系统的负载。注意：如果图片显示不正常把这个改成off。\n    autoindex on; #开启目录列表访问，合适下载服务器，默认关闭。\n    tcp_nopush on; #防止网络阻塞\n    tcp_nodelay on; #防止网络阻塞\n    keepalive_timeout 120; #长连接超时时间，单位是秒\n\n    #FastCGI相关参数是为了改善网站的性能：减少资源占用，提高访问速度。下面参数看字面意思都能理解。\n    fastcgi_connect_timeout 300;\n    fastcgi_send_timeout 300;\n    fastcgi_read_timeout 300;\n    fastcgi_buffer_size 64k;\n    fastcgi_buffers 4 64k;\n    fastcgi_busy_buffers_size 128k;\n    fastcgi_temp_file_write_size 128k;\n\n    #gzip模块设置\n    gzip on; #开启gzip压缩输出\n    gzip_min_length 1k; #最小压缩文件大小\n    gzip_buffers 4 16k; #压缩缓冲区\n    gzip_http_version 1.0; #压缩版本（默认1.1，前端如果是squid2.5请使用1.0）\n    gzip_comp_level 2; #压缩等级\n    gzip_types text/plain application/x-javascript text/css application/xml;\n    #压缩类型，默认就已经包含text/html，所以下面就不用再写了，写上去也不会有问题，但是会有一个warn。\n    gzip_vary on;\n    #limit_zone crawler $binary_remote_addr 10m; #开启限制IP连接数的时候需要使用\n\n    # 应用 myblog 是容器网络中的昵称\n    upstream blogs {\n        #upstream的负载均衡，weight是权重，可以根据机器配置定义权重。weigth参数表示权值，权值越高被分配到的几率越大。\n        # 单台机器 weight 设置无意义\n        server myblog:3001 weight=3;\n    }\n\n    # 虚拟主机的配置\n    server\n    {\n\n        listen 80;　　　　#监听端口\n\n        server_name aa.cn www.aa.cn ; #server_name end  #域名可以有多个，用空格隔开\n\n        index index.html index.htm index.php;  # 设置访问主页\n\n        set $subdomain '';  # 绑定目录为二级域名 bbb.aa.com  根目录 /bbb  文件夹\n\n        if ( $host ~* \"(?:(\\w+\\.){0,})(\\b(?!www\\b)\\w+)\\.\\b(?!(com|org|gov|net|cn)\\b)\\w+\\.[a-zA-Z]+\" )\n        {\n            set $subdomain \"/$2\";\n        }\n\n        root /home/wwwroot/aa.cn/web$subdomain;# 访问域名跟目录  \n\n        include rewrite/dedecms.conf; #rewrite end   #载入其他配置文件\n\n\n        location ~ .*.(php|php5)?$\n        {\n        　　fastcgi_pass 127.0.0.1:9000;\n        　　fastcgi_index index.php;\n        　　include fastcgi.conf;\n        }\n        #图片缓存时间设置\n        location ~ .*.(gif|jpg|jpeg|png|bmp|swf)$\n        {\n        　　expires 10d;\n        }\n        #JS和CSS缓存时间设置\n        location ~ .*.(js|css)?$\n        {\n        　　expires 1h;\n        }\n\n    }\n\n    # 日志格式设定\n\n    log_format access '$remote_addr - $remote_user [$time_local] \"$request\" '\n    '$status $body_bytes_sent \"$http_referer\" '\n    '\"$http_user_agent\" $http_x_forwarded_for';\n    #定义本虚拟主机的访问日志\n    access_log /var/log/nginx/ha97access.log access;\n\n    #对 \"/\" 启用反向代理\n    location / {\n\n        proxy_pass http://127.0.0.1:88;\n        proxy_redirect off;\n        proxy_set_header X-Real-IP $remote_addr;\n        #后端的Web服务器可以通过X-Forwarded-For获取用户真实IP\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        #以下是一些反向代理的配置，可选。\n        proxy_set_header Host $host;\n        client_max_body_size 10m; #允许客户端请求的最大单文件字节数\n        client_body_buffer_size 128k; #缓冲区代理缓冲用户端请求的最大字节数，\n        proxy_connect_timeout 90; #nginx跟后端服务器连接超时时间(代理连接超时)\n        proxy_send_timeout 90; #后端服务器数据回传时间(代理发送超时)\n        proxy_read_timeout 90; #连接成功后，后端服务器响应时间(代理接收超时)\n        proxy_buffer_size 4k; #设置代理服务器（nginx）保存用户头信息的缓冲区大小\n        proxy_buffers 4 32k; #proxy_buffers缓冲区，网页平均在32k以下的设置\n        proxy_busy_buffers_size 64k; #高负荷下缓冲大小（proxy_buffers*2）\n        proxy_temp_file_write_size 64k;\n        #设定缓存文件夹大小，大于这个值，将从upstream服务器传\n\n    }\n\n    # 设定查看Nginx状态的地址\n    location /NginxStatus {\n\n        stub_status on;\n        access_log on;\n        auth_basic \"NginxStatus\";\n        auth_basic_user_file conf/htpasswd;\n        #htpasswd文件的内容可以用apache提供的htpasswd工具来产生。\n\n    }\n\n    #本地动静分离反向代理配置\n    #所有jsp的页面均交由tomcat或resin处理\n    location ~ .(jsp|jspx|do)?$ {\n\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_pass http://127.0.0.1:8080;\n\n    }\n    #所有静态文件由nginx直接读取不经过tomcat或resin\n    location ~ .*.(htm|html|gif|jpg|jpeg|png|bmp|swf|ioc|rar|zip|txt|flv|mid|doc|ppt|pdf|xls|mp3|wma)$\n    {\n        expires 15d;\n    }\n    location ~ .*.(js|css)?$\n    {\n        expires 1h;\n    }\n\n}\n```\n\n### 使用记录\n\n#### nginx热更新\n\n在docker中,实现nginx热更新 `docker exec -i [nginx容器名/id] nginx -s reload`\n\n### nginx 日志配置\n\n[日志配置 参考](https://www.cnblogs.com/biglittleant/p/8979856.html)\n\n## 进阶使用\n\n再文章开始, 我们使用docker安装nginx, 我们完全使用了nginx官方的默认配置, 这里我们将使用自定义配置来启动nginx\n\n首先我们得知道 nginx 官方 docker 镜像得conf文件位置在哪\n\n我得nginx版本conf文件在: /etc/nginx/nginx.conf (可能不同版本的配置文件会有所不同, 所以我们在拉取镜像的时候最好固定版本)\n\n## 相关链接\n\n[Nginx配置文件nginx.conf详解](https://www.cnblogs.com/xuey/p/7631690.html)\n\n[nginx的location配置详解](https://www.cnblogs.com/sign-ptk/p/6723048.html)\n\n## 结语\n\n","slug":"nginx","published":1,"updated":"2019-09-17T01:05:07.702Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck550trls000mhm62rati9dc9","content":"<p>Nginx是一个<strong>轻量级的高性能</strong>HTTP和反向代理服务器, 由俄罗斯人 <strong>伊戈尔·赛索耶夫</strong></p>\n<blockquote>\n<p>这是一个学习笔记, 我想它应该不需要那么详细</p>\n</blockquote>\n<h2 id=\"安装-Nginx\"><a href=\"#安装-Nginx\" class=\"headerlink\" title=\"安装 Nginx\"></a>安装 Nginx</h2><p>我们既然学习了Docker, 那就要使用Docker</p>\n<p>使用 Docker 安装 Nginx</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 从docker hub中查找nginx</span></span><br><span class=\"line\">docker search nginx</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 拉取nginx官方最新稳定版 nginx 镜像</span></span><br><span class=\"line\">docker pull nginx</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 启动 nginx 镜像</span></span><br><span class=\"line\">docker run -d -p 80:80 --name nginx nginx</span><br></pre></td></tr></table></figure>\n<h2 id=\"Nginx基本概念\"><a href=\"#Nginx基本概念\" class=\"headerlink\" title=\"Nginx基本概念\"></a>Nginx基本概念</h2><h3 id=\"正则表达式\"><a href=\"#正则表达式\" class=\"headerlink\" title=\"正则表达式\"></a>正则表达式</h3><ol>\n<li>~  表示执行一个正则匹配，区分大小写</li>\n<li>~* 表示执行一个正则匹配，不区分大小写</li>\n<li>^~ 表示普通字符匹配。使用前缀匹配。如果匹配成功，则不再匹配其他location。</li>\n<li>=  进行普通字符精确匹配。也就是完全匹配。</li>\n<li>@  它定义一个命名的 location，使用在内部定向时，例如 error_page, try_files</li>\n</ol>\n<h3 id=\"匹配规则优先级\"><a href=\"#匹配规则优先级\" class=\"headerlink\" title=\"匹配规则优先级\"></a>匹配规则优先级</h3><ol>\n<li>等号类型（=）的优先级最高。一旦匹配成功，则不再查找其他匹配项。</li>\n<li>^~类型表达式。一旦匹配成功，则不再查找其他匹配项。</li>\n<li>正则表达式类型（~ ~*）的优先级次之。如果有多个location的正则能匹配的话，则使用正则表达式最长的那个。</li>\n<li>常规字符串匹配类型。按前缀匹配。</li>\n</ol>\n<h3 id=\"文件及目录匹配\"><a href=\"#文件及目录匹配\" class=\"headerlink\" title=\"文件及目录匹配\"></a>文件及目录匹配</h3><ol>\n<li>-f和!-f用来判断是否存在文件</li>\n<li>-d和!-d用来判断是否存在目录</li>\n<li>-e和!-e用来判断是否存在文件或目录</li>\n<li>-x和!-x用来判断文件是否可执行</li>\n</ol>\n<h3 id=\"rewrite-重定向-指令的最后一项参数为flag标记，flag标记有\"><a href=\"#rewrite-重定向-指令的最后一项参数为flag标记，flag标记有\" class=\"headerlink\" title=\"rewrite(重定向)指令的最后一项参数为flag标记，flag标记有\"></a>rewrite(重定向)指令的最后一项参数为flag标记，flag标记有</h3><ol>\n<li>last 相当于apache里面的[L]标记，表示rewrite。</li>\n<li>break 本条规则匹配完成后，终止匹配，不再匹配后面的规则。</li>\n<li>redirect 返回302临时重定向，浏览器地址会显示跳转后的URL地址。</li>\n<li>permanent 返回301永久重定向，浏览器地址会显示跳转后的URL地址。</li>\n</ol>\n<blockquote>\n<p>使用last和break实现URI重写，浏览器地址栏不变。<br>使用alias指令必须用last标记;<br>使用proxy_pass指令时，需要使用break标记。<br>Last标记在本条rewrite规则执行完毕后，会对其所在server{……}标签重新发起请求.<br>break标记则在本条规则匹配完成后，终止匹配。</p>\n</blockquote>\n<h2 id=\"Nginx配置文件\"><a href=\"#Nginx配置文件\" class=\"headerlink\" title=\"Nginx配置文件\"></a>Nginx配置文件</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># nginx进程数，建议设置为等于CPU总核心数.</span><br><span class=\"line\">worker_processes 8;</span><br><span class=\"line\"></span><br><span class=\"line\"># 全局错误日志定义类型，[ debug | info | notice | warn | error | crit ]</span><br><span class=\"line\">error_log /var/log/nginx/error.log info;</span><br><span class=\"line\"></span><br><span class=\"line\"># 进程文件</span><br><span class=\"line\">pid /var/run/nginx.pid;</span><br><span class=\"line\"></span><br><span class=\"line\"># 一个nginx进程打开的最多文件描述符数目，理论值应该是最多打开文件数（系统的值ulimit -n）与nginx进程数相除，但是nginx分配请求并不均匀，所以建议与ulimit -n的值保持一致。</span><br><span class=\"line\">worker_rlimit_nofile 65535;</span><br><span class=\"line\"></span><br><span class=\"line\"># 工作模式与连接数上限</span><br><span class=\"line\">events</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">　　#参考事件模型，use [ kqueue | rtsig | epoll | /dev/poll | select | poll ]; epoll模型是Linux 2.6以上版本内核中的高性能网络I/O模型，如果跑在FreeBSD上面，就用kqueue模型。</span><br><span class=\"line\">　　use epoll;</span><br><span class=\"line\">　　#单个进程最大连接数（最大连接数=连接数*进程数）</span><br><span class=\"line\">　　worker_connections 65535;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"># 设定http服务器</span><br><span class=\"line\">http</span><br><span class=\"line\">&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    include mime.types; #文件扩展名与文件类型映射表</span><br><span class=\"line\">    default_type application/octet-stream; #默认文件类型</span><br><span class=\"line\">    #charset utf-8; #默认编码</span><br><span class=\"line\">    server_names_hash_bucket_size 128; #服务器名字的hash表大小</span><br><span class=\"line\">    client_header_buffer_size 32k; #上传文件大小限制</span><br><span class=\"line\">    large_client_header_buffers 4 64k; #设定请求缓</span><br><span class=\"line\">    client_max_body_size 8m; #设定请求缓</span><br><span class=\"line\">    sendfile on; #开启高效文件传输模式，sendfile指令指定nginx是否调用sendfile函数来输出文件，对于普通应用设为 on，如果用来进行下载等应用磁盘IO重负载应用，可设置为off，以平衡磁盘与网络I/O处理速度，降低系统的负载。注意：如果图片显示不正常把这个改成off。</span><br><span class=\"line\">    autoindex on; #开启目录列表访问，合适下载服务器，默认关闭。</span><br><span class=\"line\">    tcp_nopush on; #防止网络阻塞</span><br><span class=\"line\">    tcp_nodelay on; #防止网络阻塞</span><br><span class=\"line\">    keepalive_timeout 120; #长连接超时时间，单位是秒</span><br><span class=\"line\"></span><br><span class=\"line\">    #FastCGI相关参数是为了改善网站的性能：减少资源占用，提高访问速度。下面参数看字面意思都能理解。</span><br><span class=\"line\">    fastcgi_connect_timeout 300;</span><br><span class=\"line\">    fastcgi_send_timeout 300;</span><br><span class=\"line\">    fastcgi_read_timeout 300;</span><br><span class=\"line\">    fastcgi_buffer_size 64k;</span><br><span class=\"line\">    fastcgi_buffers 4 64k;</span><br><span class=\"line\">    fastcgi_busy_buffers_size 128k;</span><br><span class=\"line\">    fastcgi_temp_file_write_size 128k;</span><br><span class=\"line\"></span><br><span class=\"line\">    #gzip模块设置</span><br><span class=\"line\">    gzip on; #开启gzip压缩输出</span><br><span class=\"line\">    gzip_min_length 1k; #最小压缩文件大小</span><br><span class=\"line\">    gzip_buffers 4 16k; #压缩缓冲区</span><br><span class=\"line\">    gzip_http_version 1.0; #压缩版本（默认1.1，前端如果是squid2.5请使用1.0）</span><br><span class=\"line\">    gzip_comp_level 2; #压缩等级</span><br><span class=\"line\">    gzip_types text/plain application/x-javascript text/css application/xml;</span><br><span class=\"line\">    #压缩类型，默认就已经包含text/html，所以下面就不用再写了，写上去也不会有问题，但是会有一个warn。</span><br><span class=\"line\">    gzip_vary on;</span><br><span class=\"line\">    #limit_zone crawler $binary_remote_addr 10m; #开启限制IP连接数的时候需要使用</span><br><span class=\"line\"></span><br><span class=\"line\">    # 应用 myblog 是容器网络中的昵称</span><br><span class=\"line\">    upstream blogs &#123;</span><br><span class=\"line\">        #upstream的负载均衡，weight是权重，可以根据机器配置定义权重。weigth参数表示权值，权值越高被分配到的几率越大。</span><br><span class=\"line\">        # 单台机器 weight 设置无意义</span><br><span class=\"line\">        server myblog:3001 weight=3;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    # 虚拟主机的配置</span><br><span class=\"line\">    server</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        listen 80;　　　　#监听端口</span><br><span class=\"line\"></span><br><span class=\"line\">        server_name aa.cn www.aa.cn ; #server_name end  #域名可以有多个，用空格隔开</span><br><span class=\"line\"></span><br><span class=\"line\">        index index.html index.htm index.php;  # 设置访问主页</span><br><span class=\"line\"></span><br><span class=\"line\">        set $subdomain &apos;&apos;;  # 绑定目录为二级域名 bbb.aa.com  根目录 /bbb  文件夹</span><br><span class=\"line\"></span><br><span class=\"line\">        if ( $host ~* &quot;(?:(\\w+\\.)&#123;0,&#125;)(\\b(?!www\\b)\\w+)\\.\\b(?!(com|org|gov|net|cn)\\b)\\w+\\.[a-zA-Z]+&quot; )</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            set $subdomain &quot;/$2&quot;;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        root /home/wwwroot/aa.cn/web$subdomain;# 访问域名跟目录  </span><br><span class=\"line\"></span><br><span class=\"line\">        include rewrite/dedecms.conf; #rewrite end   #载入其他配置文件</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">        location ~ .*.(php|php5)?$</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">        　　fastcgi_pass 127.0.0.1:9000;</span><br><span class=\"line\">        　　fastcgi_index index.php;</span><br><span class=\"line\">        　　include fastcgi.conf;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        #图片缓存时间设置</span><br><span class=\"line\">        location ~ .*.(gif|jpg|jpeg|png|bmp|swf)$</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">        　　expires 10d;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        #JS和CSS缓存时间设置</span><br><span class=\"line\">        location ~ .*.(js|css)?$</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">        　　expires 1h;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    # 日志格式设定</span><br><span class=\"line\"></span><br><span class=\"line\">    log_format access &apos;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &apos;</span><br><span class=\"line\">    &apos;$status $body_bytes_sent &quot;$http_referer&quot; &apos;</span><br><span class=\"line\">    &apos;&quot;$http_user_agent&quot; $http_x_forwarded_for&apos;;</span><br><span class=\"line\">    #定义本虚拟主机的访问日志</span><br><span class=\"line\">    access_log /var/log/nginx/ha97access.log access;</span><br><span class=\"line\"></span><br><span class=\"line\">    #对 &quot;/&quot; 启用反向代理</span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        proxy_pass http://127.0.0.1:88;</span><br><span class=\"line\">        proxy_redirect off;</span><br><span class=\"line\">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class=\"line\">        #后端的Web服务器可以通过X-Forwarded-For获取用户真实IP</span><br><span class=\"line\">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class=\"line\">        #以下是一些反向代理的配置，可选。</span><br><span class=\"line\">        proxy_set_header Host $host;</span><br><span class=\"line\">        client_max_body_size 10m; #允许客户端请求的最大单文件字节数</span><br><span class=\"line\">        client_body_buffer_size 128k; #缓冲区代理缓冲用户端请求的最大字节数，</span><br><span class=\"line\">        proxy_connect_timeout 90; #nginx跟后端服务器连接超时时间(代理连接超时)</span><br><span class=\"line\">        proxy_send_timeout 90; #后端服务器数据回传时间(代理发送超时)</span><br><span class=\"line\">        proxy_read_timeout 90; #连接成功后，后端服务器响应时间(代理接收超时)</span><br><span class=\"line\">        proxy_buffer_size 4k; #设置代理服务器（nginx）保存用户头信息的缓冲区大小</span><br><span class=\"line\">        proxy_buffers 4 32k; #proxy_buffers缓冲区，网页平均在32k以下的设置</span><br><span class=\"line\">        proxy_busy_buffers_size 64k; #高负荷下缓冲大小（proxy_buffers*2）</span><br><span class=\"line\">        proxy_temp_file_write_size 64k;</span><br><span class=\"line\">        #设定缓存文件夹大小，大于这个值，将从upstream服务器传</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    # 设定查看Nginx状态的地址</span><br><span class=\"line\">    location /NginxStatus &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        stub_status on;</span><br><span class=\"line\">        access_log on;</span><br><span class=\"line\">        auth_basic &quot;NginxStatus&quot;;</span><br><span class=\"line\">        auth_basic_user_file conf/htpasswd;</span><br><span class=\"line\">        #htpasswd文件的内容可以用apache提供的htpasswd工具来产生。</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    #本地动静分离反向代理配置</span><br><span class=\"line\">    #所有jsp的页面均交由tomcat或resin处理</span><br><span class=\"line\">    location ~ .(jsp|jspx|do)?$ &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        proxy_set_header Host $host;</span><br><span class=\"line\">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class=\"line\">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class=\"line\">        proxy_pass http://127.0.0.1:8080;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    #所有静态文件由nginx直接读取不经过tomcat或resin</span><br><span class=\"line\">    location ~ .*.(htm|html|gif|jpg|jpeg|png|bmp|swf|ioc|rar|zip|txt|flv|mid|doc|ppt|pdf|xls|mp3|wma)$</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        expires 15d;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    location ~ .*.(js|css)?$</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        expires 1h;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"使用记录\"><a href=\"#使用记录\" class=\"headerlink\" title=\"使用记录\"></a>使用记录</h3><h4 id=\"nginx热更新\"><a href=\"#nginx热更新\" class=\"headerlink\" title=\"nginx热更新\"></a>nginx热更新</h4><p>在docker中,实现nginx热更新 <code>docker exec -i [nginx容器名/id] nginx -s reload</code></p>\n<h3 id=\"nginx-日志配置\"><a href=\"#nginx-日志配置\" class=\"headerlink\" title=\"nginx 日志配置\"></a>nginx 日志配置</h3><p><a href=\"https://www.cnblogs.com/biglittleant/p/8979856.html\" target=\"_blank\" rel=\"noopener\">日志配置 参考</a></p>\n<h2 id=\"进阶使用\"><a href=\"#进阶使用\" class=\"headerlink\" title=\"进阶使用\"></a>进阶使用</h2><p>再文章开始, 我们使用docker安装nginx, 我们完全使用了nginx官方的默认配置, 这里我们将使用自定义配置来启动nginx</p>\n<p>首先我们得知道 nginx 官方 docker 镜像得conf文件位置在哪</p>\n<p>我得nginx版本conf文件在: /etc/nginx/nginx.conf (可能不同版本的配置文件会有所不同, 所以我们在拉取镜像的时候最好固定版本)</p>\n<h2 id=\"相关链接\"><a href=\"#相关链接\" class=\"headerlink\" title=\"相关链接\"></a>相关链接</h2><p><a href=\"https://www.cnblogs.com/xuey/p/7631690.html\" target=\"_blank\" rel=\"noopener\">Nginx配置文件nginx.conf详解</a></p>\n<p><a href=\"https://www.cnblogs.com/sign-ptk/p/6723048.html\" target=\"_blank\" rel=\"noopener\">nginx的location配置详解</a></p>\n<h2 id=\"结语\"><a href=\"#结语\" class=\"headerlink\" title=\"结语\"></a>结语</h2>","site":{"data":{}},"excerpt":"","more":"<p>Nginx是一个<strong>轻量级的高性能</strong>HTTP和反向代理服务器, 由俄罗斯人 <strong>伊戈尔·赛索耶夫</strong></p>\n<blockquote>\n<p>这是一个学习笔记, 我想它应该不需要那么详细</p>\n</blockquote>\n<h2 id=\"安装-Nginx\"><a href=\"#安装-Nginx\" class=\"headerlink\" title=\"安装 Nginx\"></a>安装 Nginx</h2><p>我们既然学习了Docker, 那就要使用Docker</p>\n<p>使用 Docker 安装 Nginx</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 从docker hub中查找nginx</span></span><br><span class=\"line\">docker search nginx</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 拉取nginx官方最新稳定版 nginx 镜像</span></span><br><span class=\"line\">docker pull nginx</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 启动 nginx 镜像</span></span><br><span class=\"line\">docker run -d -p 80:80 --name nginx nginx</span><br></pre></td></tr></table></figure>\n<h2 id=\"Nginx基本概念\"><a href=\"#Nginx基本概念\" class=\"headerlink\" title=\"Nginx基本概念\"></a>Nginx基本概念</h2><h3 id=\"正则表达式\"><a href=\"#正则表达式\" class=\"headerlink\" title=\"正则表达式\"></a>正则表达式</h3><ol>\n<li>~  表示执行一个正则匹配，区分大小写</li>\n<li>~* 表示执行一个正则匹配，不区分大小写</li>\n<li>^~ 表示普通字符匹配。使用前缀匹配。如果匹配成功，则不再匹配其他location。</li>\n<li>=  进行普通字符精确匹配。也就是完全匹配。</li>\n<li>@  它定义一个命名的 location，使用在内部定向时，例如 error_page, try_files</li>\n</ol>\n<h3 id=\"匹配规则优先级\"><a href=\"#匹配规则优先级\" class=\"headerlink\" title=\"匹配规则优先级\"></a>匹配规则优先级</h3><ol>\n<li>等号类型（=）的优先级最高。一旦匹配成功，则不再查找其他匹配项。</li>\n<li>^~类型表达式。一旦匹配成功，则不再查找其他匹配项。</li>\n<li>正则表达式类型（~ ~*）的优先级次之。如果有多个location的正则能匹配的话，则使用正则表达式最长的那个。</li>\n<li>常规字符串匹配类型。按前缀匹配。</li>\n</ol>\n<h3 id=\"文件及目录匹配\"><a href=\"#文件及目录匹配\" class=\"headerlink\" title=\"文件及目录匹配\"></a>文件及目录匹配</h3><ol>\n<li>-f和!-f用来判断是否存在文件</li>\n<li>-d和!-d用来判断是否存在目录</li>\n<li>-e和!-e用来判断是否存在文件或目录</li>\n<li>-x和!-x用来判断文件是否可执行</li>\n</ol>\n<h3 id=\"rewrite-重定向-指令的最后一项参数为flag标记，flag标记有\"><a href=\"#rewrite-重定向-指令的最后一项参数为flag标记，flag标记有\" class=\"headerlink\" title=\"rewrite(重定向)指令的最后一项参数为flag标记，flag标记有\"></a>rewrite(重定向)指令的最后一项参数为flag标记，flag标记有</h3><ol>\n<li>last 相当于apache里面的[L]标记，表示rewrite。</li>\n<li>break 本条规则匹配完成后，终止匹配，不再匹配后面的规则。</li>\n<li>redirect 返回302临时重定向，浏览器地址会显示跳转后的URL地址。</li>\n<li>permanent 返回301永久重定向，浏览器地址会显示跳转后的URL地址。</li>\n</ol>\n<blockquote>\n<p>使用last和break实现URI重写，浏览器地址栏不变。<br>使用alias指令必须用last标记;<br>使用proxy_pass指令时，需要使用break标记。<br>Last标记在本条rewrite规则执行完毕后，会对其所在server{……}标签重新发起请求.<br>break标记则在本条规则匹配完成后，终止匹配。</p>\n</blockquote>\n<h2 id=\"Nginx配置文件\"><a href=\"#Nginx配置文件\" class=\"headerlink\" title=\"Nginx配置文件\"></a>Nginx配置文件</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># nginx进程数，建议设置为等于CPU总核心数.</span><br><span class=\"line\">worker_processes 8;</span><br><span class=\"line\"></span><br><span class=\"line\"># 全局错误日志定义类型，[ debug | info | notice | warn | error | crit ]</span><br><span class=\"line\">error_log /var/log/nginx/error.log info;</span><br><span class=\"line\"></span><br><span class=\"line\"># 进程文件</span><br><span class=\"line\">pid /var/run/nginx.pid;</span><br><span class=\"line\"></span><br><span class=\"line\"># 一个nginx进程打开的最多文件描述符数目，理论值应该是最多打开文件数（系统的值ulimit -n）与nginx进程数相除，但是nginx分配请求并不均匀，所以建议与ulimit -n的值保持一致。</span><br><span class=\"line\">worker_rlimit_nofile 65535;</span><br><span class=\"line\"></span><br><span class=\"line\"># 工作模式与连接数上限</span><br><span class=\"line\">events</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">　　#参考事件模型，use [ kqueue | rtsig | epoll | /dev/poll | select | poll ]; epoll模型是Linux 2.6以上版本内核中的高性能网络I/O模型，如果跑在FreeBSD上面，就用kqueue模型。</span><br><span class=\"line\">　　use epoll;</span><br><span class=\"line\">　　#单个进程最大连接数（最大连接数=连接数*进程数）</span><br><span class=\"line\">　　worker_connections 65535;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"># 设定http服务器</span><br><span class=\"line\">http</span><br><span class=\"line\">&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    include mime.types; #文件扩展名与文件类型映射表</span><br><span class=\"line\">    default_type application/octet-stream; #默认文件类型</span><br><span class=\"line\">    #charset utf-8; #默认编码</span><br><span class=\"line\">    server_names_hash_bucket_size 128; #服务器名字的hash表大小</span><br><span class=\"line\">    client_header_buffer_size 32k; #上传文件大小限制</span><br><span class=\"line\">    large_client_header_buffers 4 64k; #设定请求缓</span><br><span class=\"line\">    client_max_body_size 8m; #设定请求缓</span><br><span class=\"line\">    sendfile on; #开启高效文件传输模式，sendfile指令指定nginx是否调用sendfile函数来输出文件，对于普通应用设为 on，如果用来进行下载等应用磁盘IO重负载应用，可设置为off，以平衡磁盘与网络I/O处理速度，降低系统的负载。注意：如果图片显示不正常把这个改成off。</span><br><span class=\"line\">    autoindex on; #开启目录列表访问，合适下载服务器，默认关闭。</span><br><span class=\"line\">    tcp_nopush on; #防止网络阻塞</span><br><span class=\"line\">    tcp_nodelay on; #防止网络阻塞</span><br><span class=\"line\">    keepalive_timeout 120; #长连接超时时间，单位是秒</span><br><span class=\"line\"></span><br><span class=\"line\">    #FastCGI相关参数是为了改善网站的性能：减少资源占用，提高访问速度。下面参数看字面意思都能理解。</span><br><span class=\"line\">    fastcgi_connect_timeout 300;</span><br><span class=\"line\">    fastcgi_send_timeout 300;</span><br><span class=\"line\">    fastcgi_read_timeout 300;</span><br><span class=\"line\">    fastcgi_buffer_size 64k;</span><br><span class=\"line\">    fastcgi_buffers 4 64k;</span><br><span class=\"line\">    fastcgi_busy_buffers_size 128k;</span><br><span class=\"line\">    fastcgi_temp_file_write_size 128k;</span><br><span class=\"line\"></span><br><span class=\"line\">    #gzip模块设置</span><br><span class=\"line\">    gzip on; #开启gzip压缩输出</span><br><span class=\"line\">    gzip_min_length 1k; #最小压缩文件大小</span><br><span class=\"line\">    gzip_buffers 4 16k; #压缩缓冲区</span><br><span class=\"line\">    gzip_http_version 1.0; #压缩版本（默认1.1，前端如果是squid2.5请使用1.0）</span><br><span class=\"line\">    gzip_comp_level 2; #压缩等级</span><br><span class=\"line\">    gzip_types text/plain application/x-javascript text/css application/xml;</span><br><span class=\"line\">    #压缩类型，默认就已经包含text/html，所以下面就不用再写了，写上去也不会有问题，但是会有一个warn。</span><br><span class=\"line\">    gzip_vary on;</span><br><span class=\"line\">    #limit_zone crawler $binary_remote_addr 10m; #开启限制IP连接数的时候需要使用</span><br><span class=\"line\"></span><br><span class=\"line\">    # 应用 myblog 是容器网络中的昵称</span><br><span class=\"line\">    upstream blogs &#123;</span><br><span class=\"line\">        #upstream的负载均衡，weight是权重，可以根据机器配置定义权重。weigth参数表示权值，权值越高被分配到的几率越大。</span><br><span class=\"line\">        # 单台机器 weight 设置无意义</span><br><span class=\"line\">        server myblog:3001 weight=3;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    # 虚拟主机的配置</span><br><span class=\"line\">    server</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        listen 80;　　　　#监听端口</span><br><span class=\"line\"></span><br><span class=\"line\">        server_name aa.cn www.aa.cn ; #server_name end  #域名可以有多个，用空格隔开</span><br><span class=\"line\"></span><br><span class=\"line\">        index index.html index.htm index.php;  # 设置访问主页</span><br><span class=\"line\"></span><br><span class=\"line\">        set $subdomain &apos;&apos;;  # 绑定目录为二级域名 bbb.aa.com  根目录 /bbb  文件夹</span><br><span class=\"line\"></span><br><span class=\"line\">        if ( $host ~* &quot;(?:(\\w+\\.)&#123;0,&#125;)(\\b(?!www\\b)\\w+)\\.\\b(?!(com|org|gov|net|cn)\\b)\\w+\\.[a-zA-Z]+&quot; )</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            set $subdomain &quot;/$2&quot;;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        root /home/wwwroot/aa.cn/web$subdomain;# 访问域名跟目录  </span><br><span class=\"line\"></span><br><span class=\"line\">        include rewrite/dedecms.conf; #rewrite end   #载入其他配置文件</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">        location ~ .*.(php|php5)?$</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">        　　fastcgi_pass 127.0.0.1:9000;</span><br><span class=\"line\">        　　fastcgi_index index.php;</span><br><span class=\"line\">        　　include fastcgi.conf;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        #图片缓存时间设置</span><br><span class=\"line\">        location ~ .*.(gif|jpg|jpeg|png|bmp|swf)$</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">        　　expires 10d;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        #JS和CSS缓存时间设置</span><br><span class=\"line\">        location ~ .*.(js|css)?$</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">        　　expires 1h;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    # 日志格式设定</span><br><span class=\"line\"></span><br><span class=\"line\">    log_format access &apos;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &apos;</span><br><span class=\"line\">    &apos;$status $body_bytes_sent &quot;$http_referer&quot; &apos;</span><br><span class=\"line\">    &apos;&quot;$http_user_agent&quot; $http_x_forwarded_for&apos;;</span><br><span class=\"line\">    #定义本虚拟主机的访问日志</span><br><span class=\"line\">    access_log /var/log/nginx/ha97access.log access;</span><br><span class=\"line\"></span><br><span class=\"line\">    #对 &quot;/&quot; 启用反向代理</span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        proxy_pass http://127.0.0.1:88;</span><br><span class=\"line\">        proxy_redirect off;</span><br><span class=\"line\">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class=\"line\">        #后端的Web服务器可以通过X-Forwarded-For获取用户真实IP</span><br><span class=\"line\">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class=\"line\">        #以下是一些反向代理的配置，可选。</span><br><span class=\"line\">        proxy_set_header Host $host;</span><br><span class=\"line\">        client_max_body_size 10m; #允许客户端请求的最大单文件字节数</span><br><span class=\"line\">        client_body_buffer_size 128k; #缓冲区代理缓冲用户端请求的最大字节数，</span><br><span class=\"line\">        proxy_connect_timeout 90; #nginx跟后端服务器连接超时时间(代理连接超时)</span><br><span class=\"line\">        proxy_send_timeout 90; #后端服务器数据回传时间(代理发送超时)</span><br><span class=\"line\">        proxy_read_timeout 90; #连接成功后，后端服务器响应时间(代理接收超时)</span><br><span class=\"line\">        proxy_buffer_size 4k; #设置代理服务器（nginx）保存用户头信息的缓冲区大小</span><br><span class=\"line\">        proxy_buffers 4 32k; #proxy_buffers缓冲区，网页平均在32k以下的设置</span><br><span class=\"line\">        proxy_busy_buffers_size 64k; #高负荷下缓冲大小（proxy_buffers*2）</span><br><span class=\"line\">        proxy_temp_file_write_size 64k;</span><br><span class=\"line\">        #设定缓存文件夹大小，大于这个值，将从upstream服务器传</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    # 设定查看Nginx状态的地址</span><br><span class=\"line\">    location /NginxStatus &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        stub_status on;</span><br><span class=\"line\">        access_log on;</span><br><span class=\"line\">        auth_basic &quot;NginxStatus&quot;;</span><br><span class=\"line\">        auth_basic_user_file conf/htpasswd;</span><br><span class=\"line\">        #htpasswd文件的内容可以用apache提供的htpasswd工具来产生。</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    #本地动静分离反向代理配置</span><br><span class=\"line\">    #所有jsp的页面均交由tomcat或resin处理</span><br><span class=\"line\">    location ~ .(jsp|jspx|do)?$ &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        proxy_set_header Host $host;</span><br><span class=\"line\">        proxy_set_header X-Real-IP $remote_addr;</span><br><span class=\"line\">        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br><span class=\"line\">        proxy_pass http://127.0.0.1:8080;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    #所有静态文件由nginx直接读取不经过tomcat或resin</span><br><span class=\"line\">    location ~ .*.(htm|html|gif|jpg|jpeg|png|bmp|swf|ioc|rar|zip|txt|flv|mid|doc|ppt|pdf|xls|mp3|wma)$</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        expires 15d;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    location ~ .*.(js|css)?$</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        expires 1h;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"使用记录\"><a href=\"#使用记录\" class=\"headerlink\" title=\"使用记录\"></a>使用记录</h3><h4 id=\"nginx热更新\"><a href=\"#nginx热更新\" class=\"headerlink\" title=\"nginx热更新\"></a>nginx热更新</h4><p>在docker中,实现nginx热更新 <code>docker exec -i [nginx容器名/id] nginx -s reload</code></p>\n<h3 id=\"nginx-日志配置\"><a href=\"#nginx-日志配置\" class=\"headerlink\" title=\"nginx 日志配置\"></a>nginx 日志配置</h3><p><a href=\"https://www.cnblogs.com/biglittleant/p/8979856.html\" target=\"_blank\" rel=\"noopener\">日志配置 参考</a></p>\n<h2 id=\"进阶使用\"><a href=\"#进阶使用\" class=\"headerlink\" title=\"进阶使用\"></a>进阶使用</h2><p>再文章开始, 我们使用docker安装nginx, 我们完全使用了nginx官方的默认配置, 这里我们将使用自定义配置来启动nginx</p>\n<p>首先我们得知道 nginx 官方 docker 镜像得conf文件位置在哪</p>\n<p>我得nginx版本conf文件在: /etc/nginx/nginx.conf (可能不同版本的配置文件会有所不同, 所以我们在拉取镜像的时候最好固定版本)</p>\n<h2 id=\"相关链接\"><a href=\"#相关链接\" class=\"headerlink\" title=\"相关链接\"></a>相关链接</h2><p><a href=\"https://www.cnblogs.com/xuey/p/7631690.html\" target=\"_blank\" rel=\"noopener\">Nginx配置文件nginx.conf详解</a></p>\n<p><a href=\"https://www.cnblogs.com/sign-ptk/p/6723048.html\" target=\"_blank\" rel=\"noopener\">nginx的location配置详解</a></p>\n<h2 id=\"结语\"><a href=\"#结语\" class=\"headerlink\" title=\"结语\"></a>结语</h2>"},{"title":"Python3 学习","date":"2019-07-04T07:16:11.000Z","_content":"\n本篇博客学习总结于[Python - 100天从新手到大师](https://github.com/jackfrued/Python-100-Days)\n\n## Python是一个“优雅”、“明确”、“简单”的编程语言\n\n给初学者的建议:\n\n1. Make English as your working language.\n2. Practice makes perfect.\n3. All experience comes from mistakes.\n4. Don't be one of the leeches.\n5. Either stand out or kicked out.\n\n## Python基础数据类型\n\n1. 整数\n2. 字符串\n3. 浮点数\n4. True/False\n5. None\n\n## Python数据结构\n\n1. List（列表）: 数组\n2. Tuple（元组）: 不可修改列表\n3. Set（集合）: 同数学中的集合, 不可重复, 可以技术 交集、并集、差集等运算\n4. Dictionary（字典）: 每一个元素都是由 “键值对” 组成\n\n## 字符串格式化代码\n\n参数|说明\n:----:|:----------------------------:\n%%|百分号标记\n%c|字符及其ASCII码\n%s|字符串\n%d|有符号整数(十进制)\n%u|无符号整数(十进制)\n%o|无符号整数(八进制)\n%x|无符号整数(十六进制)\n%X|无符号整数(十六进制大写字符)\n%e|浮点数字(科学计数法)\n%E|浮点数字(科学计数法，用E代替e)\n%f|浮点数字(用小数点符号)\n%g|浮点数字(根据值的大小采用%e或%f)\n%G|浮点数字(类似于%g)\n%p|指针(用十六进制打印值的内存地址)\n%n|存储输出字符的数量放进参数列表的下一个变量中\n\n## 算术运算符\n\n运算符|描述|实例\n:------:|:--------------------:|:----------:\n+|加 - 两个对象相加|a + b 输出结果 31\n-|减 - 得到负数或是一个数减去另一个数|a - b 输出结果 -11\n*|乘 - 两个数相乘或是返回一个被重复若干次的字符串|a * b 输出结果 210\n/|除 - x 除以 y|b / a 输出结果 2.1\n%|取模 - 返回除法的余数|b % a 输出结果 1\n**|幂 - 返回x的y次幂|a**b 为10的21次方\n//|取整除 - 向下取接近除数的整数|9//2 = 4; -9//2 = -5\n\n## 特殊运算符\n\n运算符|描述\n:-----:|:--------------------:\n&|在set求交集的时候,同set1.intersection(set2)\n\\||在set求并集的时候,同set1.union(set2)\n-|在set求差集的时候,同set1.difference(set2)\n^|在set求对称差的时候,同set1.symmetric_difference(set2)\n\n## 文件操作符\n\n### python内置的 `open` 函数\n\n操作模式|具体含义\n:----:|:--------------------:\n'r'|读取 （默认）\n'w'|写入（会先截断之前的内容）\n'x'|写入，如果文件已经存在会产生异常\n'a'|追加，将内容写入到已有文件的末尾\n'b'|二进制模式\n't'|文本模式（默认）\n'+'|更新（既可以读又可以写）\n\n### python的`JSON`模块\n\n常用的四个函数\n\n+ dump - 将Python对象按照JSON格式序列化到文件中\n+ dumps - 将Python对象处理成JSON格式的字符串\n+ load - 将文件中的JSON数据反序列化成对象\n+ loads - 将字符串的内容反序列化成Python对象\n\n这里出现了两个概念，一个叫序列化，一个叫反序列化。自由的百科全书维基百科上对这两个概念是这样解释的：“序列化（serialization）在计算机科学的数据处理中，是指将数据结构或对象状态转换为可以存储或传输的形式，这样在需要的时候能够恢复到原先的状态，而且通过序列化的数据重新获取字节时，可以利用这些字节来产生原始对象的副本（拷贝）。与这个过程相反的动作，即从一系列字节中提取数据结构的操作，就是反序列化（deserialization）”。\n\n### 实际操作\n\n```python\n#!/usr/local/bin/python3\n\"\"\"\n文件操作和异常处理及JSON数据\n\"\"\"\n\nimport json\n\n\ndef read():\n    \"\"\"读取文件\"\"\"\n    try:\n        fs = open('a.txt', 'r', encoding='utf-8')\n        print(fs.read())\n    except FileNotFoundError:\n        print('文件不存在')\n    finally:\n        if fs:\n            fs.close()\n\n\ndef writh(cmd='w'):\n    \"\"\"写文件\"\"\"\n    try:\n        txt = (x for x in range(600, 1000))\n        fs = open('b.txt', cmd, encoding='utf-8')\n        for t in txt:\n            fs.write(str(t) + '\\n')\n    except IOError:\n        print('IO异常')\n    finally:\n        if fs:\n            fs.close()\n\n\ndef with_def():\n    \"\"\"\n    使用with关键字,指定文件对象的上下文环境并在离开上下文环境时自动释放文件资源\n    \"\"\"\n    try:\n        \"\"\"一次读取所有文件\"\"\"\n        with open('a.txt', 'r', encoding='utf-8') as f1:\n            print(f1.read())\n\n        \"\"\"使用for-in逐行读取\"\"\"\n        with open('a.txt', encoding='utf-8', mode='r') as f2:\n            for line in f2:\n                print(line, end='')\n    except Exception:\n        print('错误', Exception)\n\n\ndef buffer_file_def():\n    \"\"\"读取二进制文件(拷贝图片)\"\"\"\n    try:\n        \"\"\"复制文件\"\"\"\n        with open('/Users/aolei/Pictures/my images/32916897.jpg', mode='rb') as f:\n            data = f.read()\n            print(data)\n\n        \"\"\"粘贴到当前目录下\"\"\"\n        with open('head.jpg', mode='wb') as f:\n            f.write(data)\n            print('Copy Success')\n    except FileNotFoundError :\n        print('文件不存在')\n    except UnicodeEncodeError:\n        print('编码异常')\n\n\ndef json_data_def():\n    \"\"\"python对json数据的处理\"\"\"\n    myuser = {\n        'name':'李黑',\n        'sex': '男',\n        'age': 0,\n        'qq': 957658,\n        'friends': ['王大锤', '白元芳'],\n        'cars': [\n            {'brand': 'BYD', 'max_speed': 180},\n            {'brand': 'Audi', 'max_speed': 280},\n            {'brand': 'Benz', 'max_speed': 320}\n        ]\n    }\n\n    try:\n        \"\"\"将python字典对象序列化为json文件\"\"\"\n        with open('users.json', 'w', encoding='utf-8') as f:\n            json.dump(myuser, f)\n\n        \"\"\"将json文件反序列化为python字典对象\"\"\"\n        with open('users.json', 'r', encoding = 'utf-8') as f:\n            curr_user = json.load(f)\n            print(curr_user)\n    except IOError:\n        print('文件写入失败')\n\n\nif __name__ == \"__main__\":\n    # read()\n    # writh('a')\n    # with_def()\n    # buffer_file_def()\n    json_data_def()\n```\n\n## 参考\n\n[《总结：Python中的异常处理》](https://segmentfault.com/a/1190000007736783 \"思否 - 总结：Python中的异常处理\")\n\n[HTTP协议入门](http://www.ruanyifeng.com/blog/2016/08/http.html \"阮一峰HTTP协议入门\")\n\n[聚合数据](https://www.juhe.cn/ \"聚合数据\")\n\n[阿凡达数据](https://www.avatardata.cn/ \"阿凡达数据\")\n\n## 结语\n\n> Don't be one of the leeches.\n\n![ ](./1.png)\n","source":"_posts/python3.md","raw":"---\ntitle: Python3 学习\ndate: 2019-07-04 15:16:11\ntags: 编程语言\n---\n\n本篇博客学习总结于[Python - 100天从新手到大师](https://github.com/jackfrued/Python-100-Days)\n\n## Python是一个“优雅”、“明确”、“简单”的编程语言\n\n给初学者的建议:\n\n1. Make English as your working language.\n2. Practice makes perfect.\n3. All experience comes from mistakes.\n4. Don't be one of the leeches.\n5. Either stand out or kicked out.\n\n## Python基础数据类型\n\n1. 整数\n2. 字符串\n3. 浮点数\n4. True/False\n5. None\n\n## Python数据结构\n\n1. List（列表）: 数组\n2. Tuple（元组）: 不可修改列表\n3. Set（集合）: 同数学中的集合, 不可重复, 可以技术 交集、并集、差集等运算\n4. Dictionary（字典）: 每一个元素都是由 “键值对” 组成\n\n## 字符串格式化代码\n\n参数|说明\n:----:|:----------------------------:\n%%|百分号标记\n%c|字符及其ASCII码\n%s|字符串\n%d|有符号整数(十进制)\n%u|无符号整数(十进制)\n%o|无符号整数(八进制)\n%x|无符号整数(十六进制)\n%X|无符号整数(十六进制大写字符)\n%e|浮点数字(科学计数法)\n%E|浮点数字(科学计数法，用E代替e)\n%f|浮点数字(用小数点符号)\n%g|浮点数字(根据值的大小采用%e或%f)\n%G|浮点数字(类似于%g)\n%p|指针(用十六进制打印值的内存地址)\n%n|存储输出字符的数量放进参数列表的下一个变量中\n\n## 算术运算符\n\n运算符|描述|实例\n:------:|:--------------------:|:----------:\n+|加 - 两个对象相加|a + b 输出结果 31\n-|减 - 得到负数或是一个数减去另一个数|a - b 输出结果 -11\n*|乘 - 两个数相乘或是返回一个被重复若干次的字符串|a * b 输出结果 210\n/|除 - x 除以 y|b / a 输出结果 2.1\n%|取模 - 返回除法的余数|b % a 输出结果 1\n**|幂 - 返回x的y次幂|a**b 为10的21次方\n//|取整除 - 向下取接近除数的整数|9//2 = 4; -9//2 = -5\n\n## 特殊运算符\n\n运算符|描述\n:-----:|:--------------------:\n&|在set求交集的时候,同set1.intersection(set2)\n\\||在set求并集的时候,同set1.union(set2)\n-|在set求差集的时候,同set1.difference(set2)\n^|在set求对称差的时候,同set1.symmetric_difference(set2)\n\n## 文件操作符\n\n### python内置的 `open` 函数\n\n操作模式|具体含义\n:----:|:--------------------:\n'r'|读取 （默认）\n'w'|写入（会先截断之前的内容）\n'x'|写入，如果文件已经存在会产生异常\n'a'|追加，将内容写入到已有文件的末尾\n'b'|二进制模式\n't'|文本模式（默认）\n'+'|更新（既可以读又可以写）\n\n### python的`JSON`模块\n\n常用的四个函数\n\n+ dump - 将Python对象按照JSON格式序列化到文件中\n+ dumps - 将Python对象处理成JSON格式的字符串\n+ load - 将文件中的JSON数据反序列化成对象\n+ loads - 将字符串的内容反序列化成Python对象\n\n这里出现了两个概念，一个叫序列化，一个叫反序列化。自由的百科全书维基百科上对这两个概念是这样解释的：“序列化（serialization）在计算机科学的数据处理中，是指将数据结构或对象状态转换为可以存储或传输的形式，这样在需要的时候能够恢复到原先的状态，而且通过序列化的数据重新获取字节时，可以利用这些字节来产生原始对象的副本（拷贝）。与这个过程相反的动作，即从一系列字节中提取数据结构的操作，就是反序列化（deserialization）”。\n\n### 实际操作\n\n```python\n#!/usr/local/bin/python3\n\"\"\"\n文件操作和异常处理及JSON数据\n\"\"\"\n\nimport json\n\n\ndef read():\n    \"\"\"读取文件\"\"\"\n    try:\n        fs = open('a.txt', 'r', encoding='utf-8')\n        print(fs.read())\n    except FileNotFoundError:\n        print('文件不存在')\n    finally:\n        if fs:\n            fs.close()\n\n\ndef writh(cmd='w'):\n    \"\"\"写文件\"\"\"\n    try:\n        txt = (x for x in range(600, 1000))\n        fs = open('b.txt', cmd, encoding='utf-8')\n        for t in txt:\n            fs.write(str(t) + '\\n')\n    except IOError:\n        print('IO异常')\n    finally:\n        if fs:\n            fs.close()\n\n\ndef with_def():\n    \"\"\"\n    使用with关键字,指定文件对象的上下文环境并在离开上下文环境时自动释放文件资源\n    \"\"\"\n    try:\n        \"\"\"一次读取所有文件\"\"\"\n        with open('a.txt', 'r', encoding='utf-8') as f1:\n            print(f1.read())\n\n        \"\"\"使用for-in逐行读取\"\"\"\n        with open('a.txt', encoding='utf-8', mode='r') as f2:\n            for line in f2:\n                print(line, end='')\n    except Exception:\n        print('错误', Exception)\n\n\ndef buffer_file_def():\n    \"\"\"读取二进制文件(拷贝图片)\"\"\"\n    try:\n        \"\"\"复制文件\"\"\"\n        with open('/Users/aolei/Pictures/my images/32916897.jpg', mode='rb') as f:\n            data = f.read()\n            print(data)\n\n        \"\"\"粘贴到当前目录下\"\"\"\n        with open('head.jpg', mode='wb') as f:\n            f.write(data)\n            print('Copy Success')\n    except FileNotFoundError :\n        print('文件不存在')\n    except UnicodeEncodeError:\n        print('编码异常')\n\n\ndef json_data_def():\n    \"\"\"python对json数据的处理\"\"\"\n    myuser = {\n        'name':'李黑',\n        'sex': '男',\n        'age': 0,\n        'qq': 957658,\n        'friends': ['王大锤', '白元芳'],\n        'cars': [\n            {'brand': 'BYD', 'max_speed': 180},\n            {'brand': 'Audi', 'max_speed': 280},\n            {'brand': 'Benz', 'max_speed': 320}\n        ]\n    }\n\n    try:\n        \"\"\"将python字典对象序列化为json文件\"\"\"\n        with open('users.json', 'w', encoding='utf-8') as f:\n            json.dump(myuser, f)\n\n        \"\"\"将json文件反序列化为python字典对象\"\"\"\n        with open('users.json', 'r', encoding = 'utf-8') as f:\n            curr_user = json.load(f)\n            print(curr_user)\n    except IOError:\n        print('文件写入失败')\n\n\nif __name__ == \"__main__\":\n    # read()\n    # writh('a')\n    # with_def()\n    # buffer_file_def()\n    json_data_def()\n```\n\n## 参考\n\n[《总结：Python中的异常处理》](https://segmentfault.com/a/1190000007736783 \"思否 - 总结：Python中的异常处理\")\n\n[HTTP协议入门](http://www.ruanyifeng.com/blog/2016/08/http.html \"阮一峰HTTP协议入门\")\n\n[聚合数据](https://www.juhe.cn/ \"聚合数据\")\n\n[阿凡达数据](https://www.avatardata.cn/ \"阿凡达数据\")\n\n## 结语\n\n> Don't be one of the leeches.\n\n![ ](./1.png)\n","slug":"python3","published":1,"updated":"2020-01-03T01:16:29.255Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck550trlt000phm624dbufqmo","content":"<p>本篇博客学习总结于<a href=\"https://github.com/jackfrued/Python-100-Days\" target=\"_blank\" rel=\"noopener\">Python - 100天从新手到大师</a></p>\n<h2 id=\"Python是一个“优雅”、“明确”、“简单”的编程语言\"><a href=\"#Python是一个“优雅”、“明确”、“简单”的编程语言\" class=\"headerlink\" title=\"Python是一个“优雅”、“明确”、“简单”的编程语言\"></a>Python是一个“优雅”、“明确”、“简单”的编程语言</h2><p>给初学者的建议:</p>\n<ol>\n<li>Make English as your working language.</li>\n<li>Practice makes perfect.</li>\n<li>All experience comes from mistakes.</li>\n<li>Don’t be one of the leeches.</li>\n<li>Either stand out or kicked out.</li>\n</ol>\n<h2 id=\"Python基础数据类型\"><a href=\"#Python基础数据类型\" class=\"headerlink\" title=\"Python基础数据类型\"></a>Python基础数据类型</h2><ol>\n<li>整数</li>\n<li>字符串</li>\n<li>浮点数</li>\n<li>True/False</li>\n<li>None</li>\n</ol>\n<h2 id=\"Python数据结构\"><a href=\"#Python数据结构\" class=\"headerlink\" title=\"Python数据结构\"></a>Python数据结构</h2><ol>\n<li>List（列表）: 数组</li>\n<li>Tuple（元组）: 不可修改列表</li>\n<li>Set（集合）: 同数学中的集合, 不可重复, 可以技术 交集、并集、差集等运算</li>\n<li>Dictionary（字典）: 每一个元素都是由 “键值对” 组成</li>\n</ol>\n<h2 id=\"字符串格式化代码\"><a href=\"#字符串格式化代码\" class=\"headerlink\" title=\"字符串格式化代码\"></a>字符串格式化代码</h2><table>\n<thead>\n<tr>\n<th style=\"text-align:center\">参数</th>\n<th style=\"text-align:center\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">%%</td>\n<td style=\"text-align:center\">百分号标记</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%c</td>\n<td style=\"text-align:center\">字符及其ASCII码</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%s</td>\n<td style=\"text-align:center\">字符串</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%d</td>\n<td style=\"text-align:center\">有符号整数(十进制)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%u</td>\n<td style=\"text-align:center\">无符号整数(十进制)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%o</td>\n<td style=\"text-align:center\">无符号整数(八进制)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%x</td>\n<td style=\"text-align:center\">无符号整数(十六进制)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%X</td>\n<td style=\"text-align:center\">无符号整数(十六进制大写字符)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%e</td>\n<td style=\"text-align:center\">浮点数字(科学计数法)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%E</td>\n<td style=\"text-align:center\">浮点数字(科学计数法，用E代替e)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%f</td>\n<td style=\"text-align:center\">浮点数字(用小数点符号)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%g</td>\n<td style=\"text-align:center\">浮点数字(根据值的大小采用%e或%f)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%G</td>\n<td style=\"text-align:center\">浮点数字(类似于%g)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%p</td>\n<td style=\"text-align:center\">指针(用十六进制打印值的内存地址)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%n</td>\n<td style=\"text-align:center\">存储输出字符的数量放进参数列表的下一个变量中</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"算术运算符\"><a href=\"#算术运算符\" class=\"headerlink\" title=\"算术运算符\"></a>算术运算符</h2><table>\n<thead>\n<tr>\n<th style=\"text-align:center\">运算符</th>\n<th style=\"text-align:center\">描述</th>\n<th style=\"text-align:center\">实例</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">+</td>\n<td style=\"text-align:center\">加 - 两个对象相加</td>\n<td style=\"text-align:center\">a + b 输出结果 31</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-</td>\n<td style=\"text-align:center\">减 - 得到负数或是一个数减去另一个数</td>\n<td style=\"text-align:center\">a - b 输出结果 -11</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">*</td>\n<td style=\"text-align:center\">乘 - 两个数相乘或是返回一个被重复若干次的字符串</td>\n<td style=\"text-align:center\">a * b 输出结果 210</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">/</td>\n<td style=\"text-align:center\">除 - x 除以 y</td>\n<td style=\"text-align:center\">b / a 输出结果 2.1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%</td>\n<td style=\"text-align:center\">取模 - 返回除法的余数</td>\n<td style=\"text-align:center\">b % a 输出结果 1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">**</td>\n<td style=\"text-align:center\">幂 - 返回x的y次幂</td>\n<td style=\"text-align:center\">a**b 为10的21次方</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">//</td>\n<td style=\"text-align:center\">取整除 - 向下取接近除数的整数</td>\n<td style=\"text-align:center\">9//2 = 4; -9//2 = -5</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"特殊运算符\"><a href=\"#特殊运算符\" class=\"headerlink\" title=\"特殊运算符\"></a>特殊运算符</h2><table>\n<thead>\n<tr>\n<th style=\"text-align:center\">运算符</th>\n<th style=\"text-align:center\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">&amp;</td>\n<td style=\"text-align:center\">在set求交集的时候,同set1.intersection(set2)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">\\</td>\n<td style=\"text-align:center\"></td>\n<td>在set求并集的时候,同set1.union(set2)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-</td>\n<td style=\"text-align:center\">在set求差集的时候,同set1.difference(set2)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">^</td>\n<td style=\"text-align:center\">在set求对称差的时候,同set1.symmetric_difference(set2)</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"文件操作符\"><a href=\"#文件操作符\" class=\"headerlink\" title=\"文件操作符\"></a>文件操作符</h2><h3 id=\"python内置的-open-函数\"><a href=\"#python内置的-open-函数\" class=\"headerlink\" title=\"python内置的 open 函数\"></a>python内置的 <code>open</code> 函数</h3><table>\n<thead>\n<tr>\n<th style=\"text-align:center\">操作模式</th>\n<th style=\"text-align:center\">具体含义</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">‘r’</td>\n<td style=\"text-align:center\">读取 （默认）</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">‘w’</td>\n<td style=\"text-align:center\">写入（会先截断之前的内容）</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">‘x’</td>\n<td style=\"text-align:center\">写入，如果文件已经存在会产生异常</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">‘a’</td>\n<td style=\"text-align:center\">追加，将内容写入到已有文件的末尾</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">‘b’</td>\n<td style=\"text-align:center\">二进制模式</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">‘t’</td>\n<td style=\"text-align:center\">文本模式（默认）</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">‘+’</td>\n<td style=\"text-align:center\">更新（既可以读又可以写）</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"python的JSON模块\"><a href=\"#python的JSON模块\" class=\"headerlink\" title=\"python的JSON模块\"></a>python的<code>JSON</code>模块</h3><p>常用的四个函数</p>\n<ul>\n<li>dump - 将Python对象按照JSON格式序列化到文件中</li>\n<li>dumps - 将Python对象处理成JSON格式的字符串</li>\n<li>load - 将文件中的JSON数据反序列化成对象</li>\n<li>loads - 将字符串的内容反序列化成Python对象</li>\n</ul>\n<p>这里出现了两个概念，一个叫序列化，一个叫反序列化。自由的百科全书维基百科上对这两个概念是这样解释的：“序列化（serialization）在计算机科学的数据处理中，是指将数据结构或对象状态转换为可以存储或传输的形式，这样在需要的时候能够恢复到原先的状态，而且通过序列化的数据重新获取字节时，可以利用这些字节来产生原始对象的副本（拷贝）。与这个过程相反的动作，即从一系列字节中提取数据结构的操作，就是反序列化（deserialization）”。</p>\n<h3 id=\"实际操作\"><a href=\"#实际操作\" class=\"headerlink\" title=\"实际操作\"></a>实际操作</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/local/bin/python3</span></span><br><span class=\"line\"><span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">文件操作和异常处理及JSON数据</span></span><br><span class=\"line\"><span class=\"string\">\"\"\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> json</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">read</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    <span class=\"string\">\"\"\"读取文件\"\"\"</span></span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        fs = open(<span class=\"string\">'a.txt'</span>, <span class=\"string\">'r'</span>, encoding=<span class=\"string\">'utf-8'</span>)</span><br><span class=\"line\">        print(fs.read())</span><br><span class=\"line\">    <span class=\"keyword\">except</span> FileNotFoundError:</span><br><span class=\"line\">        print(<span class=\"string\">'文件不存在'</span>)</span><br><span class=\"line\">    <span class=\"keyword\">finally</span>:</span><br><span class=\"line\">        <span class=\"keyword\">if</span> fs:</span><br><span class=\"line\">            fs.close()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">writh</span><span class=\"params\">(cmd=<span class=\"string\">'w'</span>)</span>:</span></span><br><span class=\"line\">    <span class=\"string\">\"\"\"写文件\"\"\"</span></span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        txt = (x <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> range(<span class=\"number\">600</span>, <span class=\"number\">1000</span>))</span><br><span class=\"line\">        fs = open(<span class=\"string\">'b.txt'</span>, cmd, encoding=<span class=\"string\">'utf-8'</span>)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> t <span class=\"keyword\">in</span> txt:</span><br><span class=\"line\">            fs.write(str(t) + <span class=\"string\">'\\n'</span>)</span><br><span class=\"line\">    <span class=\"keyword\">except</span> IOError:</span><br><span class=\"line\">        print(<span class=\"string\">'IO异常'</span>)</span><br><span class=\"line\">    <span class=\"keyword\">finally</span>:</span><br><span class=\"line\">        <span class=\"keyword\">if</span> fs:</span><br><span class=\"line\">            fs.close()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">with_def</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">    使用with关键字,指定文件对象的上下文环境并在离开上下文环境时自动释放文件资源</span></span><br><span class=\"line\"><span class=\"string\">    \"\"\"</span></span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        <span class=\"string\">\"\"\"一次读取所有文件\"\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">with</span> open(<span class=\"string\">'a.txt'</span>, <span class=\"string\">'r'</span>, encoding=<span class=\"string\">'utf-8'</span>) <span class=\"keyword\">as</span> f1:</span><br><span class=\"line\">            print(f1.read())</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"string\">\"\"\"使用for-in逐行读取\"\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">with</span> open(<span class=\"string\">'a.txt'</span>, encoding=<span class=\"string\">'utf-8'</span>, mode=<span class=\"string\">'r'</span>) <span class=\"keyword\">as</span> f2:</span><br><span class=\"line\">            <span class=\"keyword\">for</span> line <span class=\"keyword\">in</span> f2:</span><br><span class=\"line\">                print(line, end=<span class=\"string\">''</span>)</span><br><span class=\"line\">    <span class=\"keyword\">except</span> Exception:</span><br><span class=\"line\">        print(<span class=\"string\">'错误'</span>, Exception)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">buffer_file_def</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    <span class=\"string\">\"\"\"读取二进制文件(拷贝图片)\"\"\"</span></span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        <span class=\"string\">\"\"\"复制文件\"\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">with</span> open(<span class=\"string\">'/Users/aolei/Pictures/my images/32916897.jpg'</span>, mode=<span class=\"string\">'rb'</span>) <span class=\"keyword\">as</span> f:</span><br><span class=\"line\">            data = f.read()</span><br><span class=\"line\">            print(data)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"string\">\"\"\"粘贴到当前目录下\"\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">with</span> open(<span class=\"string\">'head.jpg'</span>, mode=<span class=\"string\">'wb'</span>) <span class=\"keyword\">as</span> f:</span><br><span class=\"line\">            f.write(data)</span><br><span class=\"line\">            print(<span class=\"string\">'Copy Success'</span>)</span><br><span class=\"line\">    <span class=\"keyword\">except</span> FileNotFoundError :</span><br><span class=\"line\">        print(<span class=\"string\">'文件不存在'</span>)</span><br><span class=\"line\">    <span class=\"keyword\">except</span> UnicodeEncodeError:</span><br><span class=\"line\">        print(<span class=\"string\">'编码异常'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">json_data_def</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    <span class=\"string\">\"\"\"python对json数据的处理\"\"\"</span></span><br><span class=\"line\">    myuser = &#123;</span><br><span class=\"line\">        <span class=\"string\">'name'</span>:<span class=\"string\">'李黑'</span>,</span><br><span class=\"line\">        <span class=\"string\">'sex'</span>: <span class=\"string\">'男'</span>,</span><br><span class=\"line\">        <span class=\"string\">'age'</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"string\">'qq'</span>: <span class=\"number\">957658</span>,</span><br><span class=\"line\">        <span class=\"string\">'friends'</span>: [<span class=\"string\">'王大锤'</span>, <span class=\"string\">'白元芳'</span>],</span><br><span class=\"line\">        <span class=\"string\">'cars'</span>: [</span><br><span class=\"line\">            &#123;<span class=\"string\">'brand'</span>: <span class=\"string\">'BYD'</span>, <span class=\"string\">'max_speed'</span>: <span class=\"number\">180</span>&#125;,</span><br><span class=\"line\">            &#123;<span class=\"string\">'brand'</span>: <span class=\"string\">'Audi'</span>, <span class=\"string\">'max_speed'</span>: <span class=\"number\">280</span>&#125;,</span><br><span class=\"line\">            &#123;<span class=\"string\">'brand'</span>: <span class=\"string\">'Benz'</span>, <span class=\"string\">'max_speed'</span>: <span class=\"number\">320</span>&#125;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        <span class=\"string\">\"\"\"将python字典对象序列化为json文件\"\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">with</span> open(<span class=\"string\">'users.json'</span>, <span class=\"string\">'w'</span>, encoding=<span class=\"string\">'utf-8'</span>) <span class=\"keyword\">as</span> f:</span><br><span class=\"line\">            json.dump(myuser, f)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"string\">\"\"\"将json文件反序列化为python字典对象\"\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">with</span> open(<span class=\"string\">'users.json'</span>, <span class=\"string\">'r'</span>, encoding = <span class=\"string\">'utf-8'</span>) <span class=\"keyword\">as</span> f:</span><br><span class=\"line\">            curr_user = json.load(f)</span><br><span class=\"line\">            print(curr_user)</span><br><span class=\"line\">    <span class=\"keyword\">except</span> IOError:</span><br><span class=\"line\">        print(<span class=\"string\">'文件写入失败'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">\"__main__\"</span>:</span><br><span class=\"line\">    <span class=\"comment\"># read()</span></span><br><span class=\"line\">    <span class=\"comment\"># writh('a')</span></span><br><span class=\"line\">    <span class=\"comment\"># with_def()</span></span><br><span class=\"line\">    <span class=\"comment\"># buffer_file_def()</span></span><br><span class=\"line\">    json_data_def()</span><br></pre></td></tr></table></figure>\n<h2 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h2><p><a href=\"https://segmentfault.com/a/1190000007736783\" title=\"思否 - 总结：Python中的异常处理\" target=\"_blank\" rel=\"noopener\">《总结：Python中的异常处理》</a></p>\n<p><a href=\"http://www.ruanyifeng.com/blog/2016/08/http.html\" title=\"阮一峰HTTP协议入门\" target=\"_blank\" rel=\"noopener\">HTTP协议入门</a></p>\n<p><a href=\"https://www.juhe.cn/\" title=\"聚合数据\" target=\"_blank\" rel=\"noopener\">聚合数据</a></p>\n<p><a href=\"https://www.avatardata.cn/\" title=\"阿凡达数据\" target=\"_blank\" rel=\"noopener\">阿凡达数据</a></p>\n<h2 id=\"结语\"><a href=\"#结语\" class=\"headerlink\" title=\"结语\"></a>结语</h2><blockquote>\n<p>Don’t be one of the leeches.</p>\n</blockquote>\n<p><img src=\"./1.png\" alt=\" \"></p>\n","site":{"data":{}},"excerpt":"","more":"<p>本篇博客学习总结于<a href=\"https://github.com/jackfrued/Python-100-Days\" target=\"_blank\" rel=\"noopener\">Python - 100天从新手到大师</a></p>\n<h2 id=\"Python是一个“优雅”、“明确”、“简单”的编程语言\"><a href=\"#Python是一个“优雅”、“明确”、“简单”的编程语言\" class=\"headerlink\" title=\"Python是一个“优雅”、“明确”、“简单”的编程语言\"></a>Python是一个“优雅”、“明确”、“简单”的编程语言</h2><p>给初学者的建议:</p>\n<ol>\n<li>Make English as your working language.</li>\n<li>Practice makes perfect.</li>\n<li>All experience comes from mistakes.</li>\n<li>Don’t be one of the leeches.</li>\n<li>Either stand out or kicked out.</li>\n</ol>\n<h2 id=\"Python基础数据类型\"><a href=\"#Python基础数据类型\" class=\"headerlink\" title=\"Python基础数据类型\"></a>Python基础数据类型</h2><ol>\n<li>整数</li>\n<li>字符串</li>\n<li>浮点数</li>\n<li>True/False</li>\n<li>None</li>\n</ol>\n<h2 id=\"Python数据结构\"><a href=\"#Python数据结构\" class=\"headerlink\" title=\"Python数据结构\"></a>Python数据结构</h2><ol>\n<li>List（列表）: 数组</li>\n<li>Tuple（元组）: 不可修改列表</li>\n<li>Set（集合）: 同数学中的集合, 不可重复, 可以技术 交集、并集、差集等运算</li>\n<li>Dictionary（字典）: 每一个元素都是由 “键值对” 组成</li>\n</ol>\n<h2 id=\"字符串格式化代码\"><a href=\"#字符串格式化代码\" class=\"headerlink\" title=\"字符串格式化代码\"></a>字符串格式化代码</h2><table>\n<thead>\n<tr>\n<th style=\"text-align:center\">参数</th>\n<th style=\"text-align:center\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">%%</td>\n<td style=\"text-align:center\">百分号标记</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%c</td>\n<td style=\"text-align:center\">字符及其ASCII码</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%s</td>\n<td style=\"text-align:center\">字符串</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%d</td>\n<td style=\"text-align:center\">有符号整数(十进制)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%u</td>\n<td style=\"text-align:center\">无符号整数(十进制)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%o</td>\n<td style=\"text-align:center\">无符号整数(八进制)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%x</td>\n<td style=\"text-align:center\">无符号整数(十六进制)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%X</td>\n<td style=\"text-align:center\">无符号整数(十六进制大写字符)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%e</td>\n<td style=\"text-align:center\">浮点数字(科学计数法)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%E</td>\n<td style=\"text-align:center\">浮点数字(科学计数法，用E代替e)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%f</td>\n<td style=\"text-align:center\">浮点数字(用小数点符号)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%g</td>\n<td style=\"text-align:center\">浮点数字(根据值的大小采用%e或%f)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%G</td>\n<td style=\"text-align:center\">浮点数字(类似于%g)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%p</td>\n<td style=\"text-align:center\">指针(用十六进制打印值的内存地址)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%n</td>\n<td style=\"text-align:center\">存储输出字符的数量放进参数列表的下一个变量中</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"算术运算符\"><a href=\"#算术运算符\" class=\"headerlink\" title=\"算术运算符\"></a>算术运算符</h2><table>\n<thead>\n<tr>\n<th style=\"text-align:center\">运算符</th>\n<th style=\"text-align:center\">描述</th>\n<th style=\"text-align:center\">实例</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">+</td>\n<td style=\"text-align:center\">加 - 两个对象相加</td>\n<td style=\"text-align:center\">a + b 输出结果 31</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-</td>\n<td style=\"text-align:center\">减 - 得到负数或是一个数减去另一个数</td>\n<td style=\"text-align:center\">a - b 输出结果 -11</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">*</td>\n<td style=\"text-align:center\">乘 - 两个数相乘或是返回一个被重复若干次的字符串</td>\n<td style=\"text-align:center\">a * b 输出结果 210</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">/</td>\n<td style=\"text-align:center\">除 - x 除以 y</td>\n<td style=\"text-align:center\">b / a 输出结果 2.1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%</td>\n<td style=\"text-align:center\">取模 - 返回除法的余数</td>\n<td style=\"text-align:center\">b % a 输出结果 1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">**</td>\n<td style=\"text-align:center\">幂 - 返回x的y次幂</td>\n<td style=\"text-align:center\">a**b 为10的21次方</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">//</td>\n<td style=\"text-align:center\">取整除 - 向下取接近除数的整数</td>\n<td style=\"text-align:center\">9//2 = 4; -9//2 = -5</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"特殊运算符\"><a href=\"#特殊运算符\" class=\"headerlink\" title=\"特殊运算符\"></a>特殊运算符</h2><table>\n<thead>\n<tr>\n<th style=\"text-align:center\">运算符</th>\n<th style=\"text-align:center\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">&amp;</td>\n<td style=\"text-align:center\">在set求交集的时候,同set1.intersection(set2)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">\\</td>\n<td style=\"text-align:center\"></td>\n<td>在set求并集的时候,同set1.union(set2)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">-</td>\n<td style=\"text-align:center\">在set求差集的时候,同set1.difference(set2)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">^</td>\n<td style=\"text-align:center\">在set求对称差的时候,同set1.symmetric_difference(set2)</td>\n</tr>\n</tbody>\n</table>\n<h2 id=\"文件操作符\"><a href=\"#文件操作符\" class=\"headerlink\" title=\"文件操作符\"></a>文件操作符</h2><h3 id=\"python内置的-open-函数\"><a href=\"#python内置的-open-函数\" class=\"headerlink\" title=\"python内置的 open 函数\"></a>python内置的 <code>open</code> 函数</h3><table>\n<thead>\n<tr>\n<th style=\"text-align:center\">操作模式</th>\n<th style=\"text-align:center\">具体含义</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">‘r’</td>\n<td style=\"text-align:center\">读取 （默认）</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">‘w’</td>\n<td style=\"text-align:center\">写入（会先截断之前的内容）</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">‘x’</td>\n<td style=\"text-align:center\">写入，如果文件已经存在会产生异常</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">‘a’</td>\n<td style=\"text-align:center\">追加，将内容写入到已有文件的末尾</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">‘b’</td>\n<td style=\"text-align:center\">二进制模式</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">‘t’</td>\n<td style=\"text-align:center\">文本模式（默认）</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">‘+’</td>\n<td style=\"text-align:center\">更新（既可以读又可以写）</td>\n</tr>\n</tbody>\n</table>\n<h3 id=\"python的JSON模块\"><a href=\"#python的JSON模块\" class=\"headerlink\" title=\"python的JSON模块\"></a>python的<code>JSON</code>模块</h3><p>常用的四个函数</p>\n<ul>\n<li>dump - 将Python对象按照JSON格式序列化到文件中</li>\n<li>dumps - 将Python对象处理成JSON格式的字符串</li>\n<li>load - 将文件中的JSON数据反序列化成对象</li>\n<li>loads - 将字符串的内容反序列化成Python对象</li>\n</ul>\n<p>这里出现了两个概念，一个叫序列化，一个叫反序列化。自由的百科全书维基百科上对这两个概念是这样解释的：“序列化（serialization）在计算机科学的数据处理中，是指将数据结构或对象状态转换为可以存储或传输的形式，这样在需要的时候能够恢复到原先的状态，而且通过序列化的数据重新获取字节时，可以利用这些字节来产生原始对象的副本（拷贝）。与这个过程相反的动作，即从一系列字节中提取数据结构的操作，就是反序列化（deserialization）”。</p>\n<h3 id=\"实际操作\"><a href=\"#实际操作\" class=\"headerlink\" title=\"实际操作\"></a>实际操作</h3><figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#!/usr/local/bin/python3</span></span><br><span class=\"line\"><span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">文件操作和异常处理及JSON数据</span></span><br><span class=\"line\"><span class=\"string\">\"\"\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> json</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">read</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    <span class=\"string\">\"\"\"读取文件\"\"\"</span></span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        fs = open(<span class=\"string\">'a.txt'</span>, <span class=\"string\">'r'</span>, encoding=<span class=\"string\">'utf-8'</span>)</span><br><span class=\"line\">        print(fs.read())</span><br><span class=\"line\">    <span class=\"keyword\">except</span> FileNotFoundError:</span><br><span class=\"line\">        print(<span class=\"string\">'文件不存在'</span>)</span><br><span class=\"line\">    <span class=\"keyword\">finally</span>:</span><br><span class=\"line\">        <span class=\"keyword\">if</span> fs:</span><br><span class=\"line\">            fs.close()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">writh</span><span class=\"params\">(cmd=<span class=\"string\">'w'</span>)</span>:</span></span><br><span class=\"line\">    <span class=\"string\">\"\"\"写文件\"\"\"</span></span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        txt = (x <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> range(<span class=\"number\">600</span>, <span class=\"number\">1000</span>))</span><br><span class=\"line\">        fs = open(<span class=\"string\">'b.txt'</span>, cmd, encoding=<span class=\"string\">'utf-8'</span>)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> t <span class=\"keyword\">in</span> txt:</span><br><span class=\"line\">            fs.write(str(t) + <span class=\"string\">'\\n'</span>)</span><br><span class=\"line\">    <span class=\"keyword\">except</span> IOError:</span><br><span class=\"line\">        print(<span class=\"string\">'IO异常'</span>)</span><br><span class=\"line\">    <span class=\"keyword\">finally</span>:</span><br><span class=\"line\">        <span class=\"keyword\">if</span> fs:</span><br><span class=\"line\">            fs.close()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">with_def</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    <span class=\"string\">\"\"\"</span></span><br><span class=\"line\"><span class=\"string\">    使用with关键字,指定文件对象的上下文环境并在离开上下文环境时自动释放文件资源</span></span><br><span class=\"line\"><span class=\"string\">    \"\"\"</span></span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        <span class=\"string\">\"\"\"一次读取所有文件\"\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">with</span> open(<span class=\"string\">'a.txt'</span>, <span class=\"string\">'r'</span>, encoding=<span class=\"string\">'utf-8'</span>) <span class=\"keyword\">as</span> f1:</span><br><span class=\"line\">            print(f1.read())</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"string\">\"\"\"使用for-in逐行读取\"\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">with</span> open(<span class=\"string\">'a.txt'</span>, encoding=<span class=\"string\">'utf-8'</span>, mode=<span class=\"string\">'r'</span>) <span class=\"keyword\">as</span> f2:</span><br><span class=\"line\">            <span class=\"keyword\">for</span> line <span class=\"keyword\">in</span> f2:</span><br><span class=\"line\">                print(line, end=<span class=\"string\">''</span>)</span><br><span class=\"line\">    <span class=\"keyword\">except</span> Exception:</span><br><span class=\"line\">        print(<span class=\"string\">'错误'</span>, Exception)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">buffer_file_def</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    <span class=\"string\">\"\"\"读取二进制文件(拷贝图片)\"\"\"</span></span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        <span class=\"string\">\"\"\"复制文件\"\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">with</span> open(<span class=\"string\">'/Users/aolei/Pictures/my images/32916897.jpg'</span>, mode=<span class=\"string\">'rb'</span>) <span class=\"keyword\">as</span> f:</span><br><span class=\"line\">            data = f.read()</span><br><span class=\"line\">            print(data)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"string\">\"\"\"粘贴到当前目录下\"\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">with</span> open(<span class=\"string\">'head.jpg'</span>, mode=<span class=\"string\">'wb'</span>) <span class=\"keyword\">as</span> f:</span><br><span class=\"line\">            f.write(data)</span><br><span class=\"line\">            print(<span class=\"string\">'Copy Success'</span>)</span><br><span class=\"line\">    <span class=\"keyword\">except</span> FileNotFoundError :</span><br><span class=\"line\">        print(<span class=\"string\">'文件不存在'</span>)</span><br><span class=\"line\">    <span class=\"keyword\">except</span> UnicodeEncodeError:</span><br><span class=\"line\">        print(<span class=\"string\">'编码异常'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">json_data_def</span><span class=\"params\">()</span>:</span></span><br><span class=\"line\">    <span class=\"string\">\"\"\"python对json数据的处理\"\"\"</span></span><br><span class=\"line\">    myuser = &#123;</span><br><span class=\"line\">        <span class=\"string\">'name'</span>:<span class=\"string\">'李黑'</span>,</span><br><span class=\"line\">        <span class=\"string\">'sex'</span>: <span class=\"string\">'男'</span>,</span><br><span class=\"line\">        <span class=\"string\">'age'</span>: <span class=\"number\">0</span>,</span><br><span class=\"line\">        <span class=\"string\">'qq'</span>: <span class=\"number\">957658</span>,</span><br><span class=\"line\">        <span class=\"string\">'friends'</span>: [<span class=\"string\">'王大锤'</span>, <span class=\"string\">'白元芳'</span>],</span><br><span class=\"line\">        <span class=\"string\">'cars'</span>: [</span><br><span class=\"line\">            &#123;<span class=\"string\">'brand'</span>: <span class=\"string\">'BYD'</span>, <span class=\"string\">'max_speed'</span>: <span class=\"number\">180</span>&#125;,</span><br><span class=\"line\">            &#123;<span class=\"string\">'brand'</span>: <span class=\"string\">'Audi'</span>, <span class=\"string\">'max_speed'</span>: <span class=\"number\">280</span>&#125;,</span><br><span class=\"line\">            &#123;<span class=\"string\">'brand'</span>: <span class=\"string\">'Benz'</span>, <span class=\"string\">'max_speed'</span>: <span class=\"number\">320</span>&#125;</span><br><span class=\"line\">        ]</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">try</span>:</span><br><span class=\"line\">        <span class=\"string\">\"\"\"将python字典对象序列化为json文件\"\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">with</span> open(<span class=\"string\">'users.json'</span>, <span class=\"string\">'w'</span>, encoding=<span class=\"string\">'utf-8'</span>) <span class=\"keyword\">as</span> f:</span><br><span class=\"line\">            json.dump(myuser, f)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"string\">\"\"\"将json文件反序列化为python字典对象\"\"\"</span></span><br><span class=\"line\">        <span class=\"keyword\">with</span> open(<span class=\"string\">'users.json'</span>, <span class=\"string\">'r'</span>, encoding = <span class=\"string\">'utf-8'</span>) <span class=\"keyword\">as</span> f:</span><br><span class=\"line\">            curr_user = json.load(f)</span><br><span class=\"line\">            print(curr_user)</span><br><span class=\"line\">    <span class=\"keyword\">except</span> IOError:</span><br><span class=\"line\">        print(<span class=\"string\">'文件写入失败'</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">\"__main__\"</span>:</span><br><span class=\"line\">    <span class=\"comment\"># read()</span></span><br><span class=\"line\">    <span class=\"comment\"># writh('a')</span></span><br><span class=\"line\">    <span class=\"comment\"># with_def()</span></span><br><span class=\"line\">    <span class=\"comment\"># buffer_file_def()</span></span><br><span class=\"line\">    json_data_def()</span><br></pre></td></tr></table></figure>\n<h2 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h2><p><a href=\"https://segmentfault.com/a/1190000007736783\" title=\"思否 - 总结：Python中的异常处理\" target=\"_blank\" rel=\"noopener\">《总结：Python中的异常处理》</a></p>\n<p><a href=\"http://www.ruanyifeng.com/blog/2016/08/http.html\" title=\"阮一峰HTTP协议入门\" target=\"_blank\" rel=\"noopener\">HTTP协议入门</a></p>\n<p><a href=\"https://www.juhe.cn/\" title=\"聚合数据\" target=\"_blank\" rel=\"noopener\">聚合数据</a></p>\n<p><a href=\"https://www.avatardata.cn/\" title=\"阿凡达数据\" target=\"_blank\" rel=\"noopener\">阿凡达数据</a></p>\n<h2 id=\"结语\"><a href=\"#结语\" class=\"headerlink\" title=\"结语\"></a>结语</h2><blockquote>\n<p>Don’t be one of the leeches.</p>\n</blockquote>\n<p><img src=\"./1.png\" alt=\" \"></p>\n"},{"title":"小钢炮安装zerotier实现内网穿透","date":"2020-01-02T09:54:31.000Z","_content":"\n小钢炮安装zerotier实现内网穿透\n\n## 安装zerotier\n\n### 一、安装 entware\n\n为了安装最新版本的zerotier,我们需要先安装 *entware*\n\n执行\n\n```sh\nrm -rf /opt\n\nmkdir /opt\n\ncd /opt\n\nwget -O - http://bin.entware.net/aarch64-k3.10/installer/alternative.sh | sh\n```\n\n将自带opkg改名为opkg_bak暂时停用 灯大固件更新可以改回来免重装系统更新软件\n\nmv /usr/bin/opkg /usr/bin/opkg_bak\n\n### 二、配置entware环境变量\n\n`vim /etc/profile`\n\n直接在前面/usr/sbin:这行下直接添加下面两行并保存退出（ESC+:wq+Enter）\n\n`/opt/bin:/opt/sbin:`\n\n使配置生效\n\n`source /etc/profile`\n\n### 三、检查entware环境安装情况看是否报错\n\n```sh\nopkg update\n\nopkg list\n```\n\n### 四、安装zerotier\n\n`opkg install zerotier`\n\n启动zerotier\n\n`zerotier-one -d`\n\n查看服务状态\n\n`zerotier-one info`\n\n## 加入已有zerotier网络\n\n1. 登陆并打开你的zerotier网络管理页面\n2. 拷贝你的网络ID\n\n![ ](./CD65E8E75C1CBF3BF60AFBF278909ACD.jpg)\n\n加入网络 `zerotier-cli join <netowkr-id>`\n\n查看网络状态 `zerotier-cli listnetworks`\n\n## 设置开机自启\n\n创建 /etc/init.d/S60zerotier-one.sh 文件\n\n编辑为以下内容\n\n```sh\n\n#! /bin/sh\n\ncase \"$1\" in\n  start)\n    if ( pidof zerotier-one )\n    then echo \"ZeroTier-One is already running.\"\n    else\n        echo \"Starting ZeroTier-One\" ;\n        /opt/bin/zerotier-one -d ;\n        echo \"$(date) Started ZeroTier-One\" >> /opt/var/log/zerotier-one.log ;\n    fi\n    ;;\n  stop)\n    if ( pidof zerotier-one )\n    then\n        echo \"Stopping ZeroTier-One\";\n        killall zerotier-one\n        echo \"$(date) Stopped ZeroTier-One\" >> /opt/var/log/zerotier-one.log\n    else\n        echo \"ZeroTier-One was not running\" ;\n    fi\n    ;;\n  status)\n    if ( pidof zerotier-one )\n    then echo \"ZeroTier-One is running.\"\n    else echo \"ZeroTier-One is NOT running\"\n    fi\n    ;;\n  *)\n    echo \"Usage: /etc/init.d/zerotier-one {start|stop|status}\"\n    exit 1\n    ;;\nesac\n\nexit 0\n\n```\n\n**授予权限**\n\n`chmod 777 /etc/init.d/S60zerotier-one.sh`\n\n## 结束\n\n完成以上操作即可在小钢炮中安装zerotier并实现开机自启\n","source":"_posts/xgp-zerotier.md","raw":"---\ntitle: 小钢炮安装zerotier实现内网穿透\ndate: 2020-01-02 17:54:31\ntags: 小钢炮\n---\n\n小钢炮安装zerotier实现内网穿透\n\n## 安装zerotier\n\n### 一、安装 entware\n\n为了安装最新版本的zerotier,我们需要先安装 *entware*\n\n执行\n\n```sh\nrm -rf /opt\n\nmkdir /opt\n\ncd /opt\n\nwget -O - http://bin.entware.net/aarch64-k3.10/installer/alternative.sh | sh\n```\n\n将自带opkg改名为opkg_bak暂时停用 灯大固件更新可以改回来免重装系统更新软件\n\nmv /usr/bin/opkg /usr/bin/opkg_bak\n\n### 二、配置entware环境变量\n\n`vim /etc/profile`\n\n直接在前面/usr/sbin:这行下直接添加下面两行并保存退出（ESC+:wq+Enter）\n\n`/opt/bin:/opt/sbin:`\n\n使配置生效\n\n`source /etc/profile`\n\n### 三、检查entware环境安装情况看是否报错\n\n```sh\nopkg update\n\nopkg list\n```\n\n### 四、安装zerotier\n\n`opkg install zerotier`\n\n启动zerotier\n\n`zerotier-one -d`\n\n查看服务状态\n\n`zerotier-one info`\n\n## 加入已有zerotier网络\n\n1. 登陆并打开你的zerotier网络管理页面\n2. 拷贝你的网络ID\n\n![ ](./CD65E8E75C1CBF3BF60AFBF278909ACD.jpg)\n\n加入网络 `zerotier-cli join <netowkr-id>`\n\n查看网络状态 `zerotier-cli listnetworks`\n\n## 设置开机自启\n\n创建 /etc/init.d/S60zerotier-one.sh 文件\n\n编辑为以下内容\n\n```sh\n\n#! /bin/sh\n\ncase \"$1\" in\n  start)\n    if ( pidof zerotier-one )\n    then echo \"ZeroTier-One is already running.\"\n    else\n        echo \"Starting ZeroTier-One\" ;\n        /opt/bin/zerotier-one -d ;\n        echo \"$(date) Started ZeroTier-One\" >> /opt/var/log/zerotier-one.log ;\n    fi\n    ;;\n  stop)\n    if ( pidof zerotier-one )\n    then\n        echo \"Stopping ZeroTier-One\";\n        killall zerotier-one\n        echo \"$(date) Stopped ZeroTier-One\" >> /opt/var/log/zerotier-one.log\n    else\n        echo \"ZeroTier-One was not running\" ;\n    fi\n    ;;\n  status)\n    if ( pidof zerotier-one )\n    then echo \"ZeroTier-One is running.\"\n    else echo \"ZeroTier-One is NOT running\"\n    fi\n    ;;\n  *)\n    echo \"Usage: /etc/init.d/zerotier-one {start|stop|status}\"\n    exit 1\n    ;;\nesac\n\nexit 0\n\n```\n\n**授予权限**\n\n`chmod 777 /etc/init.d/S60zerotier-one.sh`\n\n## 结束\n\n完成以上操作即可在小钢炮中安装zerotier并实现开机自启\n","slug":"xgp-zerotier","published":1,"updated":"2020-01-02T10:12:13.643Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck550trlu000rhm62yqfg8trf","content":"<p>小钢炮安装zerotier实现内网穿透</p>\n<h2 id=\"安装zerotier\"><a href=\"#安装zerotier\" class=\"headerlink\" title=\"安装zerotier\"></a>安装zerotier</h2><h3 id=\"一、安装-entware\"><a href=\"#一、安装-entware\" class=\"headerlink\" title=\"一、安装 entware\"></a>一、安装 entware</h3><p>为了安装最新版本的zerotier,我们需要先安装 <em>entware</em></p>\n<p>执行</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rm -rf /opt</span><br><span class=\"line\"></span><br><span class=\"line\">mkdir /opt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">cd</span> /opt</span><br><span class=\"line\"></span><br><span class=\"line\">wget -O - http://bin.entware.net/aarch64-k3.10/installer/alternative.sh | sh</span><br></pre></td></tr></table></figure>\n<p>将自带opkg改名为opkg_bak暂时停用 灯大固件更新可以改回来免重装系统更新软件</p>\n<p>mv /usr/bin/opkg /usr/bin/opkg_bak</p>\n<h3 id=\"二、配置entware环境变量\"><a href=\"#二、配置entware环境变量\" class=\"headerlink\" title=\"二、配置entware环境变量\"></a>二、配置entware环境变量</h3><p><code>vim /etc/profile</code></p>\n<p>直接在前面/usr/sbin:这行下直接添加下面两行并保存退出（ESC+:wq+Enter）</p>\n<p><code>/opt/bin:/opt/sbin:</code></p>\n<p>使配置生效</p>\n<p><code>source /etc/profile</code></p>\n<h3 id=\"三、检查entware环境安装情况看是否报错\"><a href=\"#三、检查entware环境安装情况看是否报错\" class=\"headerlink\" title=\"三、检查entware环境安装情况看是否报错\"></a>三、检查entware环境安装情况看是否报错</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">opkg update</span><br><span class=\"line\"></span><br><span class=\"line\">opkg list</span><br></pre></td></tr></table></figure>\n<h3 id=\"四、安装zerotier\"><a href=\"#四、安装zerotier\" class=\"headerlink\" title=\"四、安装zerotier\"></a>四、安装zerotier</h3><p><code>opkg install zerotier</code></p>\n<p>启动zerotier</p>\n<p><code>zerotier-one -d</code></p>\n<p>查看服务状态</p>\n<p><code>zerotier-one info</code></p>\n<h2 id=\"加入已有zerotier网络\"><a href=\"#加入已有zerotier网络\" class=\"headerlink\" title=\"加入已有zerotier网络\"></a>加入已有zerotier网络</h2><ol>\n<li>登陆并打开你的zerotier网络管理页面</li>\n<li>拷贝你的网络ID</li>\n</ol>\n<p><img src=\"./CD65E8E75C1CBF3BF60AFBF278909ACD.jpg\" alt=\" \"></p>\n<p>加入网络 <code>zerotier-cli join &lt;netowkr-id&gt;</code></p>\n<p>查看网络状态 <code>zerotier-cli listnetworks</code></p>\n<h2 id=\"设置开机自启\"><a href=\"#设置开机自启\" class=\"headerlink\" title=\"设置开机自启\"></a>设置开机自启</h2><p>创建 /etc/init.d/S60zerotier-one.sh 文件</p>\n<p>编辑为以下内容</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#! /bin/sh</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">case</span> <span class=\"string\">\"<span class=\"variable\">$1</span>\"</span> <span class=\"keyword\">in</span></span><br><span class=\"line\">  start)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> ( pidof zerotier-one )</span><br><span class=\"line\">    <span class=\"keyword\">then</span> <span class=\"built_in\">echo</span> <span class=\"string\">\"ZeroTier-One is already running.\"</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"built_in\">echo</span> <span class=\"string\">\"Starting ZeroTier-One\"</span> ;</span><br><span class=\"line\">        /opt/bin/zerotier-one -d ;</span><br><span class=\"line\">        <span class=\"built_in\">echo</span> <span class=\"string\">\"<span class=\"variable\">$(date)</span> Started ZeroTier-One\"</span> &gt;&gt; /opt/var/<span class=\"built_in\">log</span>/zerotier-one.log ;</span><br><span class=\"line\">    <span class=\"keyword\">fi</span></span><br><span class=\"line\">    ;;</span><br><span class=\"line\">  stop)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> ( pidof zerotier-one )</span><br><span class=\"line\">    <span class=\"keyword\">then</span></span><br><span class=\"line\">        <span class=\"built_in\">echo</span> <span class=\"string\">\"Stopping ZeroTier-One\"</span>;</span><br><span class=\"line\">        killall zerotier-one</span><br><span class=\"line\">        <span class=\"built_in\">echo</span> <span class=\"string\">\"<span class=\"variable\">$(date)</span> Stopped ZeroTier-One\"</span> &gt;&gt; /opt/var/<span class=\"built_in\">log</span>/zerotier-one.log</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"built_in\">echo</span> <span class=\"string\">\"ZeroTier-One was not running\"</span> ;</span><br><span class=\"line\">    <span class=\"keyword\">fi</span></span><br><span class=\"line\">    ;;</span><br><span class=\"line\">  status)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> ( pidof zerotier-one )</span><br><span class=\"line\">    <span class=\"keyword\">then</span> <span class=\"built_in\">echo</span> <span class=\"string\">\"ZeroTier-One is running.\"</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"built_in\">echo</span> <span class=\"string\">\"ZeroTier-One is NOT running\"</span></span><br><span class=\"line\">    <span class=\"keyword\">fi</span></span><br><span class=\"line\">    ;;</span><br><span class=\"line\">  *)</span><br><span class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"Usage: /etc/init.d/zerotier-one &#123;start|stop|status&#125;\"</span></span><br><span class=\"line\">    <span class=\"built_in\">exit</span> 1</span><br><span class=\"line\">    ;;</span><br><span class=\"line\"><span class=\"keyword\">esac</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">exit</span> 0</span><br></pre></td></tr></table></figure>\n<p><strong>授予权限</strong></p>\n<p><code>chmod 777 /etc/init.d/S60zerotier-one.sh</code></p>\n<h2 id=\"结束\"><a href=\"#结束\" class=\"headerlink\" title=\"结束\"></a>结束</h2><p>完成以上操作即可在小钢炮中安装zerotier并实现开机自启</p>\n","site":{"data":{}},"excerpt":"","more":"<p>小钢炮安装zerotier实现内网穿透</p>\n<h2 id=\"安装zerotier\"><a href=\"#安装zerotier\" class=\"headerlink\" title=\"安装zerotier\"></a>安装zerotier</h2><h3 id=\"一、安装-entware\"><a href=\"#一、安装-entware\" class=\"headerlink\" title=\"一、安装 entware\"></a>一、安装 entware</h3><p>为了安装最新版本的zerotier,我们需要先安装 <em>entware</em></p>\n<p>执行</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rm -rf /opt</span><br><span class=\"line\"></span><br><span class=\"line\">mkdir /opt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">cd</span> /opt</span><br><span class=\"line\"></span><br><span class=\"line\">wget -O - http://bin.entware.net/aarch64-k3.10/installer/alternative.sh | sh</span><br></pre></td></tr></table></figure>\n<p>将自带opkg改名为opkg_bak暂时停用 灯大固件更新可以改回来免重装系统更新软件</p>\n<p>mv /usr/bin/opkg /usr/bin/opkg_bak</p>\n<h3 id=\"二、配置entware环境变量\"><a href=\"#二、配置entware环境变量\" class=\"headerlink\" title=\"二、配置entware环境变量\"></a>二、配置entware环境变量</h3><p><code>vim /etc/profile</code></p>\n<p>直接在前面/usr/sbin:这行下直接添加下面两行并保存退出（ESC+:wq+Enter）</p>\n<p><code>/opt/bin:/opt/sbin:</code></p>\n<p>使配置生效</p>\n<p><code>source /etc/profile</code></p>\n<h3 id=\"三、检查entware环境安装情况看是否报错\"><a href=\"#三、检查entware环境安装情况看是否报错\" class=\"headerlink\" title=\"三、检查entware环境安装情况看是否报错\"></a>三、检查entware环境安装情况看是否报错</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">opkg update</span><br><span class=\"line\"></span><br><span class=\"line\">opkg list</span><br></pre></td></tr></table></figure>\n<h3 id=\"四、安装zerotier\"><a href=\"#四、安装zerotier\" class=\"headerlink\" title=\"四、安装zerotier\"></a>四、安装zerotier</h3><p><code>opkg install zerotier</code></p>\n<p>启动zerotier</p>\n<p><code>zerotier-one -d</code></p>\n<p>查看服务状态</p>\n<p><code>zerotier-one info</code></p>\n<h2 id=\"加入已有zerotier网络\"><a href=\"#加入已有zerotier网络\" class=\"headerlink\" title=\"加入已有zerotier网络\"></a>加入已有zerotier网络</h2><ol>\n<li>登陆并打开你的zerotier网络管理页面</li>\n<li>拷贝你的网络ID</li>\n</ol>\n<p><img src=\"./CD65E8E75C1CBF3BF60AFBF278909ACD.jpg\" alt=\" \"></p>\n<p>加入网络 <code>zerotier-cli join &lt;netowkr-id&gt;</code></p>\n<p>查看网络状态 <code>zerotier-cli listnetworks</code></p>\n<h2 id=\"设置开机自启\"><a href=\"#设置开机自启\" class=\"headerlink\" title=\"设置开机自启\"></a>设置开机自启</h2><p>创建 /etc/init.d/S60zerotier-one.sh 文件</p>\n<p>编辑为以下内容</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#! /bin/sh</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">case</span> <span class=\"string\">\"<span class=\"variable\">$1</span>\"</span> <span class=\"keyword\">in</span></span><br><span class=\"line\">  start)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> ( pidof zerotier-one )</span><br><span class=\"line\">    <span class=\"keyword\">then</span> <span class=\"built_in\">echo</span> <span class=\"string\">\"ZeroTier-One is already running.\"</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"built_in\">echo</span> <span class=\"string\">\"Starting ZeroTier-One\"</span> ;</span><br><span class=\"line\">        /opt/bin/zerotier-one -d ;</span><br><span class=\"line\">        <span class=\"built_in\">echo</span> <span class=\"string\">\"<span class=\"variable\">$(date)</span> Started ZeroTier-One\"</span> &gt;&gt; /opt/var/<span class=\"built_in\">log</span>/zerotier-one.log ;</span><br><span class=\"line\">    <span class=\"keyword\">fi</span></span><br><span class=\"line\">    ;;</span><br><span class=\"line\">  stop)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> ( pidof zerotier-one )</span><br><span class=\"line\">    <span class=\"keyword\">then</span></span><br><span class=\"line\">        <span class=\"built_in\">echo</span> <span class=\"string\">\"Stopping ZeroTier-One\"</span>;</span><br><span class=\"line\">        killall zerotier-one</span><br><span class=\"line\">        <span class=\"built_in\">echo</span> <span class=\"string\">\"<span class=\"variable\">$(date)</span> Stopped ZeroTier-One\"</span> &gt;&gt; /opt/var/<span class=\"built_in\">log</span>/zerotier-one.log</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"built_in\">echo</span> <span class=\"string\">\"ZeroTier-One was not running\"</span> ;</span><br><span class=\"line\">    <span class=\"keyword\">fi</span></span><br><span class=\"line\">    ;;</span><br><span class=\"line\">  status)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> ( pidof zerotier-one )</span><br><span class=\"line\">    <span class=\"keyword\">then</span> <span class=\"built_in\">echo</span> <span class=\"string\">\"ZeroTier-One is running.\"</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"built_in\">echo</span> <span class=\"string\">\"ZeroTier-One is NOT running\"</span></span><br><span class=\"line\">    <span class=\"keyword\">fi</span></span><br><span class=\"line\">    ;;</span><br><span class=\"line\">  *)</span><br><span class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"Usage: /etc/init.d/zerotier-one &#123;start|stop|status&#125;\"</span></span><br><span class=\"line\">    <span class=\"built_in\">exit</span> 1</span><br><span class=\"line\">    ;;</span><br><span class=\"line\"><span class=\"keyword\">esac</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">exit</span> 0</span><br></pre></td></tr></table></figure>\n<p><strong>授予权限</strong></p>\n<p><code>chmod 777 /etc/init.d/S60zerotier-one.sh</code></p>\n<h2 id=\"结束\"><a href=\"#结束\" class=\"headerlink\" title=\"结束\"></a>结束</h2><p>完成以上操作即可在小钢炮中安装zerotier并实现开机自启</p>\n"},{"title":"mysql学习笔记","date":"2019-06-05T09:00:05.000Z","_content":"\n这篇文章主要是我日常使用mysql的一些记录\n我使用的mysql版本是:`5.7`\n\n## MySQL 相关文章\n\n[【链接】大牛总结的MySQL锁优化，写得太好了！](https://cloud.tencent.com/developer/news/456119)\n[【链接】一篇文章弄懂MySQL的事务隔离级别](https://mp.weixin.qq.com/s/p32Tc6XhbHq_NbJWAiZnhQ)\n\n## 用户\n\n### 创建用户\n\n```sh\ncreate user 'testuser'@'%' identified by 'password';\n```\n\n创建 `testuser` 用户, 可以在所有主机上登陆使用, 密码为`password`;\n\n1. testuser 是创建的用户名\n2. % 是主机名,指定哪些主机可以使用改用户\n   1. %/0.0.0.0 所有主机可以使用\n   2. localhost/127.0.0.1 本机可以使用\n   3. ...\n3. password 是创建的用户登陆密码, 如果指定为 `identified by ''` 则不设置密码\n\n### 删除用户\n\n```sh\ndrop user 'apollo'@'%';\n```\n\n### 用户权限\n\n#### 授予权限\n\n```sh\ngrant all on testdb.* to 'testuser'@'%';\ngrant select on testdb.* to 'testuser'@'%';\ngrant insert on testdb.* to 'testuser'@'%';\n```\n\n授予用户`testuser`在所有主机上使用`testdb`数据库下**所有表**的权限\n\n+ all 代表权限\n  + select 查询权限\n  + insert 插入权限\n  + delete 删除权限\n  + update 修改权限\n+ testdb.* 改数据库下的所有表\n+ 'testuser'@'%' 表示`testuser`在`%`主机可以使用授予的权限\n\n#### 刷新权限\n\n`flush privileges;`\n\n#### 删除权限\n\n```sh\nREVOKE ALL ON test.* FROM 'testuser'@'%';\nREVOKE select ON test.* FROM 'testuser'@'%';\nREVOKE insert ON test.* FROM 'testuser'@'%';\n```\n\n+ 删除所有权限\n+ 删除查询权限\n+ 删除插入权限\n\n#### 查看用户权限\n\n`SHOW GRANTS FOR 'testuser'@'%';`\n\n## 数据库\n\n### 基本语法\n\n#### 函数\n\n##### 类型转换函数\n\n用于类型转化 CAST()和CONVERT()\n\n```sh\nCAST(value as type);\nCONVERT(value, type);\n```\n\n可以转换的类型是有限制的。这个类型可以是以下值其中的一个：\n\n+ 二进制，同带binary前缀的效果 : BINARY\n+ 字符型，可带参数 : CHAR()\n+ 日期 : DATE\n+ 时间: TIME\n+ 日期时间型 : DATETIME\n+ 浮点数 : DECIMAL\n+ 整数 : SIGNED\n+ 无符号整数 : UNSIGNED\n\n示例:\n\n```sh\n# 1\nmysql> SELECT CONVERT('23',SIGNED);\n+----------------------+\n| CONVERT('23',SIGNED) |\n+----------------------+\n|                   23 |\n+----------------------+\n1 row in set\n\n# 2\nmysql> SELECT CAST('125e342.83' AS signed);\n+------------------------------+\n| CAST('125e342.83' AS signed) |\n+------------------------------+\n|                          125 |\n+------------------------------+\n1 row in set\n\n# 3\nmysql> SELECT CAST('3.35' AS signed);\n+------------------------+\n| CAST('3.35' AS signed) |\n+------------------------+\n|                      3 |\n+------------------------+\n1 row in set\n```\n\n##### 格式化函数\n\n##### 随机数 rand()\n\n```sh\nselect rand()\n```\n\n#### 时间\n\n##### 获取系统时间 `now()` 和 `sysdate()` 这两个函数的区别是, `now()`在执行前就确认了值, `sysdate()`在执行时动态确认值\n\n例子:\n\n```sh\n> select now(), sleep(3), now();\n> select sysdate(), sleep(3), sysdate();\n```\n\n> 感兴趣的可以看一下这两天sql执行的结果\n\n##### 获得当前时间戳函数：current_timestamp, current_timestamp()\n\n语法: `select current_timestamp, current_timestamp()`\n\n##### 日期、时间转换\n\n时间转换为字符串 date_format(date,format), time_format(time,format)\n\n时间格式化函数 DATE_FORMAT(date, format)\n\n1. date 时间\n2. format 参数格式有\n\n参数|说明\n:----:|:-----------------------:\n%a|缩写星期名\n%b|缩写月名\n%c|月，数值\n%D|带有英文前缀的月中的天\n%d|月的天，数值(00-31)\n%e|月的天，数值(0-31)\n%f|微秒\n%H|小时 (00-23)\n%h|小时 (01-12)\n%I|小时 (01-12)\n%i|分钟，数值(00-59)\n%j|年的天 (001-366)\n%k|小时 (0-23)\n%l|小时 (1-12)\n%M|月名\n%m|月，数值(00-12)\n%p|AM 或 PM\n%r|时间，12-小时（hh:mm:ss AM 或 PM）\n%S|秒(00-59)\n%s|秒(00-59)\n%T|时间, 24-小时 (hh:mm:ss)\n%U|周 (00-53) 星期日是一周的第一天\n%u|周 (00-53) 星期一是一周的第一天\n%V|周 (01-53) 星期日是一周的第一天，与 %X 使用\n%v|周 (01-53) 星期一是一周的第一天，与 %x 使用\n%W|星期名\n%w|周的天 （0=星期日, 6=星期六）\n%X|年，其中的星期日是周的第一天，4 位，与 %V 使用\n%x|年，其中的星期一是周的第一天，4 位，与 %v 使用\n%Y|年，4 位\n%y|年，2 位\n\n字符串转换为时间 str_to_date(str, format)\n\n(日期、天数）转换函数：to_days(date), from_days(days)\n\n(时间、秒）转换函数：time_to_sec(time), sec_to_time(seconds)\n\n拼凑日期、时间函数：makdedate(year,dayofyear), maketime(hour,minute,second)\n\nUnix 时间戳、日期）转换函数\n\n1. unix_timestamp(),\n2. unix_timestamp(date),\n3. from_unixtime(unix_timestamp),\n4. from_unixtime(unix_timestamp,format)\n   1. 格式化函数 FROM_UNIXTIME(unix_timestamp, [format])\n   2. unix_timestamp 一般为10位的时间戳，如:1417363200\n   3. format *可选* 转换之后的时间字符串显示的格式;\n\n##### 日期时间计算函数\n\n增加一个时间间隔：DATE_ADD(date,INTERVAL expr type)\n\n+ date 要操作的时间\n+ expr 要添加的时间间隔\n+ type 参考下表\n\ntype的值|备注\n:----------:|:-------:\nMICROSECOND|\nSECOND|秒\nMINUTE|分\nHOUR|小时\nDAY|天\nWEEK|星期\nMONTH|月\nQUARTER|?\nYEAR|年\nSECOND_MICROSECOND|\nMINUTE_MICROSECOND|\nMINUTE_SECOND|\nHOUR_MICROSECOND|\nHOUR_SECOND|\nHOUR_MINUTE|\nDAY_MICROSECOND|\nDAY_SECOND|\nDAY_MINUTE|\nDAY_HOUR|\nYEAR_MONTH|\n\n> adddate(), addtime()函数，可以用 date_add() 来替代\n\n日期减去一个时间间隔：DATE_SUB(date,INTERVAL expr type)\n\n> DATE_SUB(date,INTERVAL expr type) 日期时间函数 和 date_add() 用法一致\n\n日期、时间相减函数：datediff(date1,date2), timediff(time1,time2)\n\n1. datediff 返回天数差距\n2. timediff 返回time差距\n\n> 注意：timediff(time1,time2) 函数的两个参数类型必须相同。\n\n时间戳（timestamp）转换、增、减函数\n\n1. timestamp(date) -- date to timestamp\n2. timestamp(dt,time) -- dt + time\n3. timestampadd(unit,interval,datetime_expr) --\n4. timestampdiff(unit,datetime_expr1,datetime_expr2) --\n\n示例:\n\n```sh\nselect timestamp('2008-08-08'); -- 2008-08-08 00:00:00\nselect timestamp('2008-08-08 08:00:00', '01:01:01'); -- 2008-08-08 09:01:01\nselect timestamp('2008-08-08 08:00:00', '10 01:01:01'); -- 2008-08-18 09:01:01\n\nselect timestampadd(day, 1, '2008-08-08 08:00:00'); -- 2008-08-09 08:00:00\nselect date_add('2008-08-08 08:00:00', interval 1 day); -- 2008-08-09 08:00:00\n\ntimestampadd() 函数类似于 date_add()。\nselect timestampdiff(year,'2002-05-01','2001-01-01'); -- -1\nselect timestampdiff(day ,'2002-05-01','2001-01-01'); -- -485\nselect timestampdiff(hour,'2008-08-08 12:00:00','2008-08-08 00:00:00'); -- -12\n\nselect datediff('2008-08-08 12:00:00', '2008-08-01 00:00:00'); -- 7\n```\n\n> timestampdiff() 函数就比 datediff() 功能强多了，datediff() 只能计算两个日期（date）之间相差的天数。\n\n时区（timezone）转换函数\n\n```sh\nconvert_tz(dt,from_tz,to_tz)\n\nselect convert_tz('2008-08-08 12:00:00', '+08:00', '+00:00'); -- 2008-08-08 04:00:00\n```\n\n> 时区转换也可以通过 date_add, date_sub, timestampadd 来实现\n\n## 相关链接\n\n[MySQL CAST与CONVERT 函数的用法](https://www.cnblogs.com/chenqionghe/p/4675844.html)\n\n[MySQL 日期格式](https://www.cnblogs.com/dest/p/4205371.html)\n\n## 结语\n\n每天都要去折腾才能进步\n","source":"_posts/mysql5-7.md","raw":"---\ntitle: mysql学习笔记\ndate: 2019-06-05 17:00:05\ntags: 数据库\n---\n\n这篇文章主要是我日常使用mysql的一些记录\n我使用的mysql版本是:`5.7`\n\n## MySQL 相关文章\n\n[【链接】大牛总结的MySQL锁优化，写得太好了！](https://cloud.tencent.com/developer/news/456119)\n[【链接】一篇文章弄懂MySQL的事务隔离级别](https://mp.weixin.qq.com/s/p32Tc6XhbHq_NbJWAiZnhQ)\n\n## 用户\n\n### 创建用户\n\n```sh\ncreate user 'testuser'@'%' identified by 'password';\n```\n\n创建 `testuser` 用户, 可以在所有主机上登陆使用, 密码为`password`;\n\n1. testuser 是创建的用户名\n2. % 是主机名,指定哪些主机可以使用改用户\n   1. %/0.0.0.0 所有主机可以使用\n   2. localhost/127.0.0.1 本机可以使用\n   3. ...\n3. password 是创建的用户登陆密码, 如果指定为 `identified by ''` 则不设置密码\n\n### 删除用户\n\n```sh\ndrop user 'apollo'@'%';\n```\n\n### 用户权限\n\n#### 授予权限\n\n```sh\ngrant all on testdb.* to 'testuser'@'%';\ngrant select on testdb.* to 'testuser'@'%';\ngrant insert on testdb.* to 'testuser'@'%';\n```\n\n授予用户`testuser`在所有主机上使用`testdb`数据库下**所有表**的权限\n\n+ all 代表权限\n  + select 查询权限\n  + insert 插入权限\n  + delete 删除权限\n  + update 修改权限\n+ testdb.* 改数据库下的所有表\n+ 'testuser'@'%' 表示`testuser`在`%`主机可以使用授予的权限\n\n#### 刷新权限\n\n`flush privileges;`\n\n#### 删除权限\n\n```sh\nREVOKE ALL ON test.* FROM 'testuser'@'%';\nREVOKE select ON test.* FROM 'testuser'@'%';\nREVOKE insert ON test.* FROM 'testuser'@'%';\n```\n\n+ 删除所有权限\n+ 删除查询权限\n+ 删除插入权限\n\n#### 查看用户权限\n\n`SHOW GRANTS FOR 'testuser'@'%';`\n\n## 数据库\n\n### 基本语法\n\n#### 函数\n\n##### 类型转换函数\n\n用于类型转化 CAST()和CONVERT()\n\n```sh\nCAST(value as type);\nCONVERT(value, type);\n```\n\n可以转换的类型是有限制的。这个类型可以是以下值其中的一个：\n\n+ 二进制，同带binary前缀的效果 : BINARY\n+ 字符型，可带参数 : CHAR()\n+ 日期 : DATE\n+ 时间: TIME\n+ 日期时间型 : DATETIME\n+ 浮点数 : DECIMAL\n+ 整数 : SIGNED\n+ 无符号整数 : UNSIGNED\n\n示例:\n\n```sh\n# 1\nmysql> SELECT CONVERT('23',SIGNED);\n+----------------------+\n| CONVERT('23',SIGNED) |\n+----------------------+\n|                   23 |\n+----------------------+\n1 row in set\n\n# 2\nmysql> SELECT CAST('125e342.83' AS signed);\n+------------------------------+\n| CAST('125e342.83' AS signed) |\n+------------------------------+\n|                          125 |\n+------------------------------+\n1 row in set\n\n# 3\nmysql> SELECT CAST('3.35' AS signed);\n+------------------------+\n| CAST('3.35' AS signed) |\n+------------------------+\n|                      3 |\n+------------------------+\n1 row in set\n```\n\n##### 格式化函数\n\n##### 随机数 rand()\n\n```sh\nselect rand()\n```\n\n#### 时间\n\n##### 获取系统时间 `now()` 和 `sysdate()` 这两个函数的区别是, `now()`在执行前就确认了值, `sysdate()`在执行时动态确认值\n\n例子:\n\n```sh\n> select now(), sleep(3), now();\n> select sysdate(), sleep(3), sysdate();\n```\n\n> 感兴趣的可以看一下这两天sql执行的结果\n\n##### 获得当前时间戳函数：current_timestamp, current_timestamp()\n\n语法: `select current_timestamp, current_timestamp()`\n\n##### 日期、时间转换\n\n时间转换为字符串 date_format(date,format), time_format(time,format)\n\n时间格式化函数 DATE_FORMAT(date, format)\n\n1. date 时间\n2. format 参数格式有\n\n参数|说明\n:----:|:-----------------------:\n%a|缩写星期名\n%b|缩写月名\n%c|月，数值\n%D|带有英文前缀的月中的天\n%d|月的天，数值(00-31)\n%e|月的天，数值(0-31)\n%f|微秒\n%H|小时 (00-23)\n%h|小时 (01-12)\n%I|小时 (01-12)\n%i|分钟，数值(00-59)\n%j|年的天 (001-366)\n%k|小时 (0-23)\n%l|小时 (1-12)\n%M|月名\n%m|月，数值(00-12)\n%p|AM 或 PM\n%r|时间，12-小时（hh:mm:ss AM 或 PM）\n%S|秒(00-59)\n%s|秒(00-59)\n%T|时间, 24-小时 (hh:mm:ss)\n%U|周 (00-53) 星期日是一周的第一天\n%u|周 (00-53) 星期一是一周的第一天\n%V|周 (01-53) 星期日是一周的第一天，与 %X 使用\n%v|周 (01-53) 星期一是一周的第一天，与 %x 使用\n%W|星期名\n%w|周的天 （0=星期日, 6=星期六）\n%X|年，其中的星期日是周的第一天，4 位，与 %V 使用\n%x|年，其中的星期一是周的第一天，4 位，与 %v 使用\n%Y|年，4 位\n%y|年，2 位\n\n字符串转换为时间 str_to_date(str, format)\n\n(日期、天数）转换函数：to_days(date), from_days(days)\n\n(时间、秒）转换函数：time_to_sec(time), sec_to_time(seconds)\n\n拼凑日期、时间函数：makdedate(year,dayofyear), maketime(hour,minute,second)\n\nUnix 时间戳、日期）转换函数\n\n1. unix_timestamp(),\n2. unix_timestamp(date),\n3. from_unixtime(unix_timestamp),\n4. from_unixtime(unix_timestamp,format)\n   1. 格式化函数 FROM_UNIXTIME(unix_timestamp, [format])\n   2. unix_timestamp 一般为10位的时间戳，如:1417363200\n   3. format *可选* 转换之后的时间字符串显示的格式;\n\n##### 日期时间计算函数\n\n增加一个时间间隔：DATE_ADD(date,INTERVAL expr type)\n\n+ date 要操作的时间\n+ expr 要添加的时间间隔\n+ type 参考下表\n\ntype的值|备注\n:----------:|:-------:\nMICROSECOND|\nSECOND|秒\nMINUTE|分\nHOUR|小时\nDAY|天\nWEEK|星期\nMONTH|月\nQUARTER|?\nYEAR|年\nSECOND_MICROSECOND|\nMINUTE_MICROSECOND|\nMINUTE_SECOND|\nHOUR_MICROSECOND|\nHOUR_SECOND|\nHOUR_MINUTE|\nDAY_MICROSECOND|\nDAY_SECOND|\nDAY_MINUTE|\nDAY_HOUR|\nYEAR_MONTH|\n\n> adddate(), addtime()函数，可以用 date_add() 来替代\n\n日期减去一个时间间隔：DATE_SUB(date,INTERVAL expr type)\n\n> DATE_SUB(date,INTERVAL expr type) 日期时间函数 和 date_add() 用法一致\n\n日期、时间相减函数：datediff(date1,date2), timediff(time1,time2)\n\n1. datediff 返回天数差距\n2. timediff 返回time差距\n\n> 注意：timediff(time1,time2) 函数的两个参数类型必须相同。\n\n时间戳（timestamp）转换、增、减函数\n\n1. timestamp(date) -- date to timestamp\n2. timestamp(dt,time) -- dt + time\n3. timestampadd(unit,interval,datetime_expr) --\n4. timestampdiff(unit,datetime_expr1,datetime_expr2) --\n\n示例:\n\n```sh\nselect timestamp('2008-08-08'); -- 2008-08-08 00:00:00\nselect timestamp('2008-08-08 08:00:00', '01:01:01'); -- 2008-08-08 09:01:01\nselect timestamp('2008-08-08 08:00:00', '10 01:01:01'); -- 2008-08-18 09:01:01\n\nselect timestampadd(day, 1, '2008-08-08 08:00:00'); -- 2008-08-09 08:00:00\nselect date_add('2008-08-08 08:00:00', interval 1 day); -- 2008-08-09 08:00:00\n\ntimestampadd() 函数类似于 date_add()。\nselect timestampdiff(year,'2002-05-01','2001-01-01'); -- -1\nselect timestampdiff(day ,'2002-05-01','2001-01-01'); -- -485\nselect timestampdiff(hour,'2008-08-08 12:00:00','2008-08-08 00:00:00'); -- -12\n\nselect datediff('2008-08-08 12:00:00', '2008-08-01 00:00:00'); -- 7\n```\n\n> timestampdiff() 函数就比 datediff() 功能强多了，datediff() 只能计算两个日期（date）之间相差的天数。\n\n时区（timezone）转换函数\n\n```sh\nconvert_tz(dt,from_tz,to_tz)\n\nselect convert_tz('2008-08-08 12:00:00', '+08:00', '+00:00'); -- 2008-08-08 04:00:00\n```\n\n> 时区转换也可以通过 date_add, date_sub, timestampadd 来实现\n\n## 相关链接\n\n[MySQL CAST与CONVERT 函数的用法](https://www.cnblogs.com/chenqionghe/p/4675844.html)\n\n[MySQL 日期格式](https://www.cnblogs.com/dest/p/4205371.html)\n\n## 结语\n\n每天都要去折腾才能进步\n","slug":"mysql5-7","published":1,"updated":"2019-10-19T02:48:26.506Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck550trlv000thm62z7h3tfej","content":"<p>这篇文章主要是我日常使用mysql的一些记录<br>我使用的mysql版本是:<code>5.7</code></p>\n<h2 id=\"MySQL-相关文章\"><a href=\"#MySQL-相关文章\" class=\"headerlink\" title=\"MySQL 相关文章\"></a>MySQL 相关文章</h2><p><a href=\"https://cloud.tencent.com/developer/news/456119\" target=\"_blank\" rel=\"noopener\">【链接】大牛总结的MySQL锁优化，写得太好了！</a><br><a href=\"https://mp.weixin.qq.com/s/p32Tc6XhbHq_NbJWAiZnhQ\" target=\"_blank\" rel=\"noopener\">【链接】一篇文章弄懂MySQL的事务隔离级别</a></p>\n<h2 id=\"用户\"><a href=\"#用户\" class=\"headerlink\" title=\"用户\"></a>用户</h2><h3 id=\"创建用户\"><a href=\"#创建用户\" class=\"headerlink\" title=\"创建用户\"></a>创建用户</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">create user <span class=\"string\">'testuser'</span>@<span class=\"string\">'%'</span> identified by <span class=\"string\">'password'</span>;</span><br></pre></td></tr></table></figure>\n<p>创建 <code>testuser</code> 用户, 可以在所有主机上登陆使用, 密码为<code>password</code>;</p>\n<ol>\n<li>testuser 是创建的用户名</li>\n<li>% 是主机名,指定哪些主机可以使用改用户<ol>\n<li>%/0.0.0.0 所有主机可以使用</li>\n<li>localhost/127.0.0.1 本机可以使用</li>\n<li>…</li>\n</ol>\n</li>\n<li>password 是创建的用户登陆密码, 如果指定为 <code>identified by &#39;&#39;</code> 则不设置密码</li>\n</ol>\n<h3 id=\"删除用户\"><a href=\"#删除用户\" class=\"headerlink\" title=\"删除用户\"></a>删除用户</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">drop user <span class=\"string\">'apollo'</span>@<span class=\"string\">'%'</span>;</span><br></pre></td></tr></table></figure>\n<h3 id=\"用户权限\"><a href=\"#用户权限\" class=\"headerlink\" title=\"用户权限\"></a>用户权限</h3><h4 id=\"授予权限\"><a href=\"#授予权限\" class=\"headerlink\" title=\"授予权限\"></a>授予权限</h4><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">grant all on testdb.* to <span class=\"string\">'testuser'</span>@<span class=\"string\">'%'</span>;</span><br><span class=\"line\">grant select on testdb.* to <span class=\"string\">'testuser'</span>@<span class=\"string\">'%'</span>;</span><br><span class=\"line\">grant insert on testdb.* to <span class=\"string\">'testuser'</span>@<span class=\"string\">'%'</span>;</span><br></pre></td></tr></table></figure>\n<p>授予用户<code>testuser</code>在所有主机上使用<code>testdb</code>数据库下<strong>所有表</strong>的权限</p>\n<ul>\n<li>all 代表权限<ul>\n<li>select 查询权限</li>\n<li>insert 插入权限</li>\n<li>delete 删除权限</li>\n<li>update 修改权限</li>\n</ul>\n</li>\n<li>testdb.* 改数据库下的所有表</li>\n<li>‘testuser‘@’%’ 表示<code>testuser</code>在<code>%</code>主机可以使用授予的权限</li>\n</ul>\n<h4 id=\"刷新权限\"><a href=\"#刷新权限\" class=\"headerlink\" title=\"刷新权限\"></a>刷新权限</h4><p><code>flush privileges;</code></p>\n<h4 id=\"删除权限\"><a href=\"#删除权限\" class=\"headerlink\" title=\"删除权限\"></a>删除权限</h4><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">REVOKE ALL ON <span class=\"built_in\">test</span>.* FROM <span class=\"string\">'testuser'</span>@<span class=\"string\">'%'</span>;</span><br><span class=\"line\">REVOKE select ON <span class=\"built_in\">test</span>.* FROM <span class=\"string\">'testuser'</span>@<span class=\"string\">'%'</span>;</span><br><span class=\"line\">REVOKE insert ON <span class=\"built_in\">test</span>.* FROM <span class=\"string\">'testuser'</span>@<span class=\"string\">'%'</span>;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>删除所有权限</li>\n<li>删除查询权限</li>\n<li>删除插入权限</li>\n</ul>\n<h4 id=\"查看用户权限\"><a href=\"#查看用户权限\" class=\"headerlink\" title=\"查看用户权限\"></a>查看用户权限</h4><p><code>SHOW GRANTS FOR &#39;testuser&#39;@&#39;%&#39;;</code></p>\n<h2 id=\"数据库\"><a href=\"#数据库\" class=\"headerlink\" title=\"数据库\"></a>数据库</h2><h3 id=\"基本语法\"><a href=\"#基本语法\" class=\"headerlink\" title=\"基本语法\"></a>基本语法</h3><h4 id=\"函数\"><a href=\"#函数\" class=\"headerlink\" title=\"函数\"></a>函数</h4><h5 id=\"类型转换函数\"><a href=\"#类型转换函数\" class=\"headerlink\" title=\"类型转换函数\"></a>类型转换函数</h5><p>用于类型转化 CAST()和CONVERT()</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CAST(value as <span class=\"built_in\">type</span>);</span><br><span class=\"line\">CONVERT(value, <span class=\"built_in\">type</span>);</span><br></pre></td></tr></table></figure>\n<p>可以转换的类型是有限制的。这个类型可以是以下值其中的一个：</p>\n<ul>\n<li>二进制，同带binary前缀的效果 : BINARY</li>\n<li>字符型，可带参数 : CHAR()</li>\n<li>日期 : DATE</li>\n<li>时间: TIME</li>\n<li>日期时间型 : DATETIME</li>\n<li>浮点数 : DECIMAL</li>\n<li>整数 : SIGNED</li>\n<li>无符号整数 : UNSIGNED</li>\n</ul>\n<p>示例:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1</span></span><br><span class=\"line\">mysql&gt; SELECT CONVERT(<span class=\"string\">'23'</span>,SIGNED);</span><br><span class=\"line\">+----------------------+</span><br><span class=\"line\">| CONVERT(<span class=\"string\">'23'</span>,SIGNED) |</span><br><span class=\"line\">+----------------------+</span><br><span class=\"line\">|                   23 |</span><br><span class=\"line\">+----------------------+</span><br><span class=\"line\">1 row <span class=\"keyword\">in</span> <span class=\"built_in\">set</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2</span></span><br><span class=\"line\">mysql&gt; SELECT CAST(<span class=\"string\">'125e342.83'</span> AS signed);</span><br><span class=\"line\">+------------------------------+</span><br><span class=\"line\">| CAST(<span class=\"string\">'125e342.83'</span> AS signed) |</span><br><span class=\"line\">+------------------------------+</span><br><span class=\"line\">|                          125 |</span><br><span class=\"line\">+------------------------------+</span><br><span class=\"line\">1 row <span class=\"keyword\">in</span> <span class=\"built_in\">set</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3</span></span><br><span class=\"line\">mysql&gt; SELECT CAST(<span class=\"string\">'3.35'</span> AS signed);</span><br><span class=\"line\">+------------------------+</span><br><span class=\"line\">| CAST(<span class=\"string\">'3.35'</span> AS signed) |</span><br><span class=\"line\">+------------------------+</span><br><span class=\"line\">|                      3 |</span><br><span class=\"line\">+------------------------+</span><br><span class=\"line\">1 row <span class=\"keyword\">in</span> <span class=\"built_in\">set</span></span><br></pre></td></tr></table></figure>\n<h5 id=\"格式化函数\"><a href=\"#格式化函数\" class=\"headerlink\" title=\"格式化函数\"></a>格式化函数</h5><h5 id=\"随机数-rand\"><a href=\"#随机数-rand\" class=\"headerlink\" title=\"随机数 rand()\"></a>随机数 rand()</h5><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select rand()</span><br></pre></td></tr></table></figure>\n<h4 id=\"时间\"><a href=\"#时间\" class=\"headerlink\" title=\"时间\"></a>时间</h4><h5 id=\"获取系统时间-now-和-sysdate-这两个函数的区别是-now-在执行前就确认了值-sysdate-在执行时动态确认值\"><a href=\"#获取系统时间-now-和-sysdate-这两个函数的区别是-now-在执行前就确认了值-sysdate-在执行时动态确认值\" class=\"headerlink\" title=\"获取系统时间 now() 和 sysdate() 这两个函数的区别是, now()在执行前就确认了值, sysdate()在执行时动态确认值\"></a>获取系统时间 <code>now()</code> 和 <code>sysdate()</code> 这两个函数的区别是, <code>now()</code>在执行前就确认了值, <code>sysdate()</code>在执行时动态确认值</h5><p>例子:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; select now(), sleep(3), now();</span><br><span class=\"line\">&gt; select sysdate(), sleep(3), sysdate();</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>感兴趣的可以看一下这两天sql执行的结果</p>\n</blockquote>\n<h5 id=\"获得当前时间戳函数：current-timestamp-current-timestamp\"><a href=\"#获得当前时间戳函数：current-timestamp-current-timestamp\" class=\"headerlink\" title=\"获得当前时间戳函数：current_timestamp, current_timestamp()\"></a>获得当前时间戳函数：current_timestamp, current_timestamp()</h5><p>语法: <code>select current_timestamp, current_timestamp()</code></p>\n<h5 id=\"日期、时间转换\"><a href=\"#日期、时间转换\" class=\"headerlink\" title=\"日期、时间转换\"></a>日期、时间转换</h5><p>时间转换为字符串 date_format(date,format), time_format(time,format)</p>\n<p>时间格式化函数 DATE_FORMAT(date, format)</p>\n<ol>\n<li>date 时间</li>\n<li>format 参数格式有</li>\n</ol>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">参数</th>\n<th style=\"text-align:center\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">%a</td>\n<td style=\"text-align:center\">缩写星期名</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%b</td>\n<td style=\"text-align:center\">缩写月名</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%c</td>\n<td style=\"text-align:center\">月，数值</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%D</td>\n<td style=\"text-align:center\">带有英文前缀的月中的天</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%d</td>\n<td style=\"text-align:center\">月的天，数值(00-31)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%e</td>\n<td style=\"text-align:center\">月的天，数值(0-31)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%f</td>\n<td style=\"text-align:center\">微秒</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%H</td>\n<td style=\"text-align:center\">小时 (00-23)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%h</td>\n<td style=\"text-align:center\">小时 (01-12)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%I</td>\n<td style=\"text-align:center\">小时 (01-12)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%i</td>\n<td style=\"text-align:center\">分钟，数值(00-59)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%j</td>\n<td style=\"text-align:center\">年的天 (001-366)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%k</td>\n<td style=\"text-align:center\">小时 (0-23)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%l</td>\n<td style=\"text-align:center\">小时 (1-12)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%M</td>\n<td style=\"text-align:center\">月名</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%m</td>\n<td style=\"text-align:center\">月，数值(00-12)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%p</td>\n<td style=\"text-align:center\">AM 或 PM</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%r</td>\n<td style=\"text-align:center\">时间，12-小时（hh:mm:ss AM 或 PM）</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%S</td>\n<td style=\"text-align:center\">秒(00-59)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%s</td>\n<td style=\"text-align:center\">秒(00-59)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%T</td>\n<td style=\"text-align:center\">时间, 24-小时 (hh:mm:ss)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%U</td>\n<td style=\"text-align:center\">周 (00-53) 星期日是一周的第一天</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%u</td>\n<td style=\"text-align:center\">周 (00-53) 星期一是一周的第一天</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%V</td>\n<td style=\"text-align:center\">周 (01-53) 星期日是一周的第一天，与 %X 使用</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%v</td>\n<td style=\"text-align:center\">周 (01-53) 星期一是一周的第一天，与 %x 使用</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%W</td>\n<td style=\"text-align:center\">星期名</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%w</td>\n<td style=\"text-align:center\">周的天 （0=星期日, 6=星期六）</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%X</td>\n<td style=\"text-align:center\">年，其中的星期日是周的第一天，4 位，与 %V 使用</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%x</td>\n<td style=\"text-align:center\">年，其中的星期一是周的第一天，4 位，与 %v 使用</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%Y</td>\n<td style=\"text-align:center\">年，4 位</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%y</td>\n<td style=\"text-align:center\">年，2 位</td>\n</tr>\n</tbody>\n</table>\n<p>字符串转换为时间 str_to_date(str, format)</p>\n<p>(日期、天数）转换函数：to_days(date), from_days(days)</p>\n<p>(时间、秒）转换函数：time_to_sec(time), sec_to_time(seconds)</p>\n<p>拼凑日期、时间函数：makdedate(year,dayofyear), maketime(hour,minute,second)</p>\n<p>Unix 时间戳、日期）转换函数</p>\n<ol>\n<li>unix_timestamp(),</li>\n<li>unix_timestamp(date),</li>\n<li>from_unixtime(unix_timestamp),</li>\n<li>from_unixtime(unix_timestamp,format)<ol>\n<li>格式化函数 FROM_UNIXTIME(unix_timestamp, [format])</li>\n<li>unix_timestamp 一般为10位的时间戳，如:1417363200</li>\n<li>format <em>可选</em> 转换之后的时间字符串显示的格式;</li>\n</ol>\n</li>\n</ol>\n<h5 id=\"日期时间计算函数\"><a href=\"#日期时间计算函数\" class=\"headerlink\" title=\"日期时间计算函数\"></a>日期时间计算函数</h5><p>增加一个时间间隔：DATE_ADD(date,INTERVAL expr type)</p>\n<ul>\n<li>date 要操作的时间</li>\n<li>expr 要添加的时间间隔</li>\n<li>type 参考下表</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">type的值</th>\n<th style=\"text-align:center\">备注</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">MICROSECOND</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">SECOND</td>\n<td style=\"text-align:center\">秒</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">MINUTE</td>\n<td style=\"text-align:center\">分</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">HOUR</td>\n<td style=\"text-align:center\">小时</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">DAY</td>\n<td style=\"text-align:center\">天</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">WEEK</td>\n<td style=\"text-align:center\">星期</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">MONTH</td>\n<td style=\"text-align:center\">月</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">QUARTER</td>\n<td style=\"text-align:center\">?</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">YEAR</td>\n<td style=\"text-align:center\">年</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">SECOND_MICROSECOND</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">MINUTE_MICROSECOND</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">MINUTE_SECOND</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">HOUR_MICROSECOND</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">HOUR_SECOND</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">HOUR_MINUTE</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">DAY_MICROSECOND</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">DAY_SECOND</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">DAY_MINUTE</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">DAY_HOUR</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">YEAR_MONTH</td>\n<td style=\"text-align:center\"></td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p>adddate(), addtime()函数，可以用 date_add() 来替代</p>\n</blockquote>\n<p>日期减去一个时间间隔：DATE_SUB(date,INTERVAL expr type)</p>\n<blockquote>\n<p>DATE_SUB(date,INTERVAL expr type) 日期时间函数 和 date_add() 用法一致</p>\n</blockquote>\n<p>日期、时间相减函数：datediff(date1,date2), timediff(time1,time2)</p>\n<ol>\n<li>datediff 返回天数差距</li>\n<li>timediff 返回time差距</li>\n</ol>\n<blockquote>\n<p>注意：timediff(time1,time2) 函数的两个参数类型必须相同。</p>\n</blockquote>\n<p>时间戳（timestamp）转换、增、减函数</p>\n<ol>\n<li>timestamp(date) – date to timestamp</li>\n<li>timestamp(dt,time) – dt + time</li>\n<li>timestampadd(unit,interval,datetime_expr) –</li>\n<li>timestampdiff(unit,datetime_expr1,datetime_expr2) –</li>\n</ol>\n<p>示例:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select timestamp(<span class=\"string\">'2008-08-08'</span>); -- 2008-08-08 00:00:00</span><br><span class=\"line\">select timestamp(<span class=\"string\">'2008-08-08 08:00:00'</span>, <span class=\"string\">'01:01:01'</span>); -- 2008-08-08 09:01:01</span><br><span class=\"line\">select timestamp(<span class=\"string\">'2008-08-08 08:00:00'</span>, <span class=\"string\">'10 01:01:01'</span>); -- 2008-08-18 09:01:01</span><br><span class=\"line\"></span><br><span class=\"line\">select timestampadd(day, 1, <span class=\"string\">'2008-08-08 08:00:00'</span>); -- 2008-08-09 08:00:00</span><br><span class=\"line\">select date_add(<span class=\"string\">'2008-08-08 08:00:00'</span>, interval 1 day); -- 2008-08-09 08:00:00</span><br><span class=\"line\"></span><br><span class=\"line\">timestampadd() 函数类似于 date_add()。</span><br><span class=\"line\">select timestampdiff(year,<span class=\"string\">'2002-05-01'</span>,<span class=\"string\">'2001-01-01'</span>); -- -1</span><br><span class=\"line\">select timestampdiff(day ,<span class=\"string\">'2002-05-01'</span>,<span class=\"string\">'2001-01-01'</span>); -- -485</span><br><span class=\"line\">select timestampdiff(hour,<span class=\"string\">'2008-08-08 12:00:00'</span>,<span class=\"string\">'2008-08-08 00:00:00'</span>); -- -12</span><br><span class=\"line\"></span><br><span class=\"line\">select datediff(<span class=\"string\">'2008-08-08 12:00:00'</span>, <span class=\"string\">'2008-08-01 00:00:00'</span>); -- 7</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>timestampdiff() 函数就比 datediff() 功能强多了，datediff() 只能计算两个日期（date）之间相差的天数。</p>\n</blockquote>\n<p>时区（timezone）转换函数</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">convert_tz(dt,from_tz,to_tz)</span><br><span class=\"line\"></span><br><span class=\"line\">select convert_tz(<span class=\"string\">'2008-08-08 12:00:00'</span>, <span class=\"string\">'+08:00'</span>, <span class=\"string\">'+00:00'</span>); -- 2008-08-08 04:00:00</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>时区转换也可以通过 date_add, date_sub, timestampadd 来实现</p>\n</blockquote>\n<h2 id=\"相关链接\"><a href=\"#相关链接\" class=\"headerlink\" title=\"相关链接\"></a>相关链接</h2><p><a href=\"https://www.cnblogs.com/chenqionghe/p/4675844.html\" target=\"_blank\" rel=\"noopener\">MySQL CAST与CONVERT 函数的用法</a></p>\n<p><a href=\"https://www.cnblogs.com/dest/p/4205371.html\" target=\"_blank\" rel=\"noopener\">MySQL 日期格式</a></p>\n<h2 id=\"结语\"><a href=\"#结语\" class=\"headerlink\" title=\"结语\"></a>结语</h2><p>每天都要去折腾才能进步</p>\n","site":{"data":{}},"excerpt":"","more":"<p>这篇文章主要是我日常使用mysql的一些记录<br>我使用的mysql版本是:<code>5.7</code></p>\n<h2 id=\"MySQL-相关文章\"><a href=\"#MySQL-相关文章\" class=\"headerlink\" title=\"MySQL 相关文章\"></a>MySQL 相关文章</h2><p><a href=\"https://cloud.tencent.com/developer/news/456119\" target=\"_blank\" rel=\"noopener\">【链接】大牛总结的MySQL锁优化，写得太好了！</a><br><a href=\"https://mp.weixin.qq.com/s/p32Tc6XhbHq_NbJWAiZnhQ\" target=\"_blank\" rel=\"noopener\">【链接】一篇文章弄懂MySQL的事务隔离级别</a></p>\n<h2 id=\"用户\"><a href=\"#用户\" class=\"headerlink\" title=\"用户\"></a>用户</h2><h3 id=\"创建用户\"><a href=\"#创建用户\" class=\"headerlink\" title=\"创建用户\"></a>创建用户</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">create user <span class=\"string\">'testuser'</span>@<span class=\"string\">'%'</span> identified by <span class=\"string\">'password'</span>;</span><br></pre></td></tr></table></figure>\n<p>创建 <code>testuser</code> 用户, 可以在所有主机上登陆使用, 密码为<code>password</code>;</p>\n<ol>\n<li>testuser 是创建的用户名</li>\n<li>% 是主机名,指定哪些主机可以使用改用户<ol>\n<li>%/0.0.0.0 所有主机可以使用</li>\n<li>localhost/127.0.0.1 本机可以使用</li>\n<li>…</li>\n</ol>\n</li>\n<li>password 是创建的用户登陆密码, 如果指定为 <code>identified by &#39;&#39;</code> 则不设置密码</li>\n</ol>\n<h3 id=\"删除用户\"><a href=\"#删除用户\" class=\"headerlink\" title=\"删除用户\"></a>删除用户</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">drop user <span class=\"string\">'apollo'</span>@<span class=\"string\">'%'</span>;</span><br></pre></td></tr></table></figure>\n<h3 id=\"用户权限\"><a href=\"#用户权限\" class=\"headerlink\" title=\"用户权限\"></a>用户权限</h3><h4 id=\"授予权限\"><a href=\"#授予权限\" class=\"headerlink\" title=\"授予权限\"></a>授予权限</h4><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">grant all on testdb.* to <span class=\"string\">'testuser'</span>@<span class=\"string\">'%'</span>;</span><br><span class=\"line\">grant select on testdb.* to <span class=\"string\">'testuser'</span>@<span class=\"string\">'%'</span>;</span><br><span class=\"line\">grant insert on testdb.* to <span class=\"string\">'testuser'</span>@<span class=\"string\">'%'</span>;</span><br></pre></td></tr></table></figure>\n<p>授予用户<code>testuser</code>在所有主机上使用<code>testdb</code>数据库下<strong>所有表</strong>的权限</p>\n<ul>\n<li>all 代表权限<ul>\n<li>select 查询权限</li>\n<li>insert 插入权限</li>\n<li>delete 删除权限</li>\n<li>update 修改权限</li>\n</ul>\n</li>\n<li>testdb.* 改数据库下的所有表</li>\n<li>‘testuser‘@’%’ 表示<code>testuser</code>在<code>%</code>主机可以使用授予的权限</li>\n</ul>\n<h4 id=\"刷新权限\"><a href=\"#刷新权限\" class=\"headerlink\" title=\"刷新权限\"></a>刷新权限</h4><p><code>flush privileges;</code></p>\n<h4 id=\"删除权限\"><a href=\"#删除权限\" class=\"headerlink\" title=\"删除权限\"></a>删除权限</h4><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">REVOKE ALL ON <span class=\"built_in\">test</span>.* FROM <span class=\"string\">'testuser'</span>@<span class=\"string\">'%'</span>;</span><br><span class=\"line\">REVOKE select ON <span class=\"built_in\">test</span>.* FROM <span class=\"string\">'testuser'</span>@<span class=\"string\">'%'</span>;</span><br><span class=\"line\">REVOKE insert ON <span class=\"built_in\">test</span>.* FROM <span class=\"string\">'testuser'</span>@<span class=\"string\">'%'</span>;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>删除所有权限</li>\n<li>删除查询权限</li>\n<li>删除插入权限</li>\n</ul>\n<h4 id=\"查看用户权限\"><a href=\"#查看用户权限\" class=\"headerlink\" title=\"查看用户权限\"></a>查看用户权限</h4><p><code>SHOW GRANTS FOR &#39;testuser&#39;@&#39;%&#39;;</code></p>\n<h2 id=\"数据库\"><a href=\"#数据库\" class=\"headerlink\" title=\"数据库\"></a>数据库</h2><h3 id=\"基本语法\"><a href=\"#基本语法\" class=\"headerlink\" title=\"基本语法\"></a>基本语法</h3><h4 id=\"函数\"><a href=\"#函数\" class=\"headerlink\" title=\"函数\"></a>函数</h4><h5 id=\"类型转换函数\"><a href=\"#类型转换函数\" class=\"headerlink\" title=\"类型转换函数\"></a>类型转换函数</h5><p>用于类型转化 CAST()和CONVERT()</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">CAST(value as <span class=\"built_in\">type</span>);</span><br><span class=\"line\">CONVERT(value, <span class=\"built_in\">type</span>);</span><br></pre></td></tr></table></figure>\n<p>可以转换的类型是有限制的。这个类型可以是以下值其中的一个：</p>\n<ul>\n<li>二进制，同带binary前缀的效果 : BINARY</li>\n<li>字符型，可带参数 : CHAR()</li>\n<li>日期 : DATE</li>\n<li>时间: TIME</li>\n<li>日期时间型 : DATETIME</li>\n<li>浮点数 : DECIMAL</li>\n<li>整数 : SIGNED</li>\n<li>无符号整数 : UNSIGNED</li>\n</ul>\n<p>示例:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 1</span></span><br><span class=\"line\">mysql&gt; SELECT CONVERT(<span class=\"string\">'23'</span>,SIGNED);</span><br><span class=\"line\">+----------------------+</span><br><span class=\"line\">| CONVERT(<span class=\"string\">'23'</span>,SIGNED) |</span><br><span class=\"line\">+----------------------+</span><br><span class=\"line\">|                   23 |</span><br><span class=\"line\">+----------------------+</span><br><span class=\"line\">1 row <span class=\"keyword\">in</span> <span class=\"built_in\">set</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 2</span></span><br><span class=\"line\">mysql&gt; SELECT CAST(<span class=\"string\">'125e342.83'</span> AS signed);</span><br><span class=\"line\">+------------------------------+</span><br><span class=\"line\">| CAST(<span class=\"string\">'125e342.83'</span> AS signed) |</span><br><span class=\"line\">+------------------------------+</span><br><span class=\"line\">|                          125 |</span><br><span class=\"line\">+------------------------------+</span><br><span class=\"line\">1 row <span class=\"keyword\">in</span> <span class=\"built_in\">set</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 3</span></span><br><span class=\"line\">mysql&gt; SELECT CAST(<span class=\"string\">'3.35'</span> AS signed);</span><br><span class=\"line\">+------------------------+</span><br><span class=\"line\">| CAST(<span class=\"string\">'3.35'</span> AS signed) |</span><br><span class=\"line\">+------------------------+</span><br><span class=\"line\">|                      3 |</span><br><span class=\"line\">+------------------------+</span><br><span class=\"line\">1 row <span class=\"keyword\">in</span> <span class=\"built_in\">set</span></span><br></pre></td></tr></table></figure>\n<h5 id=\"格式化函数\"><a href=\"#格式化函数\" class=\"headerlink\" title=\"格式化函数\"></a>格式化函数</h5><h5 id=\"随机数-rand\"><a href=\"#随机数-rand\" class=\"headerlink\" title=\"随机数 rand()\"></a>随机数 rand()</h5><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select rand()</span><br></pre></td></tr></table></figure>\n<h4 id=\"时间\"><a href=\"#时间\" class=\"headerlink\" title=\"时间\"></a>时间</h4><h5 id=\"获取系统时间-now-和-sysdate-这两个函数的区别是-now-在执行前就确认了值-sysdate-在执行时动态确认值\"><a href=\"#获取系统时间-now-和-sysdate-这两个函数的区别是-now-在执行前就确认了值-sysdate-在执行时动态确认值\" class=\"headerlink\" title=\"获取系统时间 now() 和 sysdate() 这两个函数的区别是, now()在执行前就确认了值, sysdate()在执行时动态确认值\"></a>获取系统时间 <code>now()</code> 和 <code>sysdate()</code> 这两个函数的区别是, <code>now()</code>在执行前就确认了值, <code>sysdate()</code>在执行时动态确认值</h5><p>例子:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; select now(), sleep(3), now();</span><br><span class=\"line\">&gt; select sysdate(), sleep(3), sysdate();</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>感兴趣的可以看一下这两天sql执行的结果</p>\n</blockquote>\n<h5 id=\"获得当前时间戳函数：current-timestamp-current-timestamp\"><a href=\"#获得当前时间戳函数：current-timestamp-current-timestamp\" class=\"headerlink\" title=\"获得当前时间戳函数：current_timestamp, current_timestamp()\"></a>获得当前时间戳函数：current_timestamp, current_timestamp()</h5><p>语法: <code>select current_timestamp, current_timestamp()</code></p>\n<h5 id=\"日期、时间转换\"><a href=\"#日期、时间转换\" class=\"headerlink\" title=\"日期、时间转换\"></a>日期、时间转换</h5><p>时间转换为字符串 date_format(date,format), time_format(time,format)</p>\n<p>时间格式化函数 DATE_FORMAT(date, format)</p>\n<ol>\n<li>date 时间</li>\n<li>format 参数格式有</li>\n</ol>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">参数</th>\n<th style=\"text-align:center\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">%a</td>\n<td style=\"text-align:center\">缩写星期名</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%b</td>\n<td style=\"text-align:center\">缩写月名</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%c</td>\n<td style=\"text-align:center\">月，数值</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%D</td>\n<td style=\"text-align:center\">带有英文前缀的月中的天</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%d</td>\n<td style=\"text-align:center\">月的天，数值(00-31)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%e</td>\n<td style=\"text-align:center\">月的天，数值(0-31)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%f</td>\n<td style=\"text-align:center\">微秒</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%H</td>\n<td style=\"text-align:center\">小时 (00-23)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%h</td>\n<td style=\"text-align:center\">小时 (01-12)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%I</td>\n<td style=\"text-align:center\">小时 (01-12)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%i</td>\n<td style=\"text-align:center\">分钟，数值(00-59)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%j</td>\n<td style=\"text-align:center\">年的天 (001-366)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%k</td>\n<td style=\"text-align:center\">小时 (0-23)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%l</td>\n<td style=\"text-align:center\">小时 (1-12)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%M</td>\n<td style=\"text-align:center\">月名</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%m</td>\n<td style=\"text-align:center\">月，数值(00-12)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%p</td>\n<td style=\"text-align:center\">AM 或 PM</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%r</td>\n<td style=\"text-align:center\">时间，12-小时（hh:mm:ss AM 或 PM）</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%S</td>\n<td style=\"text-align:center\">秒(00-59)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%s</td>\n<td style=\"text-align:center\">秒(00-59)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%T</td>\n<td style=\"text-align:center\">时间, 24-小时 (hh:mm:ss)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%U</td>\n<td style=\"text-align:center\">周 (00-53) 星期日是一周的第一天</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%u</td>\n<td style=\"text-align:center\">周 (00-53) 星期一是一周的第一天</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%V</td>\n<td style=\"text-align:center\">周 (01-53) 星期日是一周的第一天，与 %X 使用</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%v</td>\n<td style=\"text-align:center\">周 (01-53) 星期一是一周的第一天，与 %x 使用</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%W</td>\n<td style=\"text-align:center\">星期名</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%w</td>\n<td style=\"text-align:center\">周的天 （0=星期日, 6=星期六）</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%X</td>\n<td style=\"text-align:center\">年，其中的星期日是周的第一天，4 位，与 %V 使用</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%x</td>\n<td style=\"text-align:center\">年，其中的星期一是周的第一天，4 位，与 %v 使用</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%Y</td>\n<td style=\"text-align:center\">年，4 位</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">%y</td>\n<td style=\"text-align:center\">年，2 位</td>\n</tr>\n</tbody>\n</table>\n<p>字符串转换为时间 str_to_date(str, format)</p>\n<p>(日期、天数）转换函数：to_days(date), from_days(days)</p>\n<p>(时间、秒）转换函数：time_to_sec(time), sec_to_time(seconds)</p>\n<p>拼凑日期、时间函数：makdedate(year,dayofyear), maketime(hour,minute,second)</p>\n<p>Unix 时间戳、日期）转换函数</p>\n<ol>\n<li>unix_timestamp(),</li>\n<li>unix_timestamp(date),</li>\n<li>from_unixtime(unix_timestamp),</li>\n<li>from_unixtime(unix_timestamp,format)<ol>\n<li>格式化函数 FROM_UNIXTIME(unix_timestamp, [format])</li>\n<li>unix_timestamp 一般为10位的时间戳，如:1417363200</li>\n<li>format <em>可选</em> 转换之后的时间字符串显示的格式;</li>\n</ol>\n</li>\n</ol>\n<h5 id=\"日期时间计算函数\"><a href=\"#日期时间计算函数\" class=\"headerlink\" title=\"日期时间计算函数\"></a>日期时间计算函数</h5><p>增加一个时间间隔：DATE_ADD(date,INTERVAL expr type)</p>\n<ul>\n<li>date 要操作的时间</li>\n<li>expr 要添加的时间间隔</li>\n<li>type 参考下表</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">type的值</th>\n<th style=\"text-align:center\">备注</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">MICROSECOND</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">SECOND</td>\n<td style=\"text-align:center\">秒</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">MINUTE</td>\n<td style=\"text-align:center\">分</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">HOUR</td>\n<td style=\"text-align:center\">小时</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">DAY</td>\n<td style=\"text-align:center\">天</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">WEEK</td>\n<td style=\"text-align:center\">星期</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">MONTH</td>\n<td style=\"text-align:center\">月</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">QUARTER</td>\n<td style=\"text-align:center\">?</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">YEAR</td>\n<td style=\"text-align:center\">年</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">SECOND_MICROSECOND</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">MINUTE_MICROSECOND</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">MINUTE_SECOND</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">HOUR_MICROSECOND</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">HOUR_SECOND</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">HOUR_MINUTE</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">DAY_MICROSECOND</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">DAY_SECOND</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">DAY_MINUTE</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">DAY_HOUR</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">YEAR_MONTH</td>\n<td style=\"text-align:center\"></td>\n</tr>\n</tbody>\n</table>\n<blockquote>\n<p>adddate(), addtime()函数，可以用 date_add() 来替代</p>\n</blockquote>\n<p>日期减去一个时间间隔：DATE_SUB(date,INTERVAL expr type)</p>\n<blockquote>\n<p>DATE_SUB(date,INTERVAL expr type) 日期时间函数 和 date_add() 用法一致</p>\n</blockquote>\n<p>日期、时间相减函数：datediff(date1,date2), timediff(time1,time2)</p>\n<ol>\n<li>datediff 返回天数差距</li>\n<li>timediff 返回time差距</li>\n</ol>\n<blockquote>\n<p>注意：timediff(time1,time2) 函数的两个参数类型必须相同。</p>\n</blockquote>\n<p>时间戳（timestamp）转换、增、减函数</p>\n<ol>\n<li>timestamp(date) – date to timestamp</li>\n<li>timestamp(dt,time) – dt + time</li>\n<li>timestampadd(unit,interval,datetime_expr) –</li>\n<li>timestampdiff(unit,datetime_expr1,datetime_expr2) –</li>\n</ol>\n<p>示例:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">select timestamp(<span class=\"string\">'2008-08-08'</span>); -- 2008-08-08 00:00:00</span><br><span class=\"line\">select timestamp(<span class=\"string\">'2008-08-08 08:00:00'</span>, <span class=\"string\">'01:01:01'</span>); -- 2008-08-08 09:01:01</span><br><span class=\"line\">select timestamp(<span class=\"string\">'2008-08-08 08:00:00'</span>, <span class=\"string\">'10 01:01:01'</span>); -- 2008-08-18 09:01:01</span><br><span class=\"line\"></span><br><span class=\"line\">select timestampadd(day, 1, <span class=\"string\">'2008-08-08 08:00:00'</span>); -- 2008-08-09 08:00:00</span><br><span class=\"line\">select date_add(<span class=\"string\">'2008-08-08 08:00:00'</span>, interval 1 day); -- 2008-08-09 08:00:00</span><br><span class=\"line\"></span><br><span class=\"line\">timestampadd() 函数类似于 date_add()。</span><br><span class=\"line\">select timestampdiff(year,<span class=\"string\">'2002-05-01'</span>,<span class=\"string\">'2001-01-01'</span>); -- -1</span><br><span class=\"line\">select timestampdiff(day ,<span class=\"string\">'2002-05-01'</span>,<span class=\"string\">'2001-01-01'</span>); -- -485</span><br><span class=\"line\">select timestampdiff(hour,<span class=\"string\">'2008-08-08 12:00:00'</span>,<span class=\"string\">'2008-08-08 00:00:00'</span>); -- -12</span><br><span class=\"line\"></span><br><span class=\"line\">select datediff(<span class=\"string\">'2008-08-08 12:00:00'</span>, <span class=\"string\">'2008-08-01 00:00:00'</span>); -- 7</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>timestampdiff() 函数就比 datediff() 功能强多了，datediff() 只能计算两个日期（date）之间相差的天数。</p>\n</blockquote>\n<p>时区（timezone）转换函数</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">convert_tz(dt,from_tz,to_tz)</span><br><span class=\"line\"></span><br><span class=\"line\">select convert_tz(<span class=\"string\">'2008-08-08 12:00:00'</span>, <span class=\"string\">'+08:00'</span>, <span class=\"string\">'+00:00'</span>); -- 2008-08-08 04:00:00</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>时区转换也可以通过 date_add, date_sub, timestampadd 来实现</p>\n</blockquote>\n<h2 id=\"相关链接\"><a href=\"#相关链接\" class=\"headerlink\" title=\"相关链接\"></a>相关链接</h2><p><a href=\"https://www.cnblogs.com/chenqionghe/p/4675844.html\" target=\"_blank\" rel=\"noopener\">MySQL CAST与CONVERT 函数的用法</a></p>\n<p><a href=\"https://www.cnblogs.com/dest/p/4205371.html\" target=\"_blank\" rel=\"noopener\">MySQL 日期格式</a></p>\n<h2 id=\"结语\"><a href=\"#结语\" class=\"headerlink\" title=\"结语\"></a>结语</h2><p>每天都要去折腾才能进步</p>\n"},{"title":"正则表达式","date":"2019-07-17T03:19:25.000Z","_content":"\n学习正则表达式\n\n[正则表达式30分钟入门教程](https://deerchao.net/tutorials/regex/regex.htm)\n\n[Python - 100天从新手到大师](https://github.com/jackfrued/Python-100-Days)\n\n## 基本\n\n符号|解释|示例|说明\n:-------:|:-----------------------:|:--------------------------------:|:----------------------------------:\n.|匹配任意字符|b.t|可以匹配bat / but / b#t / b1t等\n\\w|匹配字母/数字/下划线|b\\wt|可以匹配bat / b1t / b_t等但不能匹配b#t\n\\s|匹配空白字符（包括\\r、\\n、\\t等）|love\\syou|可以匹配love you\n\\d|匹配数字|\\d\\d|可以匹配01 / 23 / 99等\n\\b|匹配单词的边界|\\bThe\\b|\n^|匹配字符串的开始|^The|可以匹配The开头的字符串\n$|匹配字符串的结束|.exe$|可以匹配.exe结尾的字符串\n\\W|匹配非字母/数字/下划线|b\\Wt|可以匹配b#t / b@t等但不能匹配but / b1t / b_t等\n\\S|匹配非空白字符|love\\Syou|可以匹配love#you等但不能匹配love you\n\\D|匹配非数字|\\d\\D|可以匹配9a / 3# / 0F等\n\\B|匹配非单词边界|\\Bio\\B|\n[]|匹配来自字符集的任意单一字符|[aeiou]|可以匹配任一元音字母字符\n[^]|匹配不在字符集中的任意单一字符|[^aeiou]|可以匹配任一非元音字母字符\n*|匹配0次或多次|\\w*|\n+|匹配1次或多次|\\w+|\n?|匹配0次或1次|\\w?|\n{N}|匹配N次|\\w{3}|\n{M,}|匹配至少M次|\\w{3,}|\n{M,N}|匹配至少M次至多N次|\\w{3,6}|\n\\||分支|foo|bar|可以匹配foo或者bar\n(?#)|注释||\n(exp)|匹配exp并捕获到自动命名的组中||\n(?<name>exp)|匹配exp并捕获到名为name的组中||\n(?:exp)|匹配exp但是不捕获匹配的文本||\n(?=exp)|匹配exp前面的位置|\\b\\w+(?=ing)|可以匹配I'm dancing中的danc\n(?<=exp)|匹配exp后面的位置|(?<=\\bdanc)\\w+\\b|可以匹配I love dancing and reading中的第一个ing\n(?!exp)|匹配后面不是exp的位置||\n(?<!exp)|匹配前面不是exp的位置||\n*?|重复任意次，但尽可能少重复|a.*b\na.*?b|将正则表达式应用于aabab，前者会匹配整个字符串aabab，后者会匹配aab和ab两个字符串\n+?|重复1次或多次，但尽可能少重复||\n??|重复0次或1次，但尽可能少重复||\n{M,N}?|重复M到N次，但尽可能少重复||\n{M,}?|重复M次以上，但尽可能少重复||\n","source":"_posts/regular.md","raw":"---\ntitle: 正则表达式\ndate: 2019-07-17 11:19:25\ntags:\n---\n\n学习正则表达式\n\n[正则表达式30分钟入门教程](https://deerchao.net/tutorials/regex/regex.htm)\n\n[Python - 100天从新手到大师](https://github.com/jackfrued/Python-100-Days)\n\n## 基本\n\n符号|解释|示例|说明\n:-------:|:-----------------------:|:--------------------------------:|:----------------------------------:\n.|匹配任意字符|b.t|可以匹配bat / but / b#t / b1t等\n\\w|匹配字母/数字/下划线|b\\wt|可以匹配bat / b1t / b_t等但不能匹配b#t\n\\s|匹配空白字符（包括\\r、\\n、\\t等）|love\\syou|可以匹配love you\n\\d|匹配数字|\\d\\d|可以匹配01 / 23 / 99等\n\\b|匹配单词的边界|\\bThe\\b|\n^|匹配字符串的开始|^The|可以匹配The开头的字符串\n$|匹配字符串的结束|.exe$|可以匹配.exe结尾的字符串\n\\W|匹配非字母/数字/下划线|b\\Wt|可以匹配b#t / b@t等但不能匹配but / b1t / b_t等\n\\S|匹配非空白字符|love\\Syou|可以匹配love#you等但不能匹配love you\n\\D|匹配非数字|\\d\\D|可以匹配9a / 3# / 0F等\n\\B|匹配非单词边界|\\Bio\\B|\n[]|匹配来自字符集的任意单一字符|[aeiou]|可以匹配任一元音字母字符\n[^]|匹配不在字符集中的任意单一字符|[^aeiou]|可以匹配任一非元音字母字符\n*|匹配0次或多次|\\w*|\n+|匹配1次或多次|\\w+|\n?|匹配0次或1次|\\w?|\n{N}|匹配N次|\\w{3}|\n{M,}|匹配至少M次|\\w{3,}|\n{M,N}|匹配至少M次至多N次|\\w{3,6}|\n\\||分支|foo|bar|可以匹配foo或者bar\n(?#)|注释||\n(exp)|匹配exp并捕获到自动命名的组中||\n(?<name>exp)|匹配exp并捕获到名为name的组中||\n(?:exp)|匹配exp但是不捕获匹配的文本||\n(?=exp)|匹配exp前面的位置|\\b\\w+(?=ing)|可以匹配I'm dancing中的danc\n(?<=exp)|匹配exp后面的位置|(?<=\\bdanc)\\w+\\b|可以匹配I love dancing and reading中的第一个ing\n(?!exp)|匹配后面不是exp的位置||\n(?<!exp)|匹配前面不是exp的位置||\n*?|重复任意次，但尽可能少重复|a.*b\na.*?b|将正则表达式应用于aabab，前者会匹配整个字符串aabab，后者会匹配aab和ab两个字符串\n+?|重复1次或多次，但尽可能少重复||\n??|重复0次或1次，但尽可能少重复||\n{M,N}?|重复M到N次，但尽可能少重复||\n{M,}?|重复M次以上，但尽可能少重复||\n","slug":"regular","published":1,"updated":"2019-08-24T07:00:07.224Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck550trlw000whm62qv19wsac","content":"<p>学习正则表达式</p>\n<p><a href=\"https://deerchao.net/tutorials/regex/regex.htm\" target=\"_blank\" rel=\"noopener\">正则表达式30分钟入门教程</a></p>\n<p><a href=\"https://github.com/jackfrued/Python-100-Days\" target=\"_blank\" rel=\"noopener\">Python - 100天从新手到大师</a></p>\n<h2 id=\"基本\"><a href=\"#基本\" class=\"headerlink\" title=\"基本\"></a>基本</h2><table>\n<thead>\n<tr>\n<th style=\"text-align:center\">符号</th>\n<th style=\"text-align:center\">解释</th>\n<th style=\"text-align:center\">示例</th>\n<th style=\"text-align:center\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">.</td>\n<td style=\"text-align:center\">匹配任意字符</td>\n<td style=\"text-align:center\">b.t</td>\n<td style=\"text-align:center\">可以匹配bat / but / b#t / b1t等</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">\\w</td>\n<td style=\"text-align:center\">匹配字母/数字/下划线</td>\n<td style=\"text-align:center\">b\\wt</td>\n<td style=\"text-align:center\">可以匹配bat / b1t / b_t等但不能匹配b#t</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">\\s</td>\n<td style=\"text-align:center\">匹配空白字符（包括\\r、\\n、\\t等）</td>\n<td style=\"text-align:center\">love\\syou</td>\n<td style=\"text-align:center\">可以匹配love you</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">\\d</td>\n<td style=\"text-align:center\">匹配数字</td>\n<td style=\"text-align:center\">\\d\\d</td>\n<td style=\"text-align:center\">可以匹配01 / 23 / 99等</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">\\b</td>\n<td style=\"text-align:center\">匹配单词的边界</td>\n<td style=\"text-align:center\">\\bThe\\b</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">^</td>\n<td style=\"text-align:center\">匹配字符串的开始</td>\n<td style=\"text-align:center\">^The</td>\n<td style=\"text-align:center\">可以匹配The开头的字符串</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">$</td>\n<td style=\"text-align:center\">匹配字符串的结束</td>\n<td style=\"text-align:center\">.exe$</td>\n<td style=\"text-align:center\">可以匹配.exe结尾的字符串</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">\\W</td>\n<td style=\"text-align:center\">匹配非字母/数字/下划线</td>\n<td style=\"text-align:center\">b\\Wt</td>\n<td style=\"text-align:center\">可以匹配b#t / b@t等但不能匹配but / b1t / b_t等</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">\\S</td>\n<td style=\"text-align:center\">匹配非空白字符</td>\n<td style=\"text-align:center\">love\\Syou</td>\n<td style=\"text-align:center\">可以匹配love#you等但不能匹配love you</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">\\D</td>\n<td style=\"text-align:center\">匹配非数字</td>\n<td style=\"text-align:center\">\\d\\D</td>\n<td style=\"text-align:center\">可以匹配9a / 3# / 0F等</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">\\B</td>\n<td style=\"text-align:center\">匹配非单词边界</td>\n<td style=\"text-align:center\">\\Bio\\B</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">[]</td>\n<td style=\"text-align:center\">匹配来自字符集的任意单一字符</td>\n<td style=\"text-align:center\">[aeiou]</td>\n<td style=\"text-align:center\">可以匹配任一元音字母字符</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">[^]</td>\n<td style=\"text-align:center\">匹配不在字符集中的任意单一字符</td>\n<td style=\"text-align:center\">[^aeiou]</td>\n<td style=\"text-align:center\">可以匹配任一非元音字母字符</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">*</td>\n<td style=\"text-align:center\">匹配0次或多次</td>\n<td style=\"text-align:center\">\\w*</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">+</td>\n<td style=\"text-align:center\">匹配1次或多次</td>\n<td style=\"text-align:center\">\\w+</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">?</td>\n<td style=\"text-align:center\">匹配0次或1次</td>\n<td style=\"text-align:center\">\\w?</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">{N}</td>\n<td style=\"text-align:center\">匹配N次</td>\n<td style=\"text-align:center\">\\w{3}</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">{M,}</td>\n<td style=\"text-align:center\">匹配至少M次</td>\n<td style=\"text-align:center\">\\w{3,}</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">{M,N}</td>\n<td style=\"text-align:center\">匹配至少M次至多N次</td>\n<td style=\"text-align:center\">\\w{3,6}</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">\\</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">分支</td>\n<td style=\"text-align:center\">foo</td>\n<td>bar</td>\n<td>可以匹配foo或者bar</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">(?#)</td>\n<td style=\"text-align:center\">注释</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">(exp)</td>\n<td style=\"text-align:center\">匹配exp并捕获到自动命名的组中</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">(?<name>exp)</name></td>\n<td style=\"text-align:center\">匹配exp并捕获到名为name的组中</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">(?:exp)</td>\n<td style=\"text-align:center\">匹配exp但是不捕获匹配的文本</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">(?=exp)</td>\n<td style=\"text-align:center\">匹配exp前面的位置</td>\n<td style=\"text-align:center\">\\b\\w+(?=ing)</td>\n<td style=\"text-align:center\">可以匹配I’m dancing中的danc</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">(?&lt;=exp)</td>\n<td style=\"text-align:center\">匹配exp后面的位置</td>\n<td style=\"text-align:center\">(?&lt;=\\bdanc)\\w+\\b</td>\n<td style=\"text-align:center\">可以匹配I love dancing and reading中的第一个ing</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">(?!exp)</td>\n<td style=\"text-align:center\">匹配后面不是exp的位置</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">(?&lt;!exp)</td>\n<td style=\"text-align:center\">匹配前面不是exp的位置</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">*?</td>\n<td style=\"text-align:center\">重复任意次，但尽可能少重复</td>\n<td style=\"text-align:center\">a.*b</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">a.*?b</td>\n<td style=\"text-align:center\">将正则表达式应用于aabab，前者会匹配整个字符串aabab，后者会匹配aab和ab两个字符串</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">+?</td>\n<td style=\"text-align:center\">重复1次或多次，但尽可能少重复</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">??</td>\n<td style=\"text-align:center\">重复0次或1次，但尽可能少重复</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">{M,N}?</td>\n<td style=\"text-align:center\">重复M到N次，但尽可能少重复</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">{M,}?</td>\n<td style=\"text-align:center\">重复M次以上，但尽可能少重复</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n</tr>\n</tbody>\n</table>\n","site":{"data":{}},"excerpt":"","more":"<p>学习正则表达式</p>\n<p><a href=\"https://deerchao.net/tutorials/regex/regex.htm\" target=\"_blank\" rel=\"noopener\">正则表达式30分钟入门教程</a></p>\n<p><a href=\"https://github.com/jackfrued/Python-100-Days\" target=\"_blank\" rel=\"noopener\">Python - 100天从新手到大师</a></p>\n<h2 id=\"基本\"><a href=\"#基本\" class=\"headerlink\" title=\"基本\"></a>基本</h2><table>\n<thead>\n<tr>\n<th style=\"text-align:center\">符号</th>\n<th style=\"text-align:center\">解释</th>\n<th style=\"text-align:center\">示例</th>\n<th style=\"text-align:center\">说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">.</td>\n<td style=\"text-align:center\">匹配任意字符</td>\n<td style=\"text-align:center\">b.t</td>\n<td style=\"text-align:center\">可以匹配bat / but / b#t / b1t等</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">\\w</td>\n<td style=\"text-align:center\">匹配字母/数字/下划线</td>\n<td style=\"text-align:center\">b\\wt</td>\n<td style=\"text-align:center\">可以匹配bat / b1t / b_t等但不能匹配b#t</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">\\s</td>\n<td style=\"text-align:center\">匹配空白字符（包括\\r、\\n、\\t等）</td>\n<td style=\"text-align:center\">love\\syou</td>\n<td style=\"text-align:center\">可以匹配love you</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">\\d</td>\n<td style=\"text-align:center\">匹配数字</td>\n<td style=\"text-align:center\">\\d\\d</td>\n<td style=\"text-align:center\">可以匹配01 / 23 / 99等</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">\\b</td>\n<td style=\"text-align:center\">匹配单词的边界</td>\n<td style=\"text-align:center\">\\bThe\\b</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">^</td>\n<td style=\"text-align:center\">匹配字符串的开始</td>\n<td style=\"text-align:center\">^The</td>\n<td style=\"text-align:center\">可以匹配The开头的字符串</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">$</td>\n<td style=\"text-align:center\">匹配字符串的结束</td>\n<td style=\"text-align:center\">.exe$</td>\n<td style=\"text-align:center\">可以匹配.exe结尾的字符串</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">\\W</td>\n<td style=\"text-align:center\">匹配非字母/数字/下划线</td>\n<td style=\"text-align:center\">b\\Wt</td>\n<td style=\"text-align:center\">可以匹配b#t / b@t等但不能匹配but / b1t / b_t等</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">\\S</td>\n<td style=\"text-align:center\">匹配非空白字符</td>\n<td style=\"text-align:center\">love\\Syou</td>\n<td style=\"text-align:center\">可以匹配love#you等但不能匹配love you</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">\\D</td>\n<td style=\"text-align:center\">匹配非数字</td>\n<td style=\"text-align:center\">\\d\\D</td>\n<td style=\"text-align:center\">可以匹配9a / 3# / 0F等</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">\\B</td>\n<td style=\"text-align:center\">匹配非单词边界</td>\n<td style=\"text-align:center\">\\Bio\\B</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">[]</td>\n<td style=\"text-align:center\">匹配来自字符集的任意单一字符</td>\n<td style=\"text-align:center\">[aeiou]</td>\n<td style=\"text-align:center\">可以匹配任一元音字母字符</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">[^]</td>\n<td style=\"text-align:center\">匹配不在字符集中的任意单一字符</td>\n<td style=\"text-align:center\">[^aeiou]</td>\n<td style=\"text-align:center\">可以匹配任一非元音字母字符</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">*</td>\n<td style=\"text-align:center\">匹配0次或多次</td>\n<td style=\"text-align:center\">\\w*</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">+</td>\n<td style=\"text-align:center\">匹配1次或多次</td>\n<td style=\"text-align:center\">\\w+</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">?</td>\n<td style=\"text-align:center\">匹配0次或1次</td>\n<td style=\"text-align:center\">\\w?</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">{N}</td>\n<td style=\"text-align:center\">匹配N次</td>\n<td style=\"text-align:center\">\\w{3}</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">{M,}</td>\n<td style=\"text-align:center\">匹配至少M次</td>\n<td style=\"text-align:center\">\\w{3,}</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">{M,N}</td>\n<td style=\"text-align:center\">匹配至少M次至多N次</td>\n<td style=\"text-align:center\">\\w{3,6}</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">\\</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">分支</td>\n<td style=\"text-align:center\">foo</td>\n<td>bar</td>\n<td>可以匹配foo或者bar</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">(?#)</td>\n<td style=\"text-align:center\">注释</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">(exp)</td>\n<td style=\"text-align:center\">匹配exp并捕获到自动命名的组中</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">(?<name>exp)</name></td>\n<td style=\"text-align:center\">匹配exp并捕获到名为name的组中</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">(?:exp)</td>\n<td style=\"text-align:center\">匹配exp但是不捕获匹配的文本</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">(?=exp)</td>\n<td style=\"text-align:center\">匹配exp前面的位置</td>\n<td style=\"text-align:center\">\\b\\w+(?=ing)</td>\n<td style=\"text-align:center\">可以匹配I’m dancing中的danc</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">(?&lt;=exp)</td>\n<td style=\"text-align:center\">匹配exp后面的位置</td>\n<td style=\"text-align:center\">(?&lt;=\\bdanc)\\w+\\b</td>\n<td style=\"text-align:center\">可以匹配I love dancing and reading中的第一个ing</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">(?!exp)</td>\n<td style=\"text-align:center\">匹配后面不是exp的位置</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">(?&lt;!exp)</td>\n<td style=\"text-align:center\">匹配前面不是exp的位置</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">*?</td>\n<td style=\"text-align:center\">重复任意次，但尽可能少重复</td>\n<td style=\"text-align:center\">a.*b</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">a.*?b</td>\n<td style=\"text-align:center\">将正则表达式应用于aabab，前者会匹配整个字符串aabab，后者会匹配aab和ab两个字符串</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">+?</td>\n<td style=\"text-align:center\">重复1次或多次，但尽可能少重复</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">??</td>\n<td style=\"text-align:center\">重复0次或1次，但尽可能少重复</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">{M,N}?</td>\n<td style=\"text-align:center\">重复M到N次，但尽可能少重复</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">{M,}?</td>\n<td style=\"text-align:center\">重复M次以上，但尽可能少重复</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n</tr>\n</tbody>\n</table>\n"},{"title":"Shell学习笔记","date":"2019-06-18T02:55:39.000Z","_content":"\nShell 是一个用 C 语言编写的程序，它是用户使用 Linux 的桥梁\n\nShell 编程跟 java、php 编程一样，只要有一个能编写代码¸的文本编辑器和一个能解释执行的脚本解释器就可以了。\n\n## 开始\n\n### 创建脚本文件\n\n新建一个扩展名为`.sh`的文件`test.sh`, sh代表*shell*\n\ntest.sh文件内容如下:\n\n```sh\n#!/bin/bash\necho \"Hello Shell\"\n```\n\n> `#!` 是一个约定俗成的标记, 用于告诉系统使用哪个解释器来执行这个脚本.  \n> `echo` 命令是用于向终端输出文本信息,也可用于向文件中写入数据\n\n### 运行shell脚本\n\n运行shell脚本的方式两种\n\n+ 通过可执行文件运行\n\n需要给脚本文件添加可执行权限\n\n```sh\n# 在 test.sh 文件所在的文件夹下, 执行以下命令\nchmod +x ./test.sh\n```\n\n> 这里需要注意的是, 一定要写成`./test.sh`而不是`test.sh`, 否责系统可能会找不到脚本文件, `./`的意思是 指定在当前文件路径下查找文件\n\n+ 作为解释器参数\n\n```sh\n/bin/sh test.sh\n/bin/php test.php\n```\n\n> 这种方式下,在文件第一行添加*标记*也没有效果(因为你已经指定了解释器来运行脚本)\n\n## 变量\n\n规则:\n\n1. 定义变量时，变量名不加美元符号\n2. 变量名和等号之间不能有空格\n3. 命名只能使用英文字母，数字和下划线，首个字符不能以数字开头。\n4. 中间不能有空格，可以使用下划线（_）。\n5. 不能使用标点符号。\n6. 不能使用bash里的关键字（可用help命令查看保留关键字）。\n\n示例:\n\n有效命名:\n\n```sh\nRUNOOB\nLD_LIBRARY_PATH\n_var\nvar2\n```\n\n无效命名:\n\n```sh\n?var=123\nuser*name=runoob\n```\n\n显示赋值\n\n`your_name=\"runoob.com\"`\n\n通过语句赋值\n\n```sh\nfor file in `ls /etc`\n# 或\nfor file in $(ls /etc)\n```\n\n> 以上语句, 列出`/etc`路径下的所有文件名,赋值给`file`\n\n### 使用变量\n\n使用变量,只需要在变量前面加一个`$`符号\n\n```sh\nname=\"shell\"\necho $name\necho ${name}\n```\n\n`$name`和`${name}`都是可以的, `{}`是可选的, 它的作用是帮助解释器来识别变量边界的, 比如:\n\n```sh\nfor skill in Ada Coffe Action Java; do\n    echo \"I am good at ${skill}Script\"\ndone\n```\n\n如果不加 `{}` 则解释器认为`$skillScript`是一个变量(内容为空),\n\n>> 推荐给所有的变量加上`{}`,养成好的编程习惯\n\n### 只读变量\n\n已经定义的变量可以被重新赋值, **只读变量**除外\n\n定义方式为: 在变量前面加上 `readonly`\n\n```sh\nreadonly name=\"Shell\"\nname=\"jason\" # 这里会报错  error: NAME: This variable is read only.\n```\n\n### 删除变量\n\n```sh\nunset name\n```\n\n> unset 命令不能删除只读变量。 删除之后不能使用\n\n## 参考\n\n[菜鸟教程](https://www.runoob.com/linux/linux-shell.html \"Linux Shell教程\")\n\n## 结语\n\n学习一门技术, 开始的时候不要纠结各种看不懂的语法、不钻牛角尖, 先培养兴趣, 再循序渐进.\n","source":"_posts/shell.md","raw":"---\ntitle: Shell学习笔记\ndate: 2019-06-18 10:55:39\ntags: 脚本语言\n---\n\nShell 是一个用 C 语言编写的程序，它是用户使用 Linux 的桥梁\n\nShell 编程跟 java、php 编程一样，只要有一个能编写代码¸的文本编辑器和一个能解释执行的脚本解释器就可以了。\n\n## 开始\n\n### 创建脚本文件\n\n新建一个扩展名为`.sh`的文件`test.sh`, sh代表*shell*\n\ntest.sh文件内容如下:\n\n```sh\n#!/bin/bash\necho \"Hello Shell\"\n```\n\n> `#!` 是一个约定俗成的标记, 用于告诉系统使用哪个解释器来执行这个脚本.  \n> `echo` 命令是用于向终端输出文本信息,也可用于向文件中写入数据\n\n### 运行shell脚本\n\n运行shell脚本的方式两种\n\n+ 通过可执行文件运行\n\n需要给脚本文件添加可执行权限\n\n```sh\n# 在 test.sh 文件所在的文件夹下, 执行以下命令\nchmod +x ./test.sh\n```\n\n> 这里需要注意的是, 一定要写成`./test.sh`而不是`test.sh`, 否责系统可能会找不到脚本文件, `./`的意思是 指定在当前文件路径下查找文件\n\n+ 作为解释器参数\n\n```sh\n/bin/sh test.sh\n/bin/php test.php\n```\n\n> 这种方式下,在文件第一行添加*标记*也没有效果(因为你已经指定了解释器来运行脚本)\n\n## 变量\n\n规则:\n\n1. 定义变量时，变量名不加美元符号\n2. 变量名和等号之间不能有空格\n3. 命名只能使用英文字母，数字和下划线，首个字符不能以数字开头。\n4. 中间不能有空格，可以使用下划线（_）。\n5. 不能使用标点符号。\n6. 不能使用bash里的关键字（可用help命令查看保留关键字）。\n\n示例:\n\n有效命名:\n\n```sh\nRUNOOB\nLD_LIBRARY_PATH\n_var\nvar2\n```\n\n无效命名:\n\n```sh\n?var=123\nuser*name=runoob\n```\n\n显示赋值\n\n`your_name=\"runoob.com\"`\n\n通过语句赋值\n\n```sh\nfor file in `ls /etc`\n# 或\nfor file in $(ls /etc)\n```\n\n> 以上语句, 列出`/etc`路径下的所有文件名,赋值给`file`\n\n### 使用变量\n\n使用变量,只需要在变量前面加一个`$`符号\n\n```sh\nname=\"shell\"\necho $name\necho ${name}\n```\n\n`$name`和`${name}`都是可以的, `{}`是可选的, 它的作用是帮助解释器来识别变量边界的, 比如:\n\n```sh\nfor skill in Ada Coffe Action Java; do\n    echo \"I am good at ${skill}Script\"\ndone\n```\n\n如果不加 `{}` 则解释器认为`$skillScript`是一个变量(内容为空),\n\n>> 推荐给所有的变量加上`{}`,养成好的编程习惯\n\n### 只读变量\n\n已经定义的变量可以被重新赋值, **只读变量**除外\n\n定义方式为: 在变量前面加上 `readonly`\n\n```sh\nreadonly name=\"Shell\"\nname=\"jason\" # 这里会报错  error: NAME: This variable is read only.\n```\n\n### 删除变量\n\n```sh\nunset name\n```\n\n> unset 命令不能删除只读变量。 删除之后不能使用\n\n## 参考\n\n[菜鸟教程](https://www.runoob.com/linux/linux-shell.html \"Linux Shell教程\")\n\n## 结语\n\n学习一门技术, 开始的时候不要纠结各种看不懂的语法、不钻牛角尖, 先培养兴趣, 再循序渐进.\n","slug":"shell","published":1,"updated":"2019-06-19T09:17:29.990Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck550trlx000yhm62nsnlaljo","content":"<p>Shell 是一个用 C 语言编写的程序，它是用户使用 Linux 的桥梁</p>\n<p>Shell 编程跟 java、php 编程一样，只要有一个能编写代码¸的文本编辑器和一个能解释执行的脚本解释器就可以了。</p>\n<h2 id=\"开始\"><a href=\"#开始\" class=\"headerlink\" title=\"开始\"></a>开始</h2><h3 id=\"创建脚本文件\"><a href=\"#创建脚本文件\" class=\"headerlink\" title=\"创建脚本文件\"></a>创建脚本文件</h3><p>新建一个扩展名为<code>.sh</code>的文件<code>test.sh</code>, sh代表<em>shell</em></p>\n<p>test.sh文件内容如下:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"Hello Shell\"</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><code>#!</code> 是一个约定俗成的标记, 用于告诉系统使用哪个解释器来执行这个脚本.<br><code>echo</code> 命令是用于向终端输出文本信息,也可用于向文件中写入数据</p>\n</blockquote>\n<h3 id=\"运行shell脚本\"><a href=\"#运行shell脚本\" class=\"headerlink\" title=\"运行shell脚本\"></a>运行shell脚本</h3><p>运行shell脚本的方式两种</p>\n<ul>\n<li>通过可执行文件运行</li>\n</ul>\n<p>需要给脚本文件添加可执行权限</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 在 test.sh 文件所在的文件夹下, 执行以下命令</span></span><br><span class=\"line\">chmod +x ./test.sh</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>这里需要注意的是, 一定要写成<code>./test.sh</code>而不是<code>test.sh</code>, 否责系统可能会找不到脚本文件, <code>./</code>的意思是 指定在当前文件路径下查找文件</p>\n</blockquote>\n<ul>\n<li>作为解释器参数</li>\n</ul>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/bin/sh test.sh</span><br><span class=\"line\">/bin/php test.php</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>这种方式下,在文件第一行添加<em>标记</em>也没有效果(因为你已经指定了解释器来运行脚本)</p>\n</blockquote>\n<h2 id=\"变量\"><a href=\"#变量\" class=\"headerlink\" title=\"变量\"></a>变量</h2><p>规则:</p>\n<ol>\n<li>定义变量时，变量名不加美元符号</li>\n<li>变量名和等号之间不能有空格</li>\n<li>命名只能使用英文字母，数字和下划线，首个字符不能以数字开头。</li>\n<li>中间不能有空格，可以使用下划线（_）。</li>\n<li>不能使用标点符号。</li>\n<li>不能使用bash里的关键字（可用help命令查看保留关键字）。</li>\n</ol>\n<p>示例:</p>\n<p>有效命名:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">RUNOOB</span><br><span class=\"line\">LD_LIBRARY_PATH</span><br><span class=\"line\">_var</span><br><span class=\"line\">var2</span><br></pre></td></tr></table></figure>\n<p>无效命名:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?var=123</span><br><span class=\"line\">user*name=runoob</span><br></pre></td></tr></table></figure>\n<p>显示赋值</p>\n<p><code>your_name=&quot;runoob.com&quot;</code></p>\n<p>通过语句赋值</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> file <span class=\"keyword\">in</span> `ls /etc`</span><br><span class=\"line\"><span class=\"comment\"># 或</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> file <span class=\"keyword\">in</span> $(ls /etc)</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>以上语句, 列出<code>/etc</code>路径下的所有文件名,赋值给<code>file</code></p>\n</blockquote>\n<h3 id=\"使用变量\"><a href=\"#使用变量\" class=\"headerlink\" title=\"使用变量\"></a>使用变量</h3><p>使用变量,只需要在变量前面加一个<code>$</code>符号</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">name=<span class=\"string\">\"shell\"</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"variable\">$name</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"variable\">$&#123;name&#125;</span></span><br></pre></td></tr></table></figure>\n<p><code>$name</code>和<code>${name}</code>都是可以的, <code>{}</code>是可选的, 它的作用是帮助解释器来识别变量边界的, 比如:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> skill <span class=\"keyword\">in</span> Ada Coffe Action Java; <span class=\"keyword\">do</span></span><br><span class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"I am good at <span class=\"variable\">$&#123;skill&#125;</span>Script\"</span></span><br><span class=\"line\"><span class=\"keyword\">done</span></span><br></pre></td></tr></table></figure>\n<p>如果不加 <code>{}</code> 则解释器认为<code>$skillScript</code>是一个变量(内容为空),</p>\n<blockquote>\n<blockquote>\n<p>推荐给所有的变量加上<code>{}</code>,养成好的编程习惯</p>\n</blockquote>\n</blockquote>\n<h3 id=\"只读变量\"><a href=\"#只读变量\" class=\"headerlink\" title=\"只读变量\"></a>只读变量</h3><p>已经定义的变量可以被重新赋值, <strong>只读变量</strong>除外</p>\n<p>定义方式为: 在变量前面加上 <code>readonly</code></p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">readonly</span> name=<span class=\"string\">\"Shell\"</span></span><br><span class=\"line\">name=<span class=\"string\">\"jason\"</span> <span class=\"comment\"># 这里会报错  error: NAME: This variable is read only.</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"删除变量\"><a href=\"#删除变量\" class=\"headerlink\" title=\"删除变量\"></a>删除变量</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">unset</span> name</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>unset 命令不能删除只读变量。 删除之后不能使用</p>\n</blockquote>\n<h2 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h2><p><a href=\"https://www.runoob.com/linux/linux-shell.html\" title=\"Linux Shell教程\" target=\"_blank\" rel=\"noopener\">菜鸟教程</a></p>\n<h2 id=\"结语\"><a href=\"#结语\" class=\"headerlink\" title=\"结语\"></a>结语</h2><p>学习一门技术, 开始的时候不要纠结各种看不懂的语法、不钻牛角尖, 先培养兴趣, 再循序渐进.</p>\n","site":{"data":{}},"excerpt":"","more":"<p>Shell 是一个用 C 语言编写的程序，它是用户使用 Linux 的桥梁</p>\n<p>Shell 编程跟 java、php 编程一样，只要有一个能编写代码¸的文本编辑器和一个能解释执行的脚本解释器就可以了。</p>\n<h2 id=\"开始\"><a href=\"#开始\" class=\"headerlink\" title=\"开始\"></a>开始</h2><h3 id=\"创建脚本文件\"><a href=\"#创建脚本文件\" class=\"headerlink\" title=\"创建脚本文件\"></a>创建脚本文件</h3><p>新建一个扩展名为<code>.sh</code>的文件<code>test.sh</code>, sh代表<em>shell</em></p>\n<p>test.sh文件内容如下:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#!/bin/bash</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"string\">\"Hello Shell\"</span></span><br></pre></td></tr></table></figure>\n<blockquote>\n<p><code>#!</code> 是一个约定俗成的标记, 用于告诉系统使用哪个解释器来执行这个脚本.<br><code>echo</code> 命令是用于向终端输出文本信息,也可用于向文件中写入数据</p>\n</blockquote>\n<h3 id=\"运行shell脚本\"><a href=\"#运行shell脚本\" class=\"headerlink\" title=\"运行shell脚本\"></a>运行shell脚本</h3><p>运行shell脚本的方式两种</p>\n<ul>\n<li>通过可执行文件运行</li>\n</ul>\n<p>需要给脚本文件添加可执行权限</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 在 test.sh 文件所在的文件夹下, 执行以下命令</span></span><br><span class=\"line\">chmod +x ./test.sh</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>这里需要注意的是, 一定要写成<code>./test.sh</code>而不是<code>test.sh</code>, 否责系统可能会找不到脚本文件, <code>./</code>的意思是 指定在当前文件路径下查找文件</p>\n</blockquote>\n<ul>\n<li>作为解释器参数</li>\n</ul>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/bin/sh test.sh</span><br><span class=\"line\">/bin/php test.php</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>这种方式下,在文件第一行添加<em>标记</em>也没有效果(因为你已经指定了解释器来运行脚本)</p>\n</blockquote>\n<h2 id=\"变量\"><a href=\"#变量\" class=\"headerlink\" title=\"变量\"></a>变量</h2><p>规则:</p>\n<ol>\n<li>定义变量时，变量名不加美元符号</li>\n<li>变量名和等号之间不能有空格</li>\n<li>命名只能使用英文字母，数字和下划线，首个字符不能以数字开头。</li>\n<li>中间不能有空格，可以使用下划线（_）。</li>\n<li>不能使用标点符号。</li>\n<li>不能使用bash里的关键字（可用help命令查看保留关键字）。</li>\n</ol>\n<p>示例:</p>\n<p>有效命名:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">RUNOOB</span><br><span class=\"line\">LD_LIBRARY_PATH</span><br><span class=\"line\">_var</span><br><span class=\"line\">var2</span><br></pre></td></tr></table></figure>\n<p>无效命名:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">?var=123</span><br><span class=\"line\">user*name=runoob</span><br></pre></td></tr></table></figure>\n<p>显示赋值</p>\n<p><code>your_name=&quot;runoob.com&quot;</code></p>\n<p>通过语句赋值</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> file <span class=\"keyword\">in</span> `ls /etc`</span><br><span class=\"line\"><span class=\"comment\"># 或</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> file <span class=\"keyword\">in</span> $(ls /etc)</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>以上语句, 列出<code>/etc</code>路径下的所有文件名,赋值给<code>file</code></p>\n</blockquote>\n<h3 id=\"使用变量\"><a href=\"#使用变量\" class=\"headerlink\" title=\"使用变量\"></a>使用变量</h3><p>使用变量,只需要在变量前面加一个<code>$</code>符号</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">name=<span class=\"string\">\"shell\"</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"variable\">$name</span></span><br><span class=\"line\"><span class=\"built_in\">echo</span> <span class=\"variable\">$&#123;name&#125;</span></span><br></pre></td></tr></table></figure>\n<p><code>$name</code>和<code>${name}</code>都是可以的, <code>{}</code>是可选的, 它的作用是帮助解释器来识别变量边界的, 比如:</p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">for</span> skill <span class=\"keyword\">in</span> Ada Coffe Action Java; <span class=\"keyword\">do</span></span><br><span class=\"line\">    <span class=\"built_in\">echo</span> <span class=\"string\">\"I am good at <span class=\"variable\">$&#123;skill&#125;</span>Script\"</span></span><br><span class=\"line\"><span class=\"keyword\">done</span></span><br></pre></td></tr></table></figure>\n<p>如果不加 <code>{}</code> 则解释器认为<code>$skillScript</code>是一个变量(内容为空),</p>\n<blockquote>\n<blockquote>\n<p>推荐给所有的变量加上<code>{}</code>,养成好的编程习惯</p>\n</blockquote>\n</blockquote>\n<h3 id=\"只读变量\"><a href=\"#只读变量\" class=\"headerlink\" title=\"只读变量\"></a>只读变量</h3><p>已经定义的变量可以被重新赋值, <strong>只读变量</strong>除外</p>\n<p>定义方式为: 在变量前面加上 <code>readonly</code></p>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">readonly</span> name=<span class=\"string\">\"Shell\"</span></span><br><span class=\"line\">name=<span class=\"string\">\"jason\"</span> <span class=\"comment\"># 这里会报错  error: NAME: This variable is read only.</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"删除变量\"><a href=\"#删除变量\" class=\"headerlink\" title=\"删除变量\"></a>删除变量</h3><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">unset</span> name</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>unset 命令不能删除只读变量。 删除之后不能使用</p>\n</blockquote>\n<h2 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h2><p><a href=\"https://www.runoob.com/linux/linux-shell.html\" title=\"Linux Shell教程\" target=\"_blank\" rel=\"noopener\">菜鸟教程</a></p>\n<h2 id=\"结语\"><a href=\"#结语\" class=\"headerlink\" title=\"结语\"></a>结语</h2><p>学习一门技术, 开始的时候不要纠结各种看不懂的语法、不钻牛角尖, 先培养兴趣, 再循序渐进.</p>\n"},{"title":"我的个人博客","date":"2018-11-04T08:53:40.000Z","_content":"\n## 这是我的第一个博客\n\n这个博客模版好坑,如果内容过短,在拉到最下面的时候就会自动弹到上面反复的弹\n\n## 这个项目怎么跑\n\n`docker run -d -p 4000:4000 --rm -v ~/myWorkspace/myproject/myblog/source:/app/source --network=app-bridge --name=webblog myblog:1.4`\n\n### 命令说明\n\n* **-d**   docker在后台运行\n* **-p**   指定容器运行的端口映射到机器端口, [内部]:[外部]\n* **--rm** 停止容器即删除\n* **-v**   docker数据卷操作, 将**机器路径**~/myWorkspace/myproject/myblog/source 挂载到**容器路径**/app/source  参考[管理容器中的数据](https://docs.docker-cn.com/engine/tutorials/dockervolumes/)\n* **--network**  docker网络操作, 将容器运行在 app-bridge 桥网络中, 参考[docker容器网络](https://docs.docker-cn.com/engine/userguide/networking/)\n* **--name** 容器的名称\n* **myblog:1.4**  这个是容器的镜像 ***:** 前面是镜像名称,后面是 镜像版本\n\n## 开启搜索功能\n\n```sh\n# npm i hexo-generator-search --save\n```\n\n_config.yml 配置\n\n```yml\nsearch:\n  path: search.json\n  field: post\n```\n\n## 考虑加入admin功能\n\n需要在Dockerfiler添加一下依赖\n`npm install --save hexo-admin-ehc --save --registry=https://registry.npm.taobao.org`\n\n修改_config.xml文件, 当然这是可选的,设置后台密码\n\n```bash\nadmin:\n  username: jason\n  password_hash: $2a$05$XdoQHWQBCutMxgX3iBG0XOfov2LTNelkMDbtMCkaQRgqhoMdV4tAe\n  secret: jason\n```\n\n设置admin基本属性\n\n```bash\nmetadata:\n  author_id: defaultAuthorId\n  language: zh\n```\n\n### 以下为占位符\n\n> 需要注意的是 最后面 myblog:1.0  这个 1.0 代表镜像版本,一情况而定\n","source":"_posts/我的个人博客.md","raw":"---\ntitle: 我的个人博客\ntags: 随便写写\ndate: 2018-11-04 16:53:40\n---\n\n## 这是我的第一个博客\n\n这个博客模版好坑,如果内容过短,在拉到最下面的时候就会自动弹到上面反复的弹\n\n## 这个项目怎么跑\n\n`docker run -d -p 4000:4000 --rm -v ~/myWorkspace/myproject/myblog/source:/app/source --network=app-bridge --name=webblog myblog:1.4`\n\n### 命令说明\n\n* **-d**   docker在后台运行\n* **-p**   指定容器运行的端口映射到机器端口, [内部]:[外部]\n* **--rm** 停止容器即删除\n* **-v**   docker数据卷操作, 将**机器路径**~/myWorkspace/myproject/myblog/source 挂载到**容器路径**/app/source  参考[管理容器中的数据](https://docs.docker-cn.com/engine/tutorials/dockervolumes/)\n* **--network**  docker网络操作, 将容器运行在 app-bridge 桥网络中, 参考[docker容器网络](https://docs.docker-cn.com/engine/userguide/networking/)\n* **--name** 容器的名称\n* **myblog:1.4**  这个是容器的镜像 ***:** 前面是镜像名称,后面是 镜像版本\n\n## 开启搜索功能\n\n```sh\n# npm i hexo-generator-search --save\n```\n\n_config.yml 配置\n\n```yml\nsearch:\n  path: search.json\n  field: post\n```\n\n## 考虑加入admin功能\n\n需要在Dockerfiler添加一下依赖\n`npm install --save hexo-admin-ehc --save --registry=https://registry.npm.taobao.org`\n\n修改_config.xml文件, 当然这是可选的,设置后台密码\n\n```bash\nadmin:\n  username: jason\n  password_hash: $2a$05$XdoQHWQBCutMxgX3iBG0XOfov2LTNelkMDbtMCkaQRgqhoMdV4tAe\n  secret: jason\n```\n\n设置admin基本属性\n\n```bash\nmetadata:\n  author_id: defaultAuthorId\n  language: zh\n```\n\n### 以下为占位符\n\n> 需要注意的是 最后面 myblog:1.0  这个 1.0 代表镜像版本,一情况而定\n","slug":"我的个人博客","published":1,"updated":"2019-06-15T02:36:36.734Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ck550trly0010hm62xepoxq77","content":"<h2 id=\"这是我的第一个博客\"><a href=\"#这是我的第一个博客\" class=\"headerlink\" title=\"这是我的第一个博客\"></a>这是我的第一个博客</h2><p>这个博客模版好坑,如果内容过短,在拉到最下面的时候就会自动弹到上面反复的弹</p>\n<h2 id=\"这个项目怎么跑\"><a href=\"#这个项目怎么跑\" class=\"headerlink\" title=\"这个项目怎么跑\"></a>这个项目怎么跑</h2><p><code>docker run -d -p 4000:4000 --rm -v ~/myWorkspace/myproject/myblog/source:/app/source --network=app-bridge --name=webblog myblog:1.4</code></p>\n<h3 id=\"命令说明\"><a href=\"#命令说明\" class=\"headerlink\" title=\"命令说明\"></a>命令说明</h3><ul>\n<li><strong>-d</strong>   docker在后台运行</li>\n<li><strong>-p</strong>   指定容器运行的端口映射到机器端口, [内部]:[外部]</li>\n<li><strong>–rm</strong> 停止容器即删除</li>\n<li><strong>-v</strong>   docker数据卷操作, 将<strong>机器路径</strong>~/myWorkspace/myproject/myblog/source 挂载到<strong>容器路径</strong>/app/source  参考<a href=\"https://docs.docker-cn.com/engine/tutorials/dockervolumes/\" target=\"_blank\" rel=\"noopener\">管理容器中的数据</a></li>\n<li><strong>–network</strong>  docker网络操作, 将容器运行在 app-bridge 桥网络中, 参考<a href=\"https://docs.docker-cn.com/engine/userguide/networking/\" target=\"_blank\" rel=\"noopener\">docker容器网络</a></li>\n<li><strong>–name</strong> 容器的名称</li>\n<li><strong>myblog:1.4</strong>  这个是容器的镜像 <strong>*:</strong> 前面是镜像名称,后面是 镜像版本</li>\n</ul>\n<h2 id=\"开启搜索功能\"><a href=\"#开启搜索功能\" class=\"headerlink\" title=\"开启搜索功能\"></a>开启搜索功能</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># npm i hexo-generator-search --save</span></span><br></pre></td></tr></table></figure>\n<p>_config.yml 配置</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">search:</span></span><br><span class=\"line\"><span class=\"attr\">  path:</span> <span class=\"string\">search.json</span></span><br><span class=\"line\"><span class=\"attr\">  field:</span> <span class=\"string\">post</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"考虑加入admin功能\"><a href=\"#考虑加入admin功能\" class=\"headerlink\" title=\"考虑加入admin功能\"></a>考虑加入admin功能</h2><p>需要在Dockerfiler添加一下依赖<br><code>npm install --save hexo-admin-ehc --save --registry=https://registry.npm.taobao.org</code></p>\n<p>修改_config.xml文件, 当然这是可选的,设置后台密码</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">admin:</span><br><span class=\"line\">  username: jason</span><br><span class=\"line\">  password_hash: <span class=\"variable\">$2a</span><span class=\"variable\">$05</span><span class=\"variable\">$XdoQHWQBCutMxgX3iBG0XOfov2LTNelkMDbtMCkaQRgqhoMdV4tAe</span></span><br><span class=\"line\">  secret: jason</span><br></pre></td></tr></table></figure>\n<p>设置admin基本属性</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">metadata:</span><br><span class=\"line\">  author_id: defaultAuthorId</span><br><span class=\"line\">  language: zh</span><br></pre></td></tr></table></figure>\n<h3 id=\"以下为占位符\"><a href=\"#以下为占位符\" class=\"headerlink\" title=\"以下为占位符\"></a>以下为占位符</h3><blockquote>\n<p>需要注意的是 最后面 myblog:1.0  这个 1.0 代表镜像版本,一情况而定</p>\n</blockquote>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"这是我的第一个博客\"><a href=\"#这是我的第一个博客\" class=\"headerlink\" title=\"这是我的第一个博客\"></a>这是我的第一个博客</h2><p>这个博客模版好坑,如果内容过短,在拉到最下面的时候就会自动弹到上面反复的弹</p>\n<h2 id=\"这个项目怎么跑\"><a href=\"#这个项目怎么跑\" class=\"headerlink\" title=\"这个项目怎么跑\"></a>这个项目怎么跑</h2><p><code>docker run -d -p 4000:4000 --rm -v ~/myWorkspace/myproject/myblog/source:/app/source --network=app-bridge --name=webblog myblog:1.4</code></p>\n<h3 id=\"命令说明\"><a href=\"#命令说明\" class=\"headerlink\" title=\"命令说明\"></a>命令说明</h3><ul>\n<li><strong>-d</strong>   docker在后台运行</li>\n<li><strong>-p</strong>   指定容器运行的端口映射到机器端口, [内部]:[外部]</li>\n<li><strong>–rm</strong> 停止容器即删除</li>\n<li><strong>-v</strong>   docker数据卷操作, 将<strong>机器路径</strong>~/myWorkspace/myproject/myblog/source 挂载到<strong>容器路径</strong>/app/source  参考<a href=\"https://docs.docker-cn.com/engine/tutorials/dockervolumes/\" target=\"_blank\" rel=\"noopener\">管理容器中的数据</a></li>\n<li><strong>–network</strong>  docker网络操作, 将容器运行在 app-bridge 桥网络中, 参考<a href=\"https://docs.docker-cn.com/engine/userguide/networking/\" target=\"_blank\" rel=\"noopener\">docker容器网络</a></li>\n<li><strong>–name</strong> 容器的名称</li>\n<li><strong>myblog:1.4</strong>  这个是容器的镜像 <strong>*:</strong> 前面是镜像名称,后面是 镜像版本</li>\n</ul>\n<h2 id=\"开启搜索功能\"><a href=\"#开启搜索功能\" class=\"headerlink\" title=\"开启搜索功能\"></a>开启搜索功能</h2><figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># npm i hexo-generator-search --save</span></span><br></pre></td></tr></table></figure>\n<p>_config.yml 配置</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">search:</span></span><br><span class=\"line\"><span class=\"attr\">  path:</span> <span class=\"string\">search.json</span></span><br><span class=\"line\"><span class=\"attr\">  field:</span> <span class=\"string\">post</span></span><br></pre></td></tr></table></figure>\n<h2 id=\"考虑加入admin功能\"><a href=\"#考虑加入admin功能\" class=\"headerlink\" title=\"考虑加入admin功能\"></a>考虑加入admin功能</h2><p>需要在Dockerfiler添加一下依赖<br><code>npm install --save hexo-admin-ehc --save --registry=https://registry.npm.taobao.org</code></p>\n<p>修改_config.xml文件, 当然这是可选的,设置后台密码</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">admin:</span><br><span class=\"line\">  username: jason</span><br><span class=\"line\">  password_hash: <span class=\"variable\">$2a</span><span class=\"variable\">$05</span><span class=\"variable\">$XdoQHWQBCutMxgX3iBG0XOfov2LTNelkMDbtMCkaQRgqhoMdV4tAe</span></span><br><span class=\"line\">  secret: jason</span><br></pre></td></tr></table></figure>\n<p>设置admin基本属性</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">metadata:</span><br><span class=\"line\">  author_id: defaultAuthorId</span><br><span class=\"line\">  language: zh</span><br></pre></td></tr></table></figure>\n<h3 id=\"以下为占位符\"><a href=\"#以下为占位符\" class=\"headerlink\" title=\"以下为占位符\"></a>以下为占位符</h3><blockquote>\n<p>需要注意的是 最后面 myblog:1.0  这个 1.0 代表镜像版本,一情况而定</p>\n</blockquote>\n"}],"PostAsset":[{"_id":"source/_posts/msl/WX20200108-154615@2x.png","slug":"WX20200108-154615@2x.png","post":"ck550trlr000khm62lir4fj2t","modified":1,"renderable":0},{"_id":"source/_posts/mysql-explain/2864885534-202c0878c1abf896.png","slug":"2864885534-202c0878c1abf896.png","post":"ck550trlq000ihm62f8zcclfj","modified":1,"renderable":0},{"_id":"source/_posts/python3/1.png","slug":"1.png","post":"ck550trlt000phm624dbufqmo","modified":1,"renderable":0},{"_id":"source/_posts/xgp-zerotier/CD65E8E75C1CBF3BF60AFBF278909ACD.jpg","post":"ck550trlu000rhm62yqfg8trf","slug":"CD65E8E75C1CBF3BF60AFBF278909ACD.jpg","modified":1,"renderable":1},{"_id":"source/_posts/msl/20180912154639866.png","post":"ck550trlr000khm62lir4fj2t","slug":"20180912154639866.png","modified":1,"renderable":1},{"_id":"source/_posts/msl/A84A183D1145E8245B6A7C8A84FB985F.jpg","slug":"A84A183D1145E8245B6A7C8A84FB985F.jpg","post":"ck550trlr000khm62lir4fj2t","modified":1,"renderable":0},{"_id":"source/_posts/msl/WX20200108-154856@2x.png","slug":"WX20200108-154856@2x.png","post":"ck550trlr000khm62lir4fj2t","modified":1,"renderable":0},{"_id":"source/_posts/msl/WX20200108-155336@2x.png","slug":"WX20200108-155336@2x.png","post":"ck550trlr000khm62lir4fj2t","modified":1,"renderable":0},{"_id":"source/_posts/msl/WX20200108-155928@2x.png","slug":"WX20200108-155928@2x.png","post":"ck550trlr000khm62lir4fj2t","modified":1,"renderable":0},{"_id":"source/_posts/msl/WX20200108-160028@2x.png","slug":"WX20200108-160028@2x.png","post":"ck550trlr000khm62lir4fj2t","modified":1,"renderable":0}],"PostCategory":[],"PostTag":[{"post_id":"ck550trl40001hm624sat85tv","tag_id":"ck550trlb0005hm62ve61nioj","_id":"ck550trlm000chm62husp7kt1"},{"post_id":"ck550trl80003hm62twwzrqhj","tag_id":"ck550trlm000bhm62gk02tlta","_id":"ck550trlp000hhm62atie77uz"},{"post_id":"ck550trld0006hm622oeppdi4","tag_id":"ck550trlo000fhm62thj05wn5","_id":"ck550trls000lhm62k755gshr"},{"post_id":"ck550trlq000ihm62f8zcclfj","tag_id":"ck550trlm000bhm62gk02tlta","_id":"ck550trlt000nhm62f6ntnhiq"},{"post_id":"ck550trlk000ahm62q6fhrdmm","tag_id":"ck550trlr000jhm627gi668i4","_id":"ck550trlu000qhm62gnjy4a6w"},{"post_id":"ck550trls000mhm62rati9dc9","tag_id":"ck550trlr000jhm627gi668i4","_id":"ck550trlv000shm62tgh9un9e"},{"post_id":"ck550trlm000dhm62j5q97729","tag_id":"ck550trlt000ohm62lf4y896i","_id":"ck550trlw000vhm622caxa5p2"},{"post_id":"ck550trlv000thm62z7h3tfej","tag_id":"ck550trlm000bhm62gk02tlta","_id":"ck550trlx000xhm62em61xgoy"},{"post_id":"ck550trlo000ehm62hexrse46","tag_id":"ck550trlw000uhm626jtn5klq","_id":"ck550trlz0011hm62ikuiw1br"},{"post_id":"ck550trlp000ghm62gjdsldxm","tag_id":"ck550trly000zhm623ku90n6b","_id":"ck550trm00013hm623hpx21xu"},{"post_id":"ck550trlr000khm62lir4fj2t","tag_id":"ck550trm00012hm628foky4ff","_id":"ck550trm00015hm6219ixekdf"},{"post_id":"ck550trlt000phm624dbufqmo","tag_id":"ck550trm00014hm62u86lcsbf","_id":"ck550trm00017hm628akuzv7j"},{"post_id":"ck550trlu000rhm62yqfg8trf","tag_id":"ck550trm00016hm62p09gwo8m","_id":"ck550trm10019hm62wbxfhzq5"},{"post_id":"ck550trlx000yhm62nsnlaljo","tag_id":"ck550trm10018hm62tl33vsyj","_id":"ck550trm1001bhm62wra3wxta"},{"post_id":"ck550trly0010hm62xepoxq77","tag_id":"ck550trm1001ahm62prw9d4hk","_id":"ck550trm1001chm620x60ry43"}],"Tag":[{"name":"Hello World","_id":"ck550trlb0005hm62ve61nioj"},{"name":"数据库","_id":"ck550trlm000bhm62gk02tlta"},{"name":"容器","_id":"ck550trlo000fhm62thj05wn5"},{"name":"服务器","_id":"ck550trlr000jhm627gi668i4"},{"name":"API","_id":"ck550trlt000ohm62lf4y896i"},{"name":"基础","_id":"ck550trlw000uhm626jtn5klq"},{"name":"路由器","_id":"ck550trly000zhm623ku90n6b"},{"name":"Windows","_id":"ck550trm00012hm628foky4ff"},{"name":"编程语言","_id":"ck550trm00014hm62u86lcsbf"},{"name":"小钢炮","_id":"ck550trm00016hm62p09gwo8m"},{"name":"脚本语言","_id":"ck550trm10018hm62tl33vsyj"},{"name":"随便写写","_id":"ck550trm1001ahm62prw9d4hk"}]}}